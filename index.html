
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Statistically Significant</title>
  <meta name="author" content="Andrew Landgraf">

  
  <meta name="description" content="I am planning to finish school soon and I would like to shed some weight before moving on. I have collected a fair number of books that I will likely &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://andland.github.io">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Statistically Significant" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-1827475-3']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>


<!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  jax: ["input/TeX", "output/HTML-CSS"],
  tex2jax: {
    inlineMath: [ ['$', '$'] ],
    displayMath: [ ['$$', '$$']],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  messageStyle: "none",
  "HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] }
});
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>


<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Statistically Significant</a></h1>
  
    <h2>Andrew Landgraf's Blog</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:andland.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/about">About</a></li>
  <li><a href="/blog/archives">Blog Archives</a></li>
  <li><a href="/projects">Projects</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/04/08/amazon-tradein-price-fluctuations/">Monitoring Price Fluctuations of Book Trade-In Values on Amazon</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-04-08T20:00:00-04:00" pubdate data-updated="true">Apr 8<span>th</span>, 2015</time>
        
         | <a href="/blog/2015/04/08/amazon-tradein-price-fluctuations/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I am planning to finish school soon and I would like to shed some weight before moving on. I have collected a fair number of books that I will likely never use again and it would be nice to get some money for them. Sites like Amazon and eBay let you sell your book to other customers, but Amazon will also buy some of your books directly (Trade-Ins), saving you the hassle of waiting for a buyer. </p>

<p>Before selling, I remembered listening to a <a href="http://www.npr.org/blogs/money/2014/11/10/363103753/textbook-arbitrage-making-money-off-used-books">Planet Money episode</a> about a couple of guys that tried to make money off of buying and selling used textbooks on Amazon. Their strategy was to buy books at the end of a semester when students are itching to get rid of them, and sell them to other students at the beginning of the next semester. To back up their business, they have been scraping Amazon&rsquo;s website for years, keeping track of prices in order to find the optimal times to buy and sell.</p>

<p>I collected a few books I was willing to part with and set up a scraper in R. I am primarily interested in selling my books to Amazon, so I tracked Amazon&rsquo;s Trade-In prices for these books. This was done fairly easily with Hadley Wickham&rsquo;s package <a href="https://github.com/hadley/rvest">rvest</a> and the Chrome extension <a href="http://selectorgadget.com/">Selector Gadget</a>. Selector Gadget tells me that the node I&rsquo;m interested in is <code>#tradeInButton_tradeInValue</code>. The code to do the scraping is below.</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>Amazon_scrape_prices.R</span><a href="https://gist.github.com/andland/52f8a97a111dcd8778aa#file-amazon_scrape_prices-r">link</a></figcaption> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
</pre></td><td class="code"><pre><code class="r"><span class="line">library<span class="p">(</span>rvest<span class="p">)</span>
</span><span class="line">
</span><span class="line">urls_df <span class="o">=</span> read.csv<span class="p">(</span><span class="s">&quot;AmazonBookURLs.csv&quot;</span><span class="p">,</span> stringsAsFactors <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span> comment.char <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
</span><span class="line">load<span class="p">(</span>file <span class="o">=</span> <span class="s">&quot;AmazonBookPrices.RData&quot;</span><span class="p">)</span>
</span><span class="line">price_df_temp <span class="o">=</span> data.frame<span class="p">(</span>Title <span class="o">=</span> urls_df<span class="o">$</span>Title<span class="p">,</span>
</span><span class="line">                      Date <span class="o">=</span> Sys.time<span class="p">(),</span>
</span><span class="line">                      Price <span class="o">=</span> <span class="kc">NA_real_</span><span class="p">,</span> stringsAsFactors <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span>
</span><span class="line"><span class="kr">for</span> <span class="p">(</span>i <span class="kr">in</span> <span class="m">1</span><span class="o">:</span>nrow<span class="p">(</span>urls_df<span class="p">))</span> <span class="p">{</span>
</span><span class="line">  tradein_html <span class="o">=</span> urls_df<span class="o">$</span>URL<span class="p">[</span>i<span class="p">]</span> <span class="o">%&gt;%</span> html<span class="p">()</span> <span class="o">%&gt;%</span>
</span><span class="line">    html_node<span class="p">(</span><span class="s">&quot;#tradeInButton_tradeInValue&quot;</span><span class="p">)</span>
</span><span class="line">  <span class="kr">if</span> <span class="p">(</span>is.null<span class="p">(</span>tradein_html<span class="p">))</span> <span class="p">{</span>
</span><span class="line">    <span class="kr">next</span>
</span><span class="line">  <span class="p">}</span>
</span><span class="line">  price <span class="o">=</span> tradein_html <span class="o">%&gt;%</span>
</span><span class="line">    html_text<span class="p">()</span> <span class="o">%&gt;%</span>
</span><span class="line">    gsub<span class="p">(</span><span class="s">&quot;(^[[:space:]]+\\$|[[:space:]]+$)&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">,</span> .<span class="p">)</span> <span class="o">%&gt;%</span>
</span><span class="line">    as.numeric<span class="p">()</span>
</span><span class="line">  price_df_temp<span class="o">$</span>Price<span class="p">[</span>i<span class="p">]</span> <span class="o">=</span> price
</span><span class="line"><span class="p">}</span>
</span><span class="line">price_df <span class="o">=</span> rbind<span class="p">(</span>price_df<span class="p">,</span> price_df_temp<span class="p">)</span>
</span><span class="line">
</span><span class="line">save<span class="p">(</span>price_df<span class="p">,</span> file <span class="o">=</span> <span class="s">&quot;AmazonBookPrices.RData&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>After manually collecting this data for less than a week, I am able to plot the trends for the eight books I am interested in selling. The plot and code are below.</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>plot_amazon_prices.R</span><a href="https://gist.github.com/andland/52f8a97a111dcd8778aa#file-plot_amazon_prices-r">link</a></figcaption> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
</pre></td><td class="code"><pre><code class="r"><span class="line">library<span class="p">(</span>ggplot2<span class="p">);</span> theme_set<span class="p">(</span>theme_bw<span class="p">())</span>
</span><span class="line">library<span class="p">(</span>scales<span class="p">)</span>
</span><span class="line">
</span><span class="line">price_df<span class="o">$</span>TitleTrunc <span class="o">=</span> paste0<span class="p">(</span>substring<span class="p">(</span>price_df<span class="o">$</span>TitleTrunc<span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">30</span><span class="p">),</span> ifelse<span class="p">(</span>nchar<span class="p">(</span>price_df<span class="o">$</span>Title<span class="p">)</span> <span class="o">&gt;</span> <span class="m">30</span><span class="p">,</span> <span class="s">&quot;...&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">))</span>
</span><span class="line">ggplot<span class="p">(</span>price_df<span class="p">,</span> aes<span class="p">(</span>Date<span class="p">,</span> Price<span class="p">))</span> <span class="o">+</span>
</span><span class="line">  geom_step<span class="p">()</span> <span class="o">+</span> geom_point<span class="p">()</span> <span class="o">+</span> facet_wrap<span class="p">(</span><span class="o">~</span> TitleTrunc<span class="p">,</span> scales <span class="o">=</span> <span class="s">&quot;free_y&quot;</span><span class="p">)</span> <span class="o">+</span>
</span><span class="line">  scale_y_continuous<span class="p">(</span>labels <span class="o">=</span> dollar<span class="p">)</span> <span class="o">+</span> theme<span class="p">(</span>axis.text.x <span class="o">=</span> element_text<span class="p">(</span>angle <span class="o">=</span> <span class="m">90</span><span class="p">,</span> vjust <span class="o">=</span> <span class="m">0</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p><img src="/images/AmazonScrape/prices.png" title="Amazon Trade-In Prices" /></p>

<p>I am surprised how much the prices fluctuate. I expected them to be constant for the most part, with large changes once a week or less often. Apparently Amazon is doing quite a bit of tweaking to determine optimal price points. I would also guess that $2 is their minimum trade-in price. It looks like I missed out on my best chance to sell <em>A First Course in Stochastic Processes</em>, but that the price of <em>A Primer on Linear Models</em> will keep rising forever.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/12/24/time-stack-time-slice-r/">Time Stacking and Time Slicing in R</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-12-24T12:00:00-05:00" pubdate data-updated="true">Dec 24<span>th</span>, 2014</time>
        
         | <a href="/blog/2014/12/24/time-stack-time-slice-r/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://en.wikipedia.org/wiki/Time-lapse_photography">Time lapses</a> are a fun way to quickly show a long period of time. They typically involve setting up your camera on a tripod and taking photos at a regular interval, like every 5 seconds. After all the photos have been taken, they are combined into a movie at a much faster rate, for example 30 frames per second. </p>

<p><a href="https://500px.com/blog/1051/tutorial-time-stack">Time stacking</a> is a way to combine all the photos into a single photo, instead of a movie. This is a common method to make <a href="http://en.wikipedia.org/wiki/Star_trail">star trails</a>, and <a href="https://www.flickr.com/photos/matt_molloy/">Matt Molloy</a> has recently been experimenting with it in many different settings. There are many possible ways to achieve a time stack, but the most common way is to combine the photos with a <a href="http://en.wikipedia.org/wiki/Blend_modes#Lighten_Only">lighten layer blend</a>. For every pixel in the final image, the combined photo will use the corresponding pixel from the photo that was the brightest in all of the photos. This gives the desired result of motion of the stars or clouds in a scene. </p>

<p>Another way to combine the photos is through time slicing (see, for example, <a href="https://www.flickr.com/photos/matt_molloy/15619271557/">this photo</a>). In time slicing, the final combined image will contain a &ldquo;slice&rdquo; from each of the original photos. Time slices can go left-to-right, right-to-left, top-to-bottom, or bottom-to-top. For example, a time slice that goes from left to right will use vertical slices of the pixels. If you took 100 photos for your time lapse, each of which being 1000 pixels wide, the left-most 10 vertical  pixel slices of the final image would contain the corresponding pixels from the first photo, the 11th through 20th vertical  pixel slices would contain the corresponding pixels from the second photo, and so on. Different directions will produce different effects.</p>

<p>There is free software available to do lighten layer blending of two photos, but I could not find any to automatically do it for a large number of photos. Similarly for the time slice, it is easy enough to manually slice a few photos, but not hundreds of photos. Therefore, I wrote a couple of scripts in <a href="http://www.r-project.org/">R</a> that would do this automatically. A gist of the scripts to create a time stack script and a time slice is <a href="https://gist.github.com/andland/efe66240184328f07429">here</a>. They both require you to give the directory containing the JPEG photos and the time slice script let&rsquo;s you enter the direction you would like it to go.</p>

<div class="embed-video-container"><iframe width="640" height="480" src="http://www.youtube.com/embed/KnZQIeHPOYI" frameborder="0" allowfullscreen=""></iframe></div>

<p>To try this out on my own photos, I used the time lapse I had created of <a href="https://www.youtube.com/watch?v=KnZQIeHPOYI">a sunset</a> (movie created with <a href="https://www.ffmpeg.org/">FFmpeg</a>), which consisted of 225 photos taken over 20 minutes. The source material isn&rsquo;t that great (the photos were out of focus), but you can still see the effects. </p>

<p>The following picture is a time stack.</p>

<p><img src="/images/TimeStack/TimeStack.JPG" title="Time Stack" /></p>

<p>The following four pictures are the time slices with different directions.</p>

<p><img src="/images/TimeStack/TimeSlice-E.JPG" title="Time Slice Left-to-Right" /></p>

<p><img src="/images/TimeStack/TimeSlice-W.JPG" title="Time Slice Right-to-Left" /></p>

<p><img src="/images/TimeStack/TimeSlice-N.JPG" title="Time Slice Bottom-to-Top" /></p>

<p><img src="/images/TimeStack/TimeSlice-S.JPG" title="Time Slice Top-to-Bottom" /></p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/04/22/yet-another-baseball-defensive-statistic/">Yet Another Baseball Defense Statistic</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-04-22T22:00:00-04:00" pubdate data-updated="true">Apr 22<span>nd</span>, 2014</time>
        
         | <a href="/blog/2014/04/22/yet-another-baseball-defensive-statistic/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://www.fangraphs.com">Fangraphs</a> recently published an interesting dataset that measures defensive efficiency of fielders. For each player, the <a href="http://www.fangraphs.com/blogs/inside-edge-fielding-data/">Inside Edge</a> dataset breaks their opportunities to make plays into five categories, ranging from almost impossible to routine. It also records the proportion of times that the player successfully made the play. With this data, we can see how successful each player is for each type of play. I wanted to think of a way to combine these five proportions into one fielding metric. From here on, I will assume that there is no error in categorizing a play as easy or hard and that there is no bias in the categorizations.</p>

<h3 id="model">Model</h3>

<p>The model I will build is motivated by <a href="http://en.wikipedia.org/wiki/Ordered_logit">ordinal regression</a>. If we only were concerned with the success rate in one of the categories, we could use standard logistic regression, and the probability that player $i$ successfully made a play would be assumed to be $\sigma(\theta_i)$, where $\sigma()$ is the <a href="https://en.wikipedia.org/wiki/Logistic_function">logistic function</a>. Using our prior knowledge that plays categorized as easy should have a higher success rate than plays categorized as difficult, I would like to generalize this. </p>

<p>Say there are only two categories: easy and hard. We could model the probability that player $i$ successfully made an hard play as $\sigma(\theta_i)$ and the probability that he made an easy play as $\sigma(\theta_i+\gamma)$. Here, we would assume that $\gamma$ is the same for all players. This assumption implies that if player $i$ is better than player $j$ at easy plays, he will also be better at hard plays. This is a reasonable assumption, but maybe not true in all cases.</p>

<p>Since we have five different categories of difficulty, we can generalize this by having $\gamma_k, k=1,\ldots,4$. Again, these $\gamma_k$&rsquo;s would be the same for everyone. A picture of what this looks like for shortstops is below. In this model, every player will effectively be shifting the curve either left or right. A positive $\theta_i$ means the player is better than average and cause the curve to shift left and vice versa for negative $\theta_i$.</p>

<p><img src="/images/InsideEdge/LogitOrdered.png" title="Logit Ordered" /></p>

<p>I modeled this as a multi-level mixed effects model, with the players being random effects and the $\gamma_k$&rsquo;s being fixed. Technically, I should optimize subject to the condition that the $\gamma_k$&rsquo;s are increasing, but the unconstrained optimization always yields increasing $\gamma_k$&rsquo;s because there is a big difference between success rate in the categories. I used combined data from 2012 and 2013 seasons and included all players with at least one success and one failure. I modeled each position separately. Modeling player effects as random, there is a fair amount of regression to the mean built in. In this sense, I am more trying to estimate the true ability of the player, rather than measuring what he did during the two years. This is an important distinction, which may differ from other defensive statistics.</p>

<h3 id="model-fit">Model fit</h3>

<p>Below is a summary of the results of the model for shortstops. I am only plotting the players with the at least 800 innings, for readability. A bonus of modeling the data like this is that we get standard error estimates as a result. I plotted the estimated effect of each player along with +/- 2 standard errors. We can be fairly certain that the effects for the top few shortstops is greater than 0 since their confidence intervals do not include 0. The same is true for the bottom few. Images for the other positions can be found <a href="https://github.com/andland/andland.github.com/tree/master/images/InsideEdge">here</a>.</p>

<p><img src="/images/InsideEdge/SSlist.png" title="Results for shortstops" /></p>

<p>The results seem to make sense for the most part. Simmons and Tulowitzki have reputations as being strong defenders and Derek Jeter has a reputation as a poor defender.</p>

<p>Further, I can validate this data by comparing it to other defensive metrics. One that is readily available on Fangraphs is UZR per 150 games. For each position, I took the correlation of my estimated effect with UZR per 150 games, weighted by the number of innings played. Pitchers and catchers do not have UZR&rsquo;s so I cannot compare them. The correlations, which are in the plot below, range from about 0.2 to 0.65.</p>

<p><img src="/images/InsideEdge/CorrelationWithUZR.png" title="Correlation with UZR" /></p>

<h3 id="interpreting-parameters">Interpreting parameters</h3>

<p>In order to make this fielding metric more useful, I would like to convert the parameters to something more interpretable. One option which makes a lot of sense is &ldquo;plays made above/below average&rdquo;. Given an estimated $\theta_i$ for a player, we can calculate the probability that he would make a play in each of the five categories. We can then compare those probabilities to the probability an average player would make a play in each of the categories, which would be fit with $\theta=0$. Finally, we can weight these differences in probabilities by the relative rate that plays of various difficulties occur. </p>

<p>For example, assuming there are only two categories again, suppose a player has a 0.10 and 0.05 higher probability than average of making hard and easy plays, respectively. Further assume that 75% of all plays are hard and 25% are easy. On a random play, the improvement in probability over an average player of making a play is $.10(.75)+.05(.25)=0.0875$. If a player has an opportunity for 300 plays in an average season, this player would be $300 \times 0.0875=26.25$ plays better than average over a typical season.</p>

<p>I will assume that the number of opportunities to make plays is directly related to the number of innings played. To convert innings to opportunities, I took the median number of opportunities per inning for each position. For example, shortstops had the highest opportunities per inning at 0.40 and catchers had the lowest at 0.08. The plot below shows the distribution of opportunities per inning for each position.</p>

<p><img src="/images/InsideEdge/PlaysPerInning.png" title="Plays Per Inning by Position" /></p>

<p>We can extend this to the impact on saving runs from being scored as well by assuming each successful play saves $x$ runs. I will not do this for this analysis.</p>

<h3 id="results">Results</h3>

<p><img src="/images/InsideEdge/shiny.png" title="Shiny app" /></p>

<p>[<strong>Update</strong>: The Shiny app is no longer live, but you can view the resulting estimates in the <a href="https://github.com/andland/InsideEdgeFielding/blob/master/Shiny/InsideEdgeModelResults.csv">Github repository</a>.]</p>

<p>Finally, I put together a <a href="http://www.rstudio.com/shiny/">Shiny</a> app to display <a href="https://github.com/andland/InsideEdgeFielding/blob/master/Shiny/InsideEdgeModelResults.csv">the results</a>. You can search by team, position, and innings played. A team of &lsquo;- - -&lsquo; means the player played for multiple teams over this period. You can also choose to display the results as a rate statistic (extra plays made per season) or a count statistic (extra plays made over the two seasons). To get a seasonal number, I assume position players played 150 games with 8.5 innings in each game. For pitchers, I assumed that they pitched 30 games, 6 innings each. </p>

<h3 id="conclusions-and-future-work">Conclusions and future work</h3>

<p>I don&rsquo;t know if I will do anything more with this data, but if I could do it again, I may have modeled each year separately instead of combining the two years together. With that, it would have been interesting to model the effect of age by observing how a player&rsquo;s ability to make a play changes from one year to the next. I also think it would be interesting to see how changing positions affects a players efficiency. For example, we could have a $9 \times 9$ matrix of fixed effects that represent the improvement or degradation in ability as a player switches from their main position to another one. Further assumptions would be needed to make sure the $\theta$&rsquo;s are on the same scale for every position.</p>

<p>At the very least, this model and its results can be considered another data point in the analysis of a player&rsquo;s fielding ability. One thing we need to be concerned about is the classification of each play into the difficultness categories. The human eye can be fooled into thinking a routine play is hard just because a fielder dove to make the play, when a superior fielder could have made it look easier.</p>

<h3 id="code">Code</h3>

<p>I have put the R code together to do this analysis in <a href="https://gist.github.com/andland/c6adb69ea365c2580859">a gist</a>. If there is interest, I will put together a repo with all the data as well.</p>

<p><strong>Update</strong>: I have a <a href="https://github.com/andland/InsideEdgeFielding">Github repository</a> with the data, R code for the analysis, the results, and code for the Shiny app. Let me know what you think.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/03/02/hastie-and-tibshirani-interview-jerome-friedman/">Hastie and Tibshirani Interview Jerome Friedman</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-03-02T17:10:00-05:00" pubdate data-updated="true">Mar 2<span>nd</span>, 2014</time>
        
         | <a href="/blog/2014/03/02/hastie-and-tibshirani-interview-jerome-friedman/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://www.stanford.edu/~hastie/">Trevor Hastie</a> and <a href="http://statweb.stanford.edu/~tibs/">Rob Tibshirani</a> are currently teaching a <a href="http://en.wikipedia.org/wiki/Massive_open_online_course">MOOC</a> covering an <a href="https://class.stanford.edu/courses/HumanitiesScience/StatLearning/Winter2014/about">introduction to statistical learning</a>. I am very familiar with most of the material in the course, having read <em>Elements of Statistical Learning</em> many times over.</p>

<p>One great thing about the class, however, is that they are truely experts and have collaborated with many of the influencial researchers in their field. Because of this, when covering certain topics, they have included interviews with statisticians who made important developments to the field. When introducing the class to R, they interviewed <a href="https://www.youtube.com/watch?v=jk9S3RTAl38">John Chambers</a>, who was able to give a personal account of the history of S and R because he was one of the developers. Further, when covering resampling methods, they spoke with <a href="https://www.youtube.com/watch?v=6l9V1sINzhE">Brad Efron</a>, who talked about the history of the <a href="http://en.wikipedia.org/wiki/Bootstrapping_%28statistics%29">bootstrap</a> and how he struggled to get it published.</p>

<p>Today, they released <a href="https://www.youtube.com/watch?v=79tR7BvYE6w">a video interview</a> with Jerome Friedman. Friedman revealed many interesting facts about the history of <a href="http://en.wikipedia.org/wiki/Decision_tree_learning">tree-based methods</a>, including the fact that there weren&rsquo;t really any journal articles written about CART when they wrote <a href="http://www.amazon.com/Classification-Regression-Trees-Leo-Breiman/dp/0412048418">their book</a>. There was one quote that I particularly enjoyed.</p>

<blockquote>
  <p>And of course, I&rsquo;m very gratified that something that I was
intellectually interested in for all this time has now
become very popular and very important.
I mean, data has risen to the top.
My only regret is two of my mentors who also pushed it,
probably harder and more effectively than I did &ndash;
namely, John Tukey and Leo Breiman &ndash; are not around to
actually see how data has triumphed over,
say, theorem proving.</p>
</blockquote>

<div class="embed-video-container"><iframe width="640" height="480" src="http://www.youtube.com/embed/79tR7BvYE6w" frameborder="0" allowfullscreen=""></iframe></div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/12/27/top-songs-by-artist-on-cd1025-in-2013/">Top Songs by Artist on CD102.5 in 2013</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-12-27T00:00:00-05:00" pubdate data-updated="true">Dec 27<span>th</span>, 2013</time>
        
         | <a href="/blog/2013/12/27/top-songs-by-artist-on-cd1025-in-2013/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
In a <a href="http://alandgraf.blogspot.com/2013/08/downloading-and-analyzing-cd1025s.html">previous post</a>, I showed you how to scrape playlist data from Columbus, OH alternative rock station <a href="http://cd1025.com/">CD102.5</a>. Since it&#8217;s the end of the year and best-of lists are all the fad, I thought I would share the most popular songs and artists of the year, according to this data. In addition to this, I am going to make an interactive graph using <a href="http://www.rstudio.com/shiny/">Shiny</a>, where the user can select an artist and it will graph the <a href="https://andland.shinyapps.io/CD1025Playlist/">most popular songs</a> from that artist.<br /><br />First off, I am assuming that you have scraped the appropriate data using the code from the previous post.<br /><br /><pre><code class="r">library(lubridate)<br />library(sqldf)<br /><br />playlist=read.csv("CD101Playlist.csv",stringsAsFactors=FALSE)<br />dates=mdy(substring(playlist[,3],nchar(playlist[,3])-9,nchar(playlist[,3])))<br />times=hm(substring(playlist[,3],1,nchar(playlist[,3])-10))<br />playlist$Month=ymd(paste(year(dates),month(dates),"1",sep="-"))<br />playlist$Day=dates<br />playlist$Time=times<br />playlist=playlist[order(playlist$Day,playlist$Time),]</code></pre><br />Next, I will select just the data from 2013 and find the songs that were played most often. <br /><pre><code class="r">playlist=subset(playlist,Day&gt;=mdy("1/1/13"))<br />playlist$ArtistSong=paste(playlist$Artist,playlist$Song,sep="-")<br />top.songs=sqldf("Select ArtistSong, Count(ArtistSong) as Num<br />      From playlist<br />      Group By ArtistSong<br />      Order by Num DESC<br />      Limit 10")<br /></code></pre><br />The top 10 songs are the following:<br /><pre><code class="r">                              Artist-Song Number Plays<br />1  FITZ AND THE TANTRUMS-OUT OF MY LEAGUE 809<br />2                      ALT J-BREEZEBLOCKS 764<br />3              COLD WAR KIDS-MIRACLE MILE 759<br />4                      ATLAS GENIUS-IF SO 750<br />5                         FOALS-MY NUMBER 687<br />6                         MS MR-HURRICANE 679<br />7       THE NEIGHBOURHOOD-SWEATER WEATHER 657<br />8           CAPITAL CITIES-SAFE AND SOUND 646<br />9             VAMPIRE WEEKEND-DIANE YOUNG 639<br />10             THE FEATURES-THIS DISORDER 632<br /></code></pre><br />I will make a plot similar to the plots made in <a href="http://alandgraf.blogspot.com/2013/08/when-did-cd1025-book-summerfest-artists.html">the last post</a> to show when the top 5 songs were played throughout the year.<br /><pre><code class="r">    <br />plays.per.day=sqldf("Select Day, Count(Artist) as Num<br />      From playlist<br />      Group By Day<br />      Order by Day")<br /><br />playlist.top.songs=subset(playlist,ArtistSong %in% top.songs$ArtistSong[1:5])<br /><br />song.per.day=sqldf(paste0("Select Day, ArtistSong, Count(ArtistSong) as Num<br />                          From [playlist.top.songs]<br />                          Group By Day, ArtistSong<br />                          Order by Day, ArtistSong"))<br />dspd=dcast(song.per.day,Day~ArtistSong,sum,value.var="Num")<br /><br />song.per.day=merge(plays.per.day[,1,drop=FALSE],dspd,all.x=TRUE)<br />song.per.day[is.na(song.per.day)]=0<br /><br />song.per.day=melt(song.per.day,1,variable.name="ArtistSong",value.name="Num")<br />song.per.day$Alpha=ifelse(song.per.day$Num&gt;0,1,0)<br /><br />library(ggplot2)<br />ggplot(song.per.day,aes(Day,Num,colour=ArtistSong))+geom_point(aes(alpha=Alpha))+<br />  geom_smooth(method="gam",family=poisson,formula=y~s(x),se=F,size=1)+<br />  labs(x="Date",y="Plays Per Day",title="Top Songs",colour=NULL)+<br />  scale_alpha_continuous(guide=FALSE,range=c(0,.5))+theme_bw()<br /></code></pre><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-JWP3RQkgQeo/Ur4-RG1px7I/AAAAAAAAH-U/JH6gP0Jk6Tc/s1600/TopSongs.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-JWP3RQkgQeo/Ur4-RG1px7I/AAAAAAAAH-U/JH6gP0Jk6Tc/s1600/TopSongs.png" /></a></div>Alt-J was more popular in the beginning of the year and the Foals have been more popular recently.<br /><br />I can similarly summarize by artist as well.<br /><pre><code class="r">top.artists=sqldf("Select Artist, Count(Artist) as Num<br />                From playlist<br />                Group By Artist<br />                Order by Num DESC<br />                Limit 10")<br /></code></pre><br /><pre><code class="r">                    Artist  Num<br />1                     MUSE 1683<br />2          VAMPIRE WEEKEND 1504<br />3        SILVERSUN PICKUPS 1442<br />4                    FOALS 1439<br />5                  PHOENIX 1434<br />6            COLD WAR KIDS 1425<br />7                JAKE BUGG 1316<br />8  QUEENS OF THE STONE AGE 1296<br />9                    ALT J 1233<br />10     OF MONSTERS AND MEN 1150<br /></code></pre><br /><pre><code class="r">playlist.top.artists=subset(playlist,Artist %in% top.artists$Artist[1:5])<br /><br />artists.per.day=sqldf(paste0("Select Day, Artist, Count(Artist) as Num<br />                          From [playlist.top.artists]<br />                          Group By Day, Artist<br />                          Order by Day, Artist"))<br />dspd=dcast(artists.per.day,Day~Artist,sum,value.var="Num")<br /><br />artists.per.day=merge(plays.per.day[,1,drop=FALSE],dspd,all.x=TRUE)<br />artists.per.day[is.na(artists.per.day)]=0<br /><br />artists.per.day=melt(artists.per.day,1,variable.name="Artist",value.name="Num")<br />artists.per.day$Alpha=ifelse(artists.per.day$Num&gt;0,1,0)<br /><br />ggplot(artists.per.day,aes(Day,Num,colour=Artist))+geom_point(aes(alpha=Alpha))+<br />  geom_smooth(method="gam",family=poisson,formula=y~s(x),se=F,size=1)+<br />  labs(x="Date",y="Plays Per Day",title="Top Artists",colour=NULL)+<br />  scale_alpha_continuous(guide=FALSE,range=c(0,.5))+theme_bw()<br /></code></pre><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-57hZwciuIug/Ur5AO9l7NWI/AAAAAAAAH-g/Xi2_4e-FwZw/s1600/TopArtist.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-57hZwciuIug/Ur5AO9l7NWI/AAAAAAAAH-g/Xi2_4e-FwZw/s1600/TopArtist.png" /></a></div>The pattern for the artists are not as clear as it is for the songs.<br /><br />Finally, I wrote <a href="https://andland.shinyapps.io/CD1025Playlist/">a Shiny interactive app</a>. They are surprisingly easy to create and if you are thinking about experimenting with it, I suggest you try it. I will leave the code for the app in <a href="https://gist.github.com/andland/8155783">a gist</a>. In <a href="https://andland.shinyapps.io/CD1025Playlist/">the app</a>, you can enter any artist you want, and it will show you the most popular songs on CD102.5 for that artist. You can also select the number of songs that it plots with the slider.<br /><br />For example, even though Muse did not have one of the most popular songs of the year, they were still the band that was played the most. By typing in &#8220;MUSE&#8221; in the Artist text input, you will get the <a href="https://andland.shinyapps.io/CD1025Playlist/">following output</a>.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-EuKnItqFzCo/Ur5CQELkw0I/AAAAAAAAH-s/Pv4dJwueLQM/s1600/Muse.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-EuKnItqFzCo/Ur5CQELkw0I/AAAAAAAAH-s/Pv4dJwueLQM/s1600/Muse.png" /></a></div>They had two songs that were very popular this year and a few others that were decently popular as well.<br /><br /><a href="https://andland.shinyapps.io/CD1025Playlist/">Play around</a> with it and let me know what you think.</div>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/2/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/04/08/amazon-tradein-price-fluctuations/">Monitoring Price Fluctuations of Book Trade-In Values on Amazon</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/12/24/time-stack-time-slice-r/">Time Stacking and Time Slicing in R</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/04/22/yet-another-baseball-defensive-statistic/">Yet Another Baseball Defense Statistic</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/03/02/hastie-and-tibshirani-interview-jerome-friedman/">Hastie and Tibshirani Interview Jerome Friedman</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/12/27/top-songs-by-artist-on-cd1025-in-2013/">Top Songs by Artist on CD102.5 in 2013</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/andland">@andland</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'andland',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>




<section>
  <h1>Blogroll</h1>
  <p>
  <ul>
	<li><a href="http://www.r-bloggers.com">R-Bloggers</a> </li>
	<li><a href="http://fastml.com/">FastML</a> </li>
	<li><a href="http://blog.kaggle.com/">No Free Hunch (Kaggle)</a> </li>
	<li><a href="http://andrewgelman.com/">Statistical Modeling, Causal Inference, and Social Science</a> </li>
	<li><a href="http://simplystatistics.org/">Simply Statistics</a> </li>
	<li><a href="https://kpq.github.io/chartsnthings/">chartsnthings (NYT Graphics Dept.)</a> </li>
  </ul> 
  </p>
</section>

  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Andrew Landgraf -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'andland';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
