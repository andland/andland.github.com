<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.3.1">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Andrew J. Landgraf">

  
  
  
    
  
  <meta name="description" content="Restricted Boltzmann Machines (RBMs) are an unsupervised learning method (like principal components). An RBM is a probabilistic and undirected graphical model. They are becoming more popular in machine learning due to recent success in training them with contrastive divergence. They have been proven useful in collaborative filtering, being one of the most successful methods in the Netflix challenge (paper). Furthermore, they have been tantamount to training deep learning models, which appear to be the best current models for image and digit recognition.">

  
  <link rel="alternate" hreflang="en-us" href="/2013/01/14/restricted-boltzmann-machines-in-r/">

  


  

  
  
  
  <meta name="theme-color" content="#4caf50">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.0/css/all.css" integrity="sha384-aOkxzJ5uQz7WBObEZcHvV5JvRW3TUc2rNPA7pe3AwnsUohiw1Vj2Rgx2KSOkF5+h" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    

    

  

  
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Montserrat:400,700|Roboto:400,400italic,700|Roboto+Mono">
  

  
  
  
  <link rel="stylesheet" href="/css/academic.min.e0d2efbe79ed0cff78216d15b0b66338.css">

  

  
  
  

  

  <link rel="manifest" href="/site.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="/2013/01/14/restricted-boltzmann-machines-in-r/">

  
  
  
  
    
    
  
  <meta property="twitter:card" content="summary">
  
  <meta property="twitter:site" content="@andland">
  <meta property="twitter:creator" content="@andland">
  
  <meta property="og:site_name" content="Statistically Significant">
  <meta property="og:url" content="/2013/01/14/restricted-boltzmann-machines-in-r/">
  <meta property="og:title" content="Restricted Boltzmann Machines in R | Statistically Significant">
  <meta property="og:description" content="Restricted Boltzmann Machines (RBMs) are an unsupervised learning method (like principal components). An RBM is a probabilistic and undirected graphical model. They are becoming more popular in machine learning due to recent success in training them with contrastive divergence. They have been proven useful in collaborative filtering, being one of the most successful methods in the Netflix challenge (paper). Furthermore, they have been tantamount to training deep learning models, which appear to be the best current models for image and digit recognition."><meta property="og:image" content="/img/icon-192.png">
  <meta property="og:locale" content="en-us">
  
  <meta property="article:published_time" content="2013-01-14T00:00:00&#43;00:00">
  
  <meta property="article:modified_time" content="2013-01-14T00:00:00&#43;00:00">
  

  


  





  <title>Restricted Boltzmann Machines in R | Statistically Significant</title>

</head>


<body id="top" data-spy="scroll" data-target="#TableOfContents" data-offset="71" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" role="textbox" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/">Statistically Significant</a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav mr-auto">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>About</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/projects"><span>Projects</span></a>
        </li>

        
        

      
      </ul>
      <ul class="navbar-nav ml-auto">
      

        

        
        <li class="nav-item">
          <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        

        
        <li class="nav-item">
          <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
        </li>
        

      </ul>

    </div>
  </div>
</nav>


  <article class="article" itemscope itemtype="http://schema.org/Article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1 itemprop="name">Restricted Boltzmann Machines in R</h1>

  

  
    



<meta content="2013-01-14 00:00:00 &#43;0000 UTC" itemprop="datePublished">
<meta content="2013-01-14 00:00:00 &#43;0000 UTC" itemprop="dateModified">

<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    <time>Jan 14, 2013</time>
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    6 min read
  </span>
  

  
  
  <span class="middot-divider"></span>
  <a href="/2013/01/14/restricted-boltzmann-machines-in-r/#disqus_thread"></a>
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder"></i>
    <a href="/categories/deep-learning/">Deep Learning</a>, <a href="/categories/ggplot/">ggplot</a>, <a href="/categories/visualization/">Visualization</a>, <a href="/categories/machine-learning/">machine learning</a>, <a href="/categories/collaborative-filtering/">collaborative filtering</a>, <a href="/categories/r/">R</a></span>
  

  
    
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=Restricted%20Boltzmann%20Machines%20in%20R&amp;url=%2f2013%2f01%2f14%2frestricted-boltzmann-machines-in-r%2f"
         target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=%2f2013%2f01%2f14%2frestricted-boltzmann-machines-in-r%2f"
         target="_blank" rel="noopener">
        <i class="fab fa-facebook-f"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2f2013%2f01%2f14%2frestricted-boltzmann-machines-in-r%2f&amp;title=Restricted%20Boltzmann%20Machines%20in%20R"
         target="_blank" rel="noopener">
        <i class="fab fa-linkedin-in"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=%2f2013%2f01%2f14%2frestricted-boltzmann-machines-in-r%2f&amp;title=Restricted%20Boltzmann%20Machines%20in%20R"
         target="_blank" rel="noopener">
        <i class="fab fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=Restricted%20Boltzmann%20Machines%20in%20R&amp;body=%2f2013%2f01%2f14%2frestricted-boltzmann-machines-in-r%2f">
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>

    














  
</div>



  <div class="article-container">

    <div class="article-style" itemprop="articleBody">
      
<div class='post'>
<a href="http://en.wikipedia.org/wiki/Boltzmann_machine#Restricted_Boltzmann_machine">Restricted Boltzmann Machines</a> (RBMs) are an unsupervised learning method (like principal components).  An RBM is a probabilistic and undirected graphical model. They are  becoming more popular in machine learning due to recent success in  training them with <a href="http://deeplearning.net/tutorial/rbm.html#contrastive-divergence-cd-k">contrastive divergence</a>. They have been proven useful in collaborative filtering, being one of the most successful methods in the Netflix challenge (<a href="http://www.machinelearning.org/proceedings/icml2007/papers/407.pdf">paper</a>). Furthermore, they have been tantamount to training <a href="http://www.nytimes.com/2012/11/24/science/scientists-see-advances-in-deep-learning-a-part-of-artificial-intelligence.html">deep learning</a> models, which appear to be the best current models for image and digit recognition.<br /><br />I do not want to go into too much detail, but I would like to give a high level overview of RBMs. <a href="http://blog.echen.me/2011/07/18/introduction-to-restricted-boltzmann-machines/">Edwin Chen</a> has an introduction that is much better. The usual version of an RBM is  a probabilistic model for binary vectors. An image can be represented  as a binary vector if each pixel that is dark enough is represented as a  1 and the non-dark pixels are 0's. In addition to the visible binary  vector, it is assumed that there is a hidden binary vector, and each  element of the hidden unit is connected to each unit of the visible unit  by symmetric weights. The weights are represented by the matrix <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1-Frame" role="textbox"><nobr><span class="math" id="MathJax-Span-1"><span style="display: inline-block; font-size: 120%; height: 0px; position: relative; width: 1.042em;"><span style="clip: rect(1.775em, 1000em, 2.897em, -0.574em); left: 0em; position: absolute; top: -2.667em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; height: 1px; overflow: hidden; width: 0.104em;"></span></span></span><span style="display: inline-block; height: 2.667em; width: 0px;"></span></span></span><span style="border-left: 0em solid; display: inline-block; height: 1.013em; overflow: hidden; vertical-align: -0.11em; width: 0px;"></span></span></nobr></span>, where the <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-2-Frame" role="textbox"><nobr><span class="math" id="MathJax-Span-4"><span style="display: inline-block; font-size: 120%; height: 0px; position: relative; width: 1.944em;"><span style="clip: rect(1.719em, 1000em, 3.218em, -0.604em); left: 0em; position: absolute; top: -2.806em;"><span class="mrow" id="MathJax-Span-5"><span class="mi" id="MathJax-Span-6" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-7" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-8" style="padding-left: 0.167em;"><span style="display: inline-block; height: 0px; position: relative; width: 1.186em;"><span style="clip: rect(1.797em, 1000em, 3.079em, -0.637em); left: 0em; position: absolute; top: -2.667em;"><span class="mi" id="MathJax-Span-9" style="font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; height: 2.667em; width: 0px;"></span></span><span style="left: 0.417em; position: absolute; top: -2.569em;"><span class="texatom" id="MathJax-Span-10"><span class="mrow" id="MathJax-Span-11"><span class="mi" id="MathJax-Span-12" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">t</span><span class="mi" id="MathJax-Span-13" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">h</span></span></span><span style="display: inline-block; height: 2.181em; width: 0px;"></span></span></span></span></span><span style="display: inline-block; height: 2.806em; width: 0px;"></span></span></span><span style="border-left: 0em solid; display: inline-block; height: 1.466em; overflow: hidden; vertical-align: -0.328em; width: 0px;"></span></span></nobr></span> component is the weight between hidden unit <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3-Frame" role="textbox"><nobr><span class="math" id="MathJax-Span-14"><span style="display: inline-block; font-size: 120%; height: 0px; position: relative; width: 0.347em;"><span style="clip: rect(1.797em, 1000em, 2.886em, -0.604em); left: 0em; position: absolute; top: -2.667em;"><span class="mrow" id="MathJax-Span-15"><span class="mi" id="MathJax-Span-16" style="font-family: MathJax_Math; font-style: italic;">i</span></span><span style="display: inline-block; height: 2.667em; width: 0px;"></span></span></span><span style="border-left: 0em solid; display: inline-block; height: 0.973em; overflow: hidden; vertical-align: -0.097em; width: 0px;"></span></span></nobr></span> and visible unit <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4-Frame" role="textbox"><nobr><span class="math" id="MathJax-Span-17"><span style="display: inline-block; font-size: 120%; height: 0px; position: relative; width: 0.417em;"><span style="clip: rect(1.797em, 1000em, 3.079em, -0.637em); left: 0em; position: absolute; top: -2.667em;"><span class="mrow" id="MathJax-Span-18"><span class="mi" id="MathJax-Span-19" style="font-family: MathJax_Math; font-style: italic;">j</span></span><span style="display: inline-block; height: 2.667em; width: 0px;"></span></span></span><span style="border-left: 0em solid; display: inline-block; height: 1.205em; overflow: hidden; vertical-align: -0.328em; width: 0px;"></span></span></nobr></span>.  It is important that there are no connections between hidden units or  between visible units. The probability that visible unit <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-5-Frame" role="textbox"><nobr><span class="math" id="MathJax-Span-20"><span style="display: inline-block; font-size: 120%; height: 0px; position: relative; width: 0.417em;"><span style="clip: rect(1.797em, 1000em, 3.079em, -0.637em); left: 0em; position: absolute; top: -2.667em;"><span class="mrow" id="MathJax-Span-21"><span class="mi" id="MathJax-Span-22" style="font-family: MathJax_Math; font-style: italic;">j</span></span><span style="display: inline-block; height: 2.667em; width: 0px;"></span></span></span><span style="border-left: 0em solid; display: inline-block; height: 1.205em; overflow: hidden; vertical-align: -0.328em; width: 0px;"></span></span></nobr></span> is 1 is the inverse logistic function of the sum of the weights connected to visible unit <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-6-Frame" role="textbox"><nobr><span class="math" id="MathJax-Span-23"><span style="display: inline-block; font-size: 120%; height: 0px; position: relative; width: 0.417em;"><span style="clip: rect(1.797em, 1000em, 3.079em, -0.637em); left: 0em; position: absolute; top: -2.667em;"><span class="mrow" id="MathJax-Span-24"><span class="mi" id="MathJax-Span-25" style="font-family: MathJax_Math; font-style: italic;">j</span></span><span style="display: inline-block; height: 2.667em; width: 0px;"></span></span></span><span style="border-left: 0em solid; display: inline-block; height: 1.205em; overflow: hidden; vertical-align: -0.328em; width: 0px;"></span></span></nobr></span>, in which the hidden units are 1. In math notation (where <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-7-Frame" role="textbox"><nobr><span class="math" id="MathJax-Span-26"><span style="display: inline-block; font-size: 120%; height: 0px; position: relative; width: 0.556em;"><span style="clip: rect(2.027em, 1000em, 2.886em, -0.594em); left: 0em; position: absolute; top: -2.667em;"><span class="mrow" id="MathJax-Span-27"><span class="mi" id="MathJax-Span-28" style="font-family: MathJax_Math; font-style: italic;">σ<span style="display: inline-block; height: 1px; overflow: hidden; width: 0.001em;"></span></span></span><span style="display: inline-block; height: 2.667em; width: 0px;"></span></span></span><span style="border-left: 0em solid; display: inline-block; height: 0.697em; overflow: hidden; vertical-align: -0.097em; width: 0px;"></span></span></nobr></span> is the inverse logistic, or sigmoid, function):<br /><span class="MathJax_Preview"></span><br /><div class="MathJax_Display" role="textbox" style="text-align: center;"><span class="MathJax" id="MathJax-Element-8-Frame"><nobr><span class="math" id="MathJax-Span-29"><span style="display: inline-block; font-size: 120%; height: 0px; position: relative; width: 14.306em;"><span style="clip: rect(1.647em, 1000em, 4.206em, -0.592em); left: 0em; position: absolute; top: -2.806em;"><span class="mrow" id="MathJax-Span-30"><span class="mi" id="MathJax-Span-31" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; height: 1px; overflow: hidden; width: 0.109em;"></span></span><span class="mi" id="MathJax-Span-32" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mo" id="MathJax-Span-33" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-34"><span style="display: inline-block; height: 0px; position: relative; width: 0.839em;"><span style="clip: rect(2.015em, 1000em, 2.886em, -0.604em); left: 0em; position: absolute; top: -2.667em;"><span class="mi" id="MathJax-Span-35" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; height: 2.667em; width: 0px;"></span></span><span style="left: 0.486em; position: absolute; top: -2.031em;"><span class="mi" id="MathJax-Span-36" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">j</span><span style="display: inline-block; height: 2.181em; width: 0px;"></span></span></span></span><span class="mo" id="MathJax-Span-37" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-38" style="font-family: MathJax_Main; padding-left: 0.278em;">1</span><span class="texatom" id="MathJax-Span-39"><span class="mrow" id="MathJax-Span-40"><span class="mo" id="MathJax-Span-41" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-42" style="font-family: MathJax_Math; font-style: italic;">h</span><span class="mo" id="MathJax-Span-43" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-44" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">W<span style="display: inline-block; height: 1px; overflow: hidden; width: 0.104em;"></span></span><span class="mo" id="MathJax-Span-45" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-46" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-47" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">σ<span style="display: inline-block; height: 1px; overflow: hidden; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-48" style="font-family: MathJax_Main;">(</span><span class="munderover" id="MathJax-Span-49"><span style="display: inline-block; height: 0px; position: relative; width: 1.458em;"><span style="clip: rect(2.758em, 1000em, 4.575em, -0.57em); left: 0em; position: absolute; top: -3.917em;"><span class="mo" id="MathJax-Span-50" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; height: 3.917em; width: 0px;"></span></span><span style="clip: rect(1.505em, 1000em, 2.497em, -0.61em); left: 0.59em; position: absolute; top: -1.096em;"><span class="mi" id="MathJax-Span-51" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">i</span><span style="display: inline-block; height: 2.181em; width: 0px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-52" style="padding-left: 0.167em;"><span style="display: inline-block; height: 0px; position: relative; width: 0.908em;"><span style="clip: rect(1.764em, 1000em, 2.886em, -0.577em); left: 0em; position: absolute; top: -2.667em;"><span class="mi" id="MathJax-Span-53" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; height: 2.667em; width: 0px;"></span></span><span style="left: 0.556em; position: absolute; top: -2.031em;"><span class="mi" id="MathJax-Span-54" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">i</span><span style="display: inline-block; height: 2.181em; width: 0px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-55"><span style="display: inline-block; height: 0px; position: relative; width: 1.777em;"><span style="clip: rect(1.775em, 1000em, 2.897em, -0.574em); left: 0em; position: absolute; top: -2.667em;"><span class="mi" id="MathJax-Span-56" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; height: 1px; overflow: hidden; width: 0.104em;"></span></span><span style="display: inline-block; height: 2.667em; width: 0px;"></span></span><span style="left: 0.938em; position: absolute; top: -2.169em;"><span class="texatom" id="MathJax-Span-57"><span class="mrow" id="MathJax-Span-58"><span class="mi" id="MathJax-Span-59" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">i</span><span class="mo" id="MathJax-Span-60" style="font-family: MathJax_Main; font-size: 70.7%;">,</span><span class="mi" id="MathJax-Span-61" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">j</span></span></span><span style="display: inline-block; height: 2.319em; width: 0px;"></span></span></span></span><span class="mo" id="MathJax-Span-62" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-63" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; height: 2.806em; width: 0px;"></span></span></span><span style="border-left: 0em solid; display: inline-block; height: 2.737em; overflow: hidden; vertical-align: -1.514em; width: 0px;"></span></span></nobr></span></div><br />The weights are symmetric, so<br /><span class="MathJax_Preview"></span><br /><div class="MathJax_Display" role="textbox" style="text-align: center;"><span class="MathJax" id="MathJax-Element-9-Frame"><nobr><span class="math" id="MathJax-Span-64"><span style="display: inline-block; font-size: 120%; height: 0px; position: relative; width: 14.167em;"><span style="clip: rect(1.647em, 1000em, 4.342em, -0.592em); left: 0em; position: absolute; top: -2.806em;"><span class="mrow" id="MathJax-Span-65"><span class="mi" id="MathJax-Span-66" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; height: 1px; overflow: hidden; width: 0.109em;"></span></span><span class="mi" id="MathJax-Span-67" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mo" id="MathJax-Span-68" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-69"><span style="display: inline-block; height: 0px; position: relative; width: 0.908em;"><span style="clip: rect(1.764em, 1000em, 2.886em, -0.577em); left: 0em; position: absolute; top: -2.667em;"><span class="mi" id="MathJax-Span-70" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; height: 2.667em; width: 0px;"></span></span><span style="left: 0.556em; position: absolute; top: -2.031em;"><span class="mi" id="MathJax-Span-71" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">i</span><span style="display: inline-block; height: 2.181em; width: 0px;"></span></span></span></span><span class="mo" id="MathJax-Span-72" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-73" style="font-family: MathJax_Main; padding-left: 0.278em;">1</span><span class="texatom" id="MathJax-Span-74"><span class="mrow" id="MathJax-Span-75"><span class="mo" id="MathJax-Span-76" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-77" style="font-family: MathJax_Math; font-style: italic;">v</span><span class="mo" id="MathJax-Span-78" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-79" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">W<span style="display: inline-block; height: 1px; overflow: hidden; width: 0.104em;"></span></span><span class="mo" id="MathJax-Span-80" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-81" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-82" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">σ<span style="display: inline-block; height: 1px; overflow: hidden; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-83" style="font-family: MathJax_Main;">(</span><span class="munderover" id="MathJax-Span-84"><span style="display: inline-block; height: 0px; position: relative; width: 1.458em;"><span style="clip: rect(2.758em, 1000em, 4.575em, -0.57em); left: 0em; position: absolute; top: -3.917em;"><span class="mo" id="MathJax-Span-85" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; height: 3.917em; width: 0px;"></span></span><span style="clip: rect(1.505em, 1000em, 2.633em, -0.633em); left: 0.59em; position: absolute; top: -1.096em;"><span class="mi" id="MathJax-Span-86" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">j</span><span style="display: inline-block; height: 2.181em; width: 0px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-87" style="padding-left: 0.167em;"><span style="display: inline-block; height: 0px; position: relative; width: 0.839em;"><span style="clip: rect(2.015em, 1000em, 2.886em, -0.604em); left: 0em; position: absolute; top: -2.667em;"><span class="mi" id="MathJax-Span-88" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; height: 2.667em; width: 0px;"></span></span><span style="left: 0.486em; position: absolute; top: -2.031em;"><span class="mi" id="MathJax-Span-89" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">j</span><span style="display: inline-block; height: 2.181em; width: 0px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-90"><span style="display: inline-block; height: 0px; position: relative; width: 1.777em;"><span style="clip: rect(1.775em, 1000em, 2.897em, -0.574em); left: 0em; position: absolute; top: -2.667em;"><span class="mi" id="MathJax-Span-91" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; height: 1px; overflow: hidden; width: 0.104em;"></span></span><span style="display: inline-block; height: 2.667em; width: 0px;"></span></span><span style="left: 0.938em; position: absolute; top: -2.169em;"><span class="texatom" id="MathJax-Span-92"><span class="mrow" id="MathJax-Span-93"><span class="mi" id="MathJax-Span-94" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">i</span><span class="mo" id="MathJax-Span-95" style="font-family: MathJax_Main; font-size: 70.7%;">,</span><span class="mi" id="MathJax-Span-96" style="font-family: MathJax_Math; font-size: 70.7%; font-style: italic;">j</span></span></span><span style="display: inline-block; height: 2.319em; width: 0px;"></span></span></span></span><span class="mo" id="MathJax-Span-97" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-98" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; height: 2.806em; width: 0px;"></span></span></span><span style="border-left: 0em solid; display: inline-block; height: 2.901em; overflow: hidden; vertical-align: -1.677em; width: 0px;"></span></span></nobr></span></div>As you can see, the model is defined by its conditional probabilities. The task is to find the weight matrix <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-10-Frame" role="textbox"><nobr><span class="math" id="MathJax-Span-99"><span style="display: inline-block; font-size: 120%; height: 0px; position: relative; width: 1.042em;"><span style="clip: rect(1.775em, 1000em, 2.897em, -0.574em); left: 0em; position: absolute; top: -2.667em;"><span class="mrow" id="MathJax-Span-100"><span class="mi" id="MathJax-Span-101" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; height: 1px; overflow: hidden; width: 0.104em;"></span></span></span><span style="display: inline-block; height: 2.667em; width: 0px;"></span></span></span><span style="border-left: 0em solid; display: inline-block; height: 1.013em; overflow: hidden; vertical-align: -0.11em; width: 0px;"></span></span></nobr></span> that best explains the visible data for a given number of hidden units.<br /><br />I have been taking Geoff Hinton's <a href="https://class.coursera.org/neuralnets-2012-001/">coursera course</a> on neural networks, which I would recommend to anyone interested. One  of the programming assignments was to fill in code to write an RBM in  Matlab/Octave. I have since tried to find a version for R, but have not  had any luck, so I decided to translate the code myself. Below is the  code to calculate the weight matrix. It is fairly simple and I only use  contrastive divergence 1. The input data is <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-11-Frame" role="textbox"><nobr><span class="math" id="MathJax-Span-102"><span style="display: inline-block; font-size: 120%; height: 0px; position: relative; width: 2.292em;"><span style="clip: rect(2.106em, 1000em, 3.208em, -0.664em); left: 0em; position: absolute; top: -2.806em;"><span class="mrow" id="MathJax-Span-103"><span class="mi" id="MathJax-Span-104" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-105" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="mi" id="MathJax-Span-106" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">n</span></span><span style="display: inline-block; height: 2.806em; width: 0px;"></span></span></span><span style="border-left: 0em solid; display: inline-block; height: 0.989em; overflow: hidden; vertical-align: -0.316em; width: 0px;"></span></span></nobr></span> instead of the usual transpose.<br /><br /><div style="overflow: auto;"><div class="geshifilter"><pre class="r geshifilter-R" style="font-family: monospace;"><span style="color: #666666; font-style: italic;"># rbm_w is a matrix of size &lt;number of hidden units&gt; by &lt;number of visible units&gt;</span><br /><span style="color: #666666; font-style: italic;"># visible_state is matrix of size &lt;number of visible units&gt; by &lt;number of data cases&gt;</span><br /><span style="color: #666666; font-style: italic;"># hidden_state is a binary matrix of size &lt;number of hidden units&gt; by &lt;number of data cases&gt;</span><br />&nbsp;<br />visible_state_to_hidden_probabilities &lt;- <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">(</span>rbm_w<span style="color: #339933;">,</span> visible_state<span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br />  <span style="color: #cc66cc;">1</span>/<span style="color: #009900;">(</span><span style="color: #cc66cc;">1</span>+<a href="http://inside-r.org/r-doc/base/exp"><span style="color: #003399; font-weight: bold;">exp</span></a><span style="color: #009900;">(</span>-rbm_w %*% visible_state<span style="color: #009900;">)</span><span style="color: #009900;">)</span><br /><span style="color: #009900;">}</span><br />&nbsp;<br />hidden_state_to_visible_probabilities &lt;- <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">(</span>rbm_w<span style="color: #339933;">,</span> hidden_state<span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br />  <span style="color: #cc66cc;">1</span>/<span style="color: #009900;">(</span><span style="color: #cc66cc;">1</span>+<a href="http://inside-r.org/r-doc/base/exp"><span style="color: #003399; font-weight: bold;">exp</span></a><span style="color: #009900;">(</span>-<a href="http://inside-r.org/r-doc/base/t"><span style="color: #003399; font-weight: bold;">t</span></a><span style="color: #009900;">(</span>rbm_w<span style="color: #009900;">)</span> %*% hidden_state<span style="color: #009900;">)</span><span style="color: #009900;">)</span><br /><span style="color: #009900;">}</span><br />&nbsp;<br />configuration_goodness &lt;- <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">(</span>rbm_w<span style="color: #339933;">,</span> visible_state<span style="color: #339933;">,</span> hidden_state<span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br />  out=<span style="color: #cc66cc;">0</span><br />  <span style="color: black; font-weight: bold;">for</span> <span style="color: #009900;">(</span>i <span style="color: black; font-weight: bold;">in</span> <span style="color: #cc66cc;">1</span>:<a href="http://inside-r.org/r-doc/base/dim"><span style="color: #003399; font-weight: bold;">dim</span></a><span style="color: #009900;">(</span>visible_state<span style="color: #009900;">)</span><span style="color: #009900;">[</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">]</span><span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br />    out=out+<a href="http://inside-r.org/r-doc/base/t"><span style="color: #003399; font-weight: bold;">t</span></a><span style="color: #009900;">(</span>hidden_state<span style="color: #009900;">[</span><span style="color: #339933;">,</span>i<span style="color: #009900;">]</span><span style="color: #009900;">)</span> %*% rbm_w %*% visible_state<span style="color: #009900;">[</span><span style="color: #339933;">,</span>i<span style="color: #009900;">]</span><br />  <span style="color: #009900;">}</span><br />  out/dim<span style="color: #009900;">(</span>visible_state<span style="color: #009900;">)</span><span style="color: #009900;">[</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">]</span><br /><span style="color: #009900;">}</span><br />&nbsp;<br />configuration_goodness_gradient &lt;- <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">(</span>visible_state<span style="color: #339933;">,</span> hidden_state<span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br />  hidden_state %*% <a href="http://inside-r.org/r-doc/base/t"><span style="color: #003399; font-weight: bold;">t</span></a><span style="color: #009900;">(</span>visible_state<span style="color: #009900;">)</span>/dim<span style="color: #009900;">(</span>visible_state<span style="color: #009900;">)</span><span style="color: #009900;">[</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">]</span><br /><span style="color: #009900;">}</span><br />&nbsp;<br />sample_bernoulli &lt;- <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">(</span>mat<span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br />  dims=<a href="http://inside-r.org/r-doc/base/dim"><span style="color: #003399; font-weight: bold;">dim</span></a><span style="color: #009900;">(</span>mat<span style="color: #009900;">)</span><br />  <a href="http://inside-r.org/r-doc/base/matrix"><span style="color: #003399; font-weight: bold;">matrix</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/stats/rbinom"><span style="color: #003399; font-weight: bold;">rbinom</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/prod"><span style="color: #003399; font-weight: bold;">prod</span></a><span style="color: #009900;">(</span>dims<span style="color: #009900;">)</span><span style="color: #339933;">,</span>size=<span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><a href="http://inside-r.org/packages/cran/prob">prob</a>=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">(</span>mat<span style="color: #009900;">)</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span>dims<span style="color: #009900;">[</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">]</span><span style="color: #339933;">,</span>dims<span style="color: #009900;">[</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">]</span><span style="color: #009900;">)</span><br /><span style="color: #009900;">}</span><br />&nbsp;<br />cd1 &lt;- <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">(</span>rbm_w<span style="color: #339933;">,</span> visible_data<span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br />  visible_data = sample_bernoulli<span style="color: #009900;">(</span>visible_data<span style="color: #009900;">)</span><br />  H0=sample_bernoulli<span style="color: #009900;">(</span>visible_state_to_hidden_probabilities<span style="color: #009900;">(</span>rbm_w<span style="color: #339933;">,</span> visible_data<span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />  vh0=configuration_goodness_gradient<span style="color: #009900;">(</span>visible_data<span style="color: #339933;">,</span> H0<span style="color: #009900;">)</span><br />  V1=sample_bernoulli<span style="color: #009900;">(</span>hidden_state_to_visible_probabilities<span style="color: #009900;">(</span>rbm_w<span style="color: #339933;">,</span> H0<span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />  H1=visible_state_to_hidden_probabilities<span style="color: #009900;">(</span>rbm_w<span style="color: #339933;">,</span> V1<span style="color: #009900;">)</span><br />  vh1=configuration_goodness_gradient<span style="color: #009900;">(</span>V1<span style="color: #339933;">,</span> H1<span style="color: #009900;">)</span><br />  vh0-vh1<br /><span style="color: #009900;">}</span><br />&nbsp;<br />rbm &lt;- <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">(</span>num_hidden<span style="color: #339933;">,</span> training_data<span style="color: #339933;">,</span> learning_rate<span style="color: #339933;">,</span> n_iterations<span style="color: #339933;">,</span> mini_batch_size=<span style="color: #cc66cc;">100</span><span style="color: #339933;">,</span> momentum=<span style="color: #cc66cc;">0.9</span><span style="color: #339933;">,</span> quiet=<span style="color: black; font-weight: bold;">FALSE</span><span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br /><span style="color: #666666; font-style: italic;">#   This trains a model that's defined by a single matrix of weights.</span><br /><span style="color: #666666; font-style: italic;">#   &lt;num_hidden&gt; is the number of hidden units</span><br /><span style="color: #666666; font-style: italic;">#   cd1 is a function that takes parameters &lt;model&gt; and &lt;data&gt; and returns the gradient (or approximate gradient in the case of CD-1) of the function that we're maximizing. Note the contrast with the loss function that we saw in PA3, which we were minimizing. The returned gradient is an array of the same shape as the provided &lt;model&gt; parameter.</span><br /><span style="color: #666666; font-style: italic;">#   This uses mini-batches no weight decay and no early stopping.</span><br /><span style="color: #666666; font-style: italic;">#   This returns the matrix of weights of the trained model.</span><br />  n=<a href="http://inside-r.org/r-doc/base/dim"><span style="color: #003399; font-weight: bold;">dim</span></a><span style="color: #009900;">(</span>training_data<span style="color: #009900;">)</span><span style="color: #009900;">[</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">]</span><br />  p=<a href="http://inside-r.org/r-doc/base/dim"><span style="color: #003399; font-weight: bold;">dim</span></a><span style="color: #009900;">(</span>training_data<span style="color: #009900;">)</span><span style="color: #009900;">[</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">]</span><br />  <span style="color: black; font-weight: bold;">if</span> <span style="color: #009900;">(</span>n %% mini_batch_size != <span style="color: #cc66cc;">0</span><span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br />    <a href="http://inside-r.org/r-doc/base/stop"><span style="color: #003399; font-weight: bold;">stop</span></a><span style="color: #009900;">(</span><span style="color: blue;">"the number of test cases must be divisable by the mini_batch_size"</span><span style="color: #009900;">)</span><br />  <span style="color: #009900;">}</span><br />  model = <span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/matrix"><span style="color: #003399; font-weight: bold;">matrix</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/stats/runif"><span style="color: #003399; font-weight: bold;">runif</span></a><span style="color: #009900;">(</span>num_hidden*p<span style="color: #009900;">)</span><span style="color: #339933;">,</span>num_hidden<span style="color: #339933;">,</span>p<span style="color: #009900;">)</span> * <span style="color: #cc66cc;">2</span> - <span style="color: #cc66cc;">1</span><span style="color: #009900;">)</span> * <span style="color: #cc66cc;">0.1</span><br />  momentum_speed = <a href="http://inside-r.org/r-doc/base/matrix"><span style="color: #003399; font-weight: bold;">matrix</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span>num_hidden<span style="color: #339933;">,</span>p<span style="color: #009900;">)</span><br />&nbsp;<br />  start_of_next_mini_batch = <span style="color: #cc66cc;">1</span><span style="color: #339933;">;</span><br />  <span style="color: black; font-weight: bold;">for</span> <span style="color: #009900;">(</span>iteration_number <span style="color: black; font-weight: bold;">in</span> <span style="color: #cc66cc;">1</span>:n_iterations<span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br />    <span style="color: black; font-weight: bold;">if</span> <span style="color: #009900;">(</span>!quiet<span style="color: #009900;">)</span> <span style="color: #009900;">{</span><a href="http://inside-r.org/r-doc/base/cat"><span style="color: #003399; font-weight: bold;">cat</span></a><span style="color: #009900;">(</span><span style="color: blue;">"Iter"</span><span style="color: #339933;">,</span>iteration_number<span style="color: #339933;">,</span><span style="color: blue;">"<span style="color: #000099; font-weight: bold;">\n</span>"</span><span style="color: #009900;">)</span><span style="color: #009900;">}</span><br />    mini_batch = training_data<span style="color: #009900;">[</span><span style="color: #339933;">,</span> start_of_next_mini_batch:<span style="color: #009900;">(</span>start_of_next_mini_batch + mini_batch_size - <span style="color: #cc66cc;">1</span><span style="color: #009900;">)</span><span style="color: #009900;">]</span><br />    start_of_next_mini_batch = <span style="color: #009900;">(</span>start_of_next_mini_batch + mini_batch_size<span style="color: #009900;">)</span> %% n<br />    gradient = cd1<span style="color: #009900;">(</span>model<span style="color: #339933;">,</span> mini_batch<span style="color: #009900;">)</span><br />    momentum_speed = momentum * momentum_speed + gradient<br />    model = model + momentum_speed * learning_rate<br />  <span style="color: #009900;">}</span><br />  <a href="http://inside-r.org/r-doc/base/return"><span style="color: #003399; font-weight: bold;">return</span></a><span style="color: #009900;">(</span>model<span style="color: #009900;">)</span><br /><span style="color: #009900;">}</span></pre></div></div><a href="http://www.inside-r.org/pretty-r" title="Created by Pretty R at inside-R.org">Created by Pretty R at inside-R.org</a><br /><br />I loaded the hand written digit data that was given in the class. To train the RBM, use the syntax below.<br /><br /><div style="overflow: auto;"><div class="geshifilter"><pre class="r geshifilter-R" style="font-family: monospace;"><a href="http://inside-r.org/r-doc/stats/weights"><span style="color: #003399; font-weight: bold;">weights</span></a>=rbm<span style="color: #009900;">(</span>num_hidden=<span style="color: #cc66cc;">30</span><span style="color: #339933;">,</span> training_data=train<span style="color: #339933;">,</span> learning_rate=<span style="color: #cc66cc;">.09</span><span style="color: #339933;">,</span> n_iterations=<span style="color: #cc66cc;">5000</span><span style="color: #339933;">,</span><br />            mini_batch_size=<span style="color: #cc66cc;">100</span><span style="color: #339933;">,</span> momentum=<span style="color: #cc66cc;">0.9</span><span style="color: #009900;">)</span></pre></div></div><a href="http://www.inside-r.org/pretty-r" title="Created by Pretty R at inside-R.org">Created by Pretty R at inside-R.org</a><br /><br />After training the weights, I can visualize them. Below is a plot of  strength of the weights going to each pixel. Each facet displays the  weights going to/coming from one of the hidden units. I trained 30 units  so that it would be easy to show them all on one plot. You can see that  most of the hidden units correspond strongly to one digit or another. I  think this means it is finding the joint structure of all of the pixels  and that pixels representing those numbers are darkened together often.<br /><br /><div style="overflow: auto;"><div class="geshifilter"><pre class="r geshifilter-R" style="font-family: monospace;"><a href="http://inside-r.org/r-doc/base/library"><span style="color: #003399; font-weight: bold;">library</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/packages/cran/ggplot2">ggplot2</a><span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/base/library"><span style="color: #003399; font-weight: bold;">library</span></a><span style="color: #009900;">(</span>reshape2<span style="color: #009900;">)</span><br />mw=melt<span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/stats/weights"><span style="color: #003399; font-weight: bold;">weights</span></a><span style="color: #009900;">)</span><span style="color: #339933;">;</span> mw$Var3=<a href="http://inside-r.org/r-doc/base/floor"><span style="color: #003399; font-weight: bold;">floor</span></a><span style="color: #009900;">(</span><span style="color: #009900;">(</span>mw$Var2-<span style="color: #cc66cc;">1</span><span style="color: #009900;">)</span>/<span style="color: #cc66cc;">16</span><span style="color: #009900;">)</span>+<span style="color: #cc66cc;">1</span><span style="color: #339933;">;</span> mw$Var2=<span style="color: #009900;">(</span>mw$Var2-<span style="color: #cc66cc;">1</span><span style="color: #009900;">)</span>%%16 + <span style="color: #cc66cc;">1</span><span style="color: #339933;">;</span> mw$Var3=<span style="color: #cc66cc;">17</span>-mw$Var3<span style="color: #339933;">;</span><br /><a href="http://inside-r.org/packages/cran/ggplot">ggplot</a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=mw<span style="color: #009900;">)</span>+geom_tile<span style="color: #009900;">(</span>aes<span style="color: #009900;">(</span>Var2<span style="color: #339933;">,</span>Var3<span style="color: #339933;">,</span>fill=value<span style="color: #009900;">)</span><span style="color: #009900;">)</span>+facet_wrap<span style="color: #009900;">(</span>~Var1<span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/nrow"><span style="color: #003399; font-weight: bold;">nrow</span></a>=<span style="color: #cc66cc;">5</span><span style="color: #009900;">)</span>+<br />  scale_fill_continuous<span style="color: #009900;">(</span>low=<span style="color: blue;">'white'</span><span style="color: #339933;">,</span>high=<span style="color: blue;">'black'</span><span style="color: #009900;">)</span>+coord_equal<span style="color: #009900;">(</span><span style="color: #009900;">)</span>+<br />  labs<span style="color: #009900;">(</span>x=<span style="color: black; font-weight: bold;">NULL</span><span style="color: #339933;">,</span>y=<span style="color: black; font-weight: bold;">NULL</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/graphics/title"><span style="color: #003399; font-weight: bold;">title</span></a>=<span style="color: blue;">"Visualization of Weights"</span><span style="color: #009900;">)</span>+<br />  theme<span style="color: #009900;">(</span>legend.position=<span style="color: blue;">"none"</span><span style="color: #009900;">)</span></pre></div></div><a href="http://www.inside-r.org/pretty-r" title="Created by Pretty R at inside-R.org">Created by Pretty R at inside-R.org</a><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-ZSuYvhPTiI4/UPAlFt8sYJI/AAAAAAAAHpo/DcATXHnKMPU/s1600/unnamed-chunk-4.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-ZSuYvhPTiI4/UPAlFt8sYJI/AAAAAAAAHpo/DcATXHnKMPU/s1600/unnamed-chunk-4.png" /></a></div></div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>Andrew Landgraf</div>
<div class='content'>
There are no biases in this implementation. You could make v_1=1, but there still wouldn&#39;t be biases in the hidden units.</div>
</div>
<div class='comment'>
<div class='author'>sidharth</div>
<div class='content'>
where are the biases ? have you included them in the weights ?</div>
</div>
<div class='comment'>
<div class='author'>Andrew Landgraf</div>
<div class='content'>
The weights are randomly initialized, so any 2 runs will give different results. However, if your figure looks similar to mine, in that it looks like the weights represent numbers, I would say it is working correctly.</div>
</div>
<div class='comment'>
<div class='author'>Xiaolin Gui</div>
<div class='content'>
Thank you for sharing your code.I found the output figure had different with yours when I  do the experiment. I have load the MNIST image data successfully. And the data&#39;s format is 784 ×60000.  The pixels have been binarization. &gt;= 127——&gt;1.<br />I hope you give me some advice.<br />email:guixiaolinde@gmail.com </div>
</div>
<div class='comment'>
<div class='author'>Anonymous</div>
<div class='content'>
I have managed to import the training data (from the Coursera website) into R:<br /><br />library(R.matlab)<br />dat = readMat(&quot;data_set.mat&quot;)<br />......<br />weights=rbm(num_hidden=30, training_data= dat$data[,,1]$training[[1]], learning_rate=.09, n_iterations=5000,<br />            mini_batch_size=100, momentum=0.9)<br /></div>
</div>
<div class='comment'>
<div class='author'>Kent Johnson</div>
<div class='content'>
R code for assignment 4 was posted here:<br />https://class.coursera.org/neuralnets-2012-001/forum/thread?thread_id=87&amp;post_id=5105<br />I used it as the basis for a work project.</div>
</div>
<div class='comment'>
<div class='author'>Zachary Mayer</div>
<div class='content'>
I believe there&#39;s also a kaggle competition using that data right now: http://www.kaggle.com/c/digit-recognizer</div>
</div>
<div class='comment'>
<div class='author'>Andrew</div>
<div class='content'>
I don&#39;t want to post it here because of possible copyright violations, but you can download it in Octave format from the Coursera site (in programming assignment 4) or you can find it at this webpage: http://yann.lecun.com/exdb/mnist/</div>
</div>
<div class='comment'>
<div class='author'>Anonymous</div>
<div class='content'>
Do you have a sample of training data?</div>
</div>
</div>

    </div>

    



    
      








  





  
  
  
    
  
  
  <div class="media author-card" itemscope itemtype="http://schema.org/Person">
    
      
      <img class="portrait mr-3" src="/authors/admin/avatar_hu55984dfb8f2011d19787822cabaad933_1435681_250x250_fill_q90_lanczos_center.jpg" itemprop="image" alt="Avatar">
    

    <div class="media-body">
      <h5 class="card-title" itemprop="name"><a href="/">Andrew J. Landgraf</a></h5>
      <h6 class="card-subtitle">Data Scientist</h6>
      
      <ul class="network-icon" aria-hidden="true">
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="https://www.linkedin.com/in/andrewjlandgraf/" target="_blank" rel="noopener">
              <i class="fab fa-linkedin"></i>
            </a>
          </li>
        
          
          
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="https://scholar.google.co.uk/citations?user=B5V0hz4AAAAJ" target="_blank" rel="noopener">
              <i class="ai ai-google-scholar"></i>
            </a>
          </li>
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="https://github.com/andland" target="_blank" rel="noopener">
              <i class="fab fa-github"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>



      
      
    

    

    
<section id="comments">
  <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "andland" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>



  </div>
</article>

      

    
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js" integrity="sha256-aYTdUrn6Ow1DDgh5JTc3aDGnnju48y/1c8s1dgkYPQ8=" crossorigin="anonymous"></script>
        
      

      
      
    

    
    

    
    
    
    <script id="dsq-count-scr" src="//andland.disqus.com/count.js" async></script>
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script>
      const search_index_filename = "/index.json";
      const i18n = {
        'placeholder': "Search...",
        'results': "results found",
        'no_results': "No results found"
      };
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.9ef1b53ee2bde6c7f33b150c6ba4d452.js"></script>

    






  
  <div class="container">
    <footer class="site-footer">
  

  <p class="powered-by">
    

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" id="back_to_top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
