<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>statistics on Statistically Significant</title>
    <link>/categories/statistics/</link>
    <description>Recent content in statistics on Statistically Significant</description>
    <generator>Source Themes Academic (https://sourcethemes.com/academic/)</generator>
    <language>en-us</language>
    <lastBuildDate>Tue, 22 Apr 2014 00:00:00 +0000</lastBuildDate>
    
	    <atom:link href="/categories/statistics/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>Yet Another Baseball Defense Statistic</title>
      <link>/2014/04/22/yet-another-baseball-defense-statistic/</link>
      <pubDate>Tue, 22 Apr 2014 00:00:00 +0000</pubDate>
      
      <guid>/2014/04/22/yet-another-baseball-defense-statistic/</guid>
      <description>

&lt;p&gt;&lt;a href=&#34;http://www.fangraphs.com&#34; target=&#34;_blank&#34;&gt;Fangraphs&lt;/a&gt; recently published an interesting dataset that measures defensive efficiency of fielders. For each player, the &lt;a href=&#34;http://www.fangraphs.com/blogs/inside-edge-fielding-data/&#34; target=&#34;_blank&#34;&gt;Inside Edge&lt;/a&gt; dataset breaks their opportunities to make plays into five categories, ranging from almost impossible to routine. It also records the proportion of times that the player successfully made the play. With this data, we can see how successful each player is for each type of play. I wanted to think of a way to combine these five proportions into one fielding metric. From here on, I will assume that there is no error in categorizing a play as easy or hard and that there is no bias in the categorizations.&lt;/p&gt;

&lt;h3 id=&#34;model&#34;&gt;Model&lt;/h3&gt;

&lt;p&gt;The model I will build is motivated by &lt;a href=&#34;http://en.wikipedia.org/wiki/Ordered_logit&#34; target=&#34;_blank&#34;&gt;ordinal regression&lt;/a&gt;. If we only were concerned with the success rate in one of the categories, we could use standard logistic regression, and the probability that player $i$ successfully made a play would be assumed to be $\sigma(\theta_i)$, where $\sigma()$ is the &lt;a href=&#34;https://en.wikipedia.org/wiki/Logistic_function&#34; target=&#34;_blank&#34;&gt;logistic function&lt;/a&gt;. Using our prior knowledge that plays categorized as easy should have a higher success rate than plays categorized as difficult, I would like to generalize this.&lt;/p&gt;

&lt;p&gt;Say there are only two categories: easy and hard. We could model the probability that player $i$ successfully made an hard play as $\sigma(\theta_i)$ and the probability that he made an easy play as $\sigma(\theta_i+\gamma)$. Here, we would assume that $\gamma$ is the same for all players. This assumption implies that if player $i$ is better than player $j$ at easy plays, he will also be better at hard plays. This is a reasonable assumption, but maybe not true in all cases.&lt;/p&gt;

&lt;p&gt;Since we have five different categories of difficulty, we can generalize this by having $\gamma_k, k=1,\ldots,4$. Again, these $\gamma_k$&amp;rsquo;s would be the same for everyone. A picture of what this looks like for shortstops is below. In this model, every player will effectively be shifting the curve either left or right. A positive $\theta_i$ means the player is better than average and cause the curve to shift left and vice versa for negative $\theta_i$.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/img/InsideEdge/LogitOrdered.png&#34; alt=&#34;Logit Ordered&#34; /&gt;&lt;/p&gt;

&lt;p&gt;I modeled this as a multi-level mixed effects model, with the players being random effects and the $\gamma_k$&amp;rsquo;s being fixed. Technically, I should optimize subject to the condition that the $\gamma_k$&amp;rsquo;s are increasing, but the unconstrained optimization always yields increasing $\gamma_k$&amp;rsquo;s because there is a big difference between success rate in the categories. I used combined data from 2012 and 2013 seasons and included all players with at least one success and one failure. I modeled each position separately. Modeling player effects as random, there is a fair amount of regression to the mean built in. In this sense, I am more trying to estimate the true ability of the player, rather than measuring what he did during the two years. This is an important distinction, which may differ from other defensive statistics.&lt;/p&gt;

&lt;h3 id=&#34;model-fit&#34;&gt;Model fit&lt;/h3&gt;

&lt;p&gt;Below is a summary of the results of the model for shortstops. I am only plotting the players with the at least 800 innings, for readability. A bonus of modeling the data like this is that we get standard error estimates as a result. I plotted the estimated effect of each player along with +/- 2 standard errors. We can be fairly certain that the effects for the top few shortstops is greater than 0 since their confidence intervals do not include 0. The same is true for the bottom few. Images for the other positions can be found &lt;a href=&#34;https://github.com/andland/andland.github.com/tree/master/images/InsideEdge&#34; target=&#34;_blank&#34;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/img/InsideEdge/SSlist.png&#34; alt=&#34;Results for Shortstops&#34; /&gt;&lt;/p&gt;

&lt;p&gt;The results seem to make sense for the most part. Simmons and Tulowitzki have reputations as being strong defenders and Derek Jeter has a reputation as a poor defender.&lt;/p&gt;

&lt;p&gt;Further, I can validate this data by comparing it to other defensive metrics. One that is readily available on Fangraphs is UZR per 150 games. For each position, I took the correlation of my estimated effect with UZR per 150 games, weighted by the number of innings played. Pitchers and catchers do not have UZR&amp;rsquo;s so I cannot compare them. The correlations, which are in the plot below, range from about 0.2 to 0.65.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/img/InsideEdge/CorrelationWithUZR.png&#34; alt=&#34;Correlation with UZR&#34; /&gt;&lt;/p&gt;

&lt;h3 id=&#34;interpreting-parameters&#34;&gt;Interpreting parameters&lt;/h3&gt;

&lt;p&gt;In order to make this fielding metric more useful, I would like to convert the parameters to something more interpretable. One option which makes a lot of sense is &amp;ldquo;plays made above/below average&amp;rdquo;. Given an estimated $\theta_i$ for a player, we can calculate the probability that he would make a play in each of the five categories. We can then compare those probabilities to the probability an average player would make a play in each of the categories, which would be fit with $\theta=0$. Finally, we can weight these differences in probabilities by the relative rate that plays of various difficulties occur.&lt;/p&gt;

&lt;p&gt;For example, assuming there are only two categories again, suppose a player has a 0.10 and 0.05 higher probability than average of making hard and easy plays, respectively. Further assume that 75% of all plays are hard and 25% are easy. On a random play, the improvement in probability over an average player of making a play is $.10(.75)+.05(.25)=0.0875$. If a player has an opportunity for 300 plays in an average season, this player would be $300 \times 0.0875=26.25$ plays better than average over a typical season.&lt;/p&gt;

&lt;p&gt;I will assume that the number of opportunities to make plays is directly related to the number of innings played. To convert innings to opportunities, I took the median number of opportunities per inning for each position. For example, shortstops had the highest opportunities per inning at 0.40 and catchers had the lowest at 0.08. The plot below shows the distribution of opportunities per inning for each position.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/img/InsideEdge/PlaysPerInning.png&#34; alt=&#34;Plays Per Inning by Position&#34; /&gt;&lt;/p&gt;

&lt;p&gt;We can extend this to the impact on saving runs from being scored as well by assuming each successful play saves $x$ runs. I will not do this for this analysis.&lt;/p&gt;

&lt;h3 id=&#34;results&#34;&gt;Results&lt;/h3&gt;

&lt;p&gt;&lt;img src=&#34;/img/InsideEdge/shiny.png&#34; alt=&#34;Shiny app&#34; /&gt;&lt;/p&gt;

&lt;p&gt;[&lt;strong&gt;Update&lt;/strong&gt;: The Shiny app is no longer live, but you can view the resulting estimates in the &lt;a href=&#34;https://github.com/andland/InsideEdgeFielding/blob/master/Shiny/InsideEdgeModelResults.csv&#34; target=&#34;_blank&#34;&gt;Github repository&lt;/a&gt;.]&lt;/p&gt;

&lt;p&gt;Finally, I put together a &lt;a href=&#34;http://www.rstudio.com/shiny/&#34; target=&#34;_blank&#34;&gt;Shiny&lt;/a&gt; app to display &lt;a href=&#34;https://github.com/andland/InsideEdgeFielding/blob/master/Shiny/InsideEdgeModelResults.csv&#34; target=&#34;_blank&#34;&gt;the results&lt;/a&gt;. You can search by team, position, and innings played. A team of &amp;lsquo;- - -&amp;rsquo; means the player played for multiple teams over this period. You can also choose to display the results as a rate statistic (extra plays made per season) or a count statistic (extra plays made over the two seasons). To get a seasonal number, I assume position players played 150 games with 8.5 innings in each game. For pitchers, I assumed that they pitched 30 games, 6 innings each.&lt;/p&gt;

&lt;h3 id=&#34;conclusions-and-future-work&#34;&gt;Conclusions and future work&lt;/h3&gt;

&lt;p&gt;I don&amp;rsquo;t know if I will do anything more with this data, but if I could do it again, I may have modeled each year separately instead of combining the two years together. With that, it would have been interesting to model the effect of age by observing how a player&amp;rsquo;s ability to make a play changes from one year to the next. I also think it would be interesting to see how changing positions affects a players efficiency. For example, we could have a $9 \times 9$ matrix of fixed effects that represent the improvement or degradation in ability as a player switches from their main position to another one. Further assumptions would be needed to make sure the $\theta$&amp;rsquo;s are on the same scale for every position.&lt;/p&gt;

&lt;p&gt;At the very least, this model and its results can be considered another data point in the analysis of a player&amp;rsquo;s fielding ability. One thing we need to be concerned about is the classification of each play into the difficultness categories. The human eye can be fooled into thinking a routine play is hard just because a fielder dove to make the play, when a superior fielder could have made it look easier.&lt;/p&gt;

&lt;h3 id=&#34;code&#34;&gt;Code&lt;/h3&gt;

&lt;p&gt;I have put the R code together to do this analysis in &lt;a href=&#34;https://gist.github.com/andland/c6adb69ea365c2580859&#34; target=&#34;_blank&#34;&gt;a gist&lt;/a&gt;. If there is interest, I will put together a repo with all the data as well.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Update&lt;/strong&gt;: I have a &lt;a href=&#34;https://github.com/andland/InsideEdgeFielding&#34; target=&#34;_blank&#34;&gt;Github repository&lt;/a&gt; with the data, R code for the analysis, the results, and code for the Shiny app. Let me know what you think.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Hastie and Tibshirani Interview Jerome Friedman</title>
      <link>/2014/03/02/hastie-and-tibshirani-interview-jerome-friedman/</link>
      <pubDate>Sun, 02 Mar 2014 00:00:00 +0000</pubDate>
      
      <guid>/2014/03/02/hastie-and-tibshirani-interview-jerome-friedman/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;http://www.stanford.edu/~hastie/&#34; target=&#34;_blank&#34;&gt;Trevor Hastie&lt;/a&gt; and &lt;a href=&#34;http://statweb.stanford.edu/~tibs/&#34; target=&#34;_blank&#34;&gt;Rob Tibshirani&lt;/a&gt; are currently teaching a &lt;a href=&#34;http://en.wikipedia.org/wiki/Massive_open_online_course&#34; target=&#34;_blank&#34;&gt;MOOC&lt;/a&gt; covering an &lt;a href=&#34;https://class.stanford.edu/courses/HumanitiesScience/StatLearning/Winter2014/about&#34; target=&#34;_blank&#34;&gt;introduction to statistical learning&lt;/a&gt;. I am very familiar with most of the material in the course, having read &lt;em&gt;Elements of Statistical Learning&lt;/em&gt; many times over.&lt;/p&gt;

&lt;p&gt;One great thing about the class, however, is that they are truely experts and have collaborated with many of the influencial researchers in their field. Because of this, when covering certain topics, they have included interviews with statisticians who made important developments to the field. When introducing the class to R, they interviewed &lt;a href=&#34;https://www.youtube.com/watch?v=jk9S3RTAl38&#34; target=&#34;_blank&#34;&gt;John Chambers&lt;/a&gt;, who was able to give a personal account of the history of S and R because he was one of the developers. Further, when covering resampling methods, they spoke with &lt;a href=&#34;https://www.youtube.com/watch?v=6l9V1sINzhE&#34; target=&#34;_blank&#34;&gt;Brad Efron&lt;/a&gt;, who talked about the history of the &lt;a href=&#34;http://en.wikipedia.org/wiki/Bootstrapping_%28statistics%29&#34; target=&#34;_blank&#34;&gt;bootstrap&lt;/a&gt; and how he struggled to get it published.&lt;/p&gt;

&lt;p&gt;Today, they released &lt;a href=&#34;https://www.youtube.com/watch?v=79tR7BvYE6w&#34; target=&#34;_blank&#34;&gt;a video interview&lt;/a&gt; with Jerome Friedman. Friedman revealed many interesting facts about the history of &lt;a href=&#34;http://en.wikipedia.org/wiki/Decision_tree_learning&#34; target=&#34;_blank&#34;&gt;tree-based methods&lt;/a&gt;, including the fact that there weren&amp;rsquo;t really any journal articles written about CART when they wrote &lt;a href=&#34;http://www.amazon.com/Classification-Regression-Trees-Leo-Breiman/dp/0412048418&#34; target=&#34;_blank&#34;&gt;their book&lt;/a&gt;. There was one quote that I particularly enjoyed.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;And of course, I&amp;rsquo;m very gratified that something that I was
intellectually interested in for all this time has now
become very popular and very important.
I mean, data has risen to the top.
My only regret is two of my mentors who also pushed it,
probably harder and more effectively than I did &amp;ndash;
namely, John Tukey and Leo Breiman &amp;ndash; are not around to
actually see how data has triumphed over,
say, theorem proving.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div style=&#34;position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;&#34;&gt;
  &lt;iframe src=&#34;//www.youtube.com/embed/79tR7BvYE6w&#34; style=&#34;position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;&#34; allowfullscreen title=&#34;YouTube Video&#34;&gt;&lt;/iframe&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>When Did CD102.5 Book the Summerfest Artists?</title>
      <link>/2013/08/27/when-did-cd102.5-book-the-summerfest-artists/</link>
      <pubDate>Tue, 27 Aug 2013 00:00:00 +0000</pubDate>
      
      <guid>/2013/08/27/when-did-cd102.5-book-the-summerfest-artists/</guid>
      <description>

&lt;h1 id=&#34;cd1025-s-playlist-and-summerfest&#34;&gt;CD1025&amp;rsquo;s Playlist and Summerfest&lt;/h1&gt;

&lt;p&gt;&lt;a href=&#34;http://alandgraf.blogspot.com/2013/08/downloading-and-analyzing-cd1025s.html&#34; target=&#34;_blank&#34;&gt;Last time&lt;/a&gt;, I showed you how to download CD1025&amp;rsquo;s playlist back to last year and did some exploratory analysis to find that there were some gaps in the data. Using this data, I would like to look at the artists that are playing in this week&amp;rsquo;s &lt;a href=&#34;http://cd1025.com/summerfest&#34; target=&#34;_blank&#34;&gt;Summerfest&lt;/a&gt;. Summerfest is one of the biggest shows that CD1025 puts on every year and is hyped quite a bit on the station. I would like to look into whether they play the headliners more once they have booked the artists.&lt;/p&gt;

&lt;p&gt;I am going to concentrate on data from January 1st and on so I don&amp;rsquo;t include too much irrelevant data. Below is a function where I can input a number related to which headliner I want and it will plot the plays per day of that artist from January 1st to the most recent history. I also plot a smooth curve and a vertical line when the lineup was announced on June 24th.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;playlist=subset(playlist,Day&amp;gt;=mdy(&amp;quot;1/1/13&amp;quot;))
plays.per.day=sqldf(&amp;quot;Select Day, Count(Artist) as Num
      From playlist
      Group By Day
      Order by Day&amp;quot;)
summerfest.artists=c(&amp;quot;MATT AND KIM&amp;quot;,&amp;quot;COLD WAR KIDS&amp;quot;,&amp;quot;RA RA RIOT&amp;quot;,&amp;quot;SMITH WESTERNS&amp;quot;,
                       &amp;quot;J. RODDY WALSTON AND THE BUSINESS&amp;quot;,&amp;quot;CAYUCAS&amp;quot;,
                       &amp;quot;THAO AND THE GET DOWN STAY DOWN&amp;quot;,&amp;quot;DALE EARNHARDT JR. JR.&amp;quot;)

plot.plays &amp;lt;- function(artist.num) {
  summerfest=summerfest.artists[artist.num]
  song.per.day=sqldf(paste0(&amp;quot;Select Day, Count(Artist) as Num
                      From playlist
                      Where Artist=&#39;&amp;quot;,summerfest,&amp;quot;&#39;
                      Group By Day
                      Order by Day&amp;quot;))
  song.per.day=merge(plays.per.day[,1,drop=FALSE],song.per.day,all.x=TRUE)
  song.per.day$Num[is.na(song.per.day$Num)]=0
  
  qplot(Day,Num,data=song.per.day,geom=&amp;quot;point&amp;quot;)+labs(x=&amp;quot;Date&amp;quot;,y=&amp;quot;Plays&amp;quot;,title=summerfest,colour=NULL)+
    geom_vline(xintercept=as.numeric(mdy(&amp;quot;6/24/13&amp;quot;)),lty=2)+
    geom_smooth(method=&amp;quot;gam&amp;quot;,family=poisson,formula=y~s(x),se=F,aes(colour=&amp;quot;Smooth&amp;quot;),size=2)
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Doing this with the first artist, Matt and Kim, you can see that the plays per day steadily increased sharply some time in late March and stayed about constant there until the announcement. After the announcement, surprisingly, the plays have decreased. The fact that the plays increased in late March indicates to me that it is possible that they booked Matt and Kim then and increased them in the rotation in order to make the band more familiar to the audience. Of course, there are many other (possibly more reasonable) reasons that the play count increased, so I may be reading into it too much.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;plot.plays(1)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2013-08-27-when-did-cd1025-book-summerfest-artists/MattAndKimPlays.png&#34; alt=&#34;plot of chunk MattAndKimPlays&#34; /&gt;&lt;/p&gt;

&lt;p&gt;I would like to statistically determine when the number of plays changed the most and from that infer when the station had booked the artist. To do this I assume a change point model. Since we are dealing with counts, I will assume that the number of plays in a day follows a Poisson distribution. In a change point model, there is some day, $\tau$, where the mean parameter of the Poisson distribution changes. Before that date, the play counts follow a Poisson with mean $\lambda_1$ and after the mean is $\lambda_2$ ($\lambda_1 \neq \lambda_2$).&lt;/p&gt;

&lt;p&gt;Let $X_i$ be the number of plays for Matt and Kim on date $i$. The generative model is&lt;/p&gt;

&lt;p&gt;$$ X_i \sim Poisson(\lambda_1), i \leq \tau$$&lt;/p&gt;

&lt;p&gt;$$X_i \sim Poisson(\lambda_2), i &amp;gt; \tau$$&lt;/p&gt;

&lt;p&gt;and therefore the likelihood is&lt;/p&gt;

&lt;p&gt;$$\prod_{i=\text{Jan 1}}^{\tau-1} \frac{\lambda_1^{x_i}}{x_i !} e^{\lambda_1}$$&lt;/p&gt;

&lt;p&gt;$$\prod_{i=\tau}^{\text{June 23}} \frac{\lambda_2^{x_i}}{x_i !} e^{\lambda_2}$$&lt;/p&gt;

&lt;p&gt;If $\tau=t$ is known, maximizing the likelihood with respect to $\lambda_1$ and $\lambda_2$ is easy.&lt;/p&gt;

&lt;p&gt;$$\hat{\lambda}_1 = \bar{x}[\leq t]$$&lt;/p&gt;

&lt;p&gt;$$\hat{\lambda}_2 = \bar{x}[&amp;gt; t]$$&lt;/p&gt;

&lt;p&gt;which are the average play counts per day before and after $t$.&lt;/p&gt;

&lt;p&gt;We can easily find the $\hat{\tau}$ that maximizes the likelihood by looping $t$ through every  day from January 1 to June 22, finding the maximum likelihood estimates, and calculating the likelihood. The $t$ that gives the highest likelihood and the corresponding $\lambda$s are the MLEs. A function for the maximized log likelihood is given below for a given $t$.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;log.like.known = function(t) {
    pre = song.per.day$Day &amp;lt;= t
    post = song.per.day$Day &amp;gt; t &amp;amp; song.per.day$Day &amp;lt; mdy(&amp;quot;6/24/13&amp;quot;)
    lambda1hat = sum(song.per.day$Num[pre])/sum(pre)
    lambda2hat = sum(song.per.day$Num[post])/sum(post)
    sum(song.per.day$Num[pre]) * log(lambda1hat) + sum(song.per.day$Num[post]) * 
        log(lambda2hat) + -sum(pre) * lambda1hat - lambda2hat * sum(post)
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;In the code below, I plot the maximized log likelihood for every given $\tau$. You can see that it peaks in the middle of March (March 19th to be specific).&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;summerfest=summerfest.artists[1]
song.per.day=sqldf(paste0(&amp;quot;Select Day, Count(Artist) as Num
                    From playlist
                    Where Artist=&#39;&amp;quot;,summerfest,&amp;quot;&#39;
                    Group By Day
                    Order by Day&amp;quot;))
song.per.day=merge(plays.per.day[,1,drop=FALSE],song.per.day,all.x=TRUE)
song.per.day$Num[is.na(song.per.day$Num)]=0

dts=seq(mdy(01012013),mdy(06222013),by=&amp;quot;1 day&amp;quot;)
loglikes=sapply(dts,log.like.known)
tauhat=dts[which.max(loglikes)]
qplot(dts,loglikes)+geom_vline(xintercept=as.numeric(tauhat),lty=2)+
  labs(x=&amp;quot;Date&amp;quot;,y=&amp;quot;Log Likelihood&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2013-08-27-when-did-cd1025-book-summerfest-artists/MattAndKimTauLike.png&#34; alt=&#34;plot of chunk MattAndKimTauLike&#34; /&gt;&lt;/p&gt;

&lt;p&gt;Combining this information with the previous plot, we can visualize our break point model. First I recalculate the $\lambda$s now that the $\hat{\tau}$ is known. Then I plot the fitted model on the previous plot.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;pre=song.per.day$Day&amp;lt;=tauhat
post=song.per.day$Day&amp;gt;tauhat &amp;amp; song.per.day$Day&amp;lt;mdy(&amp;quot;6/24/13&amp;quot;)
lambda1hat=sum(song.per.day$Num[pre])/sum(pre)
lambda2hat=sum(song.per.day$Num[post])/sum(post)
seg.dat=data.frame(Day=c(mdy(01012013),tauhat,tauhat,mdy(06232013)),
                   Num=c(lambda1hat,lambda1hat,lambda2hat,lambda2hat))
plot.plays(1)+geom_path(data=seg.dat,aes(colour=&amp;quot;Changepoint&amp;quot;),lty=3,size=2)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2013-08-27-when-did-cd1025-book-summerfest-artists/MattAndKimPlaysFitted.png&#34; alt=&#34;plot of chunk MattAndKimPlaysFitted&#34; /&gt;&lt;/p&gt;

&lt;p&gt;The changepoint model seems to fit the data pretty well. You can see that the average plays per day before March 19th was about 0.75, and it jumped up to 3.25 after March 19th. I think this is fairly strong evidence that CD1025 booked Matt and Kim around then and increased their exposure.&lt;/p&gt;

&lt;p&gt;Below, I have done the same with the other headliners. Plays for Cold War Kids have increased gradually, possibly because they recently released an album. The plays for Ra Ra Riot and Smith Westerns, on the other hand, increased quite dramatically. Based on this, I think we can make pretty good guesses of when the headliners were booked, with the possible exception of Cold War Kids.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;plot.plays.change(2)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2013-08-27-when-did-cd1025-book-summerfest-artists/ColdwarKidsPlaysFitted.png&#34; alt=&#34;plot of chunk ColdwarKidsPlaysFitted&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;plot.plays.change(3)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2013-08-27-when-did-cd1025-book-summerfest-artists/RaRaRiotPlaysFitted.png&#34; alt=&#34;plot of chunk RaRaRiotPlaysFitted&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;plot.plays.change(4)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2013-08-27-when-did-cd1025-book-summerfest-artists/SmithWesternsPlaysFitted.png&#34; alt=&#34;plot of chunk SmithWesternsPlaysFitted&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>What Is the Probability of a 16 Seed Beating a 1 Seed?</title>
      <link>/2013/04/21/what-is-the-probability-of-a-16-seed-beating-a-1-seed/</link>
      <pubDate>Sun, 21 Apr 2013 00:00:00 +0000</pubDate>
      
      <guid>/2013/04/21/what-is-the-probability-of-a-16-seed-beating-a-1-seed/</guid>
      <description>
&lt;div class=&#39;post&#39;&gt;
&lt;i&gt;&lt;span id=&#34;goog_1885060128&#34;&gt;&lt;/span&gt;&lt;span id=&#34;goog_1885060129&#34;&gt;&lt;/span&gt;Note: I started this post way back when the NCAA men&#39;s basketball tournament was going on, but didn&#39;t finish it until now. &lt;/i&gt;&lt;br /&gt;&lt;br /&gt;Since the NCAA Men&#39;s Basketball Tournament has moved to 64 teams, a 16 seed as never upset a 1 seed. You might be tempted to say that the probability of such an event must be 0 then. But we know better than that.&lt;br /&gt;&lt;br /&gt;In this post, I am interested in looking at different ways of estimating how the odds of winning a game change as the difference between seeds increases. I was able to download tournament data going back to the 1930s until 2012 from &lt;a href=&#34;http://hoopstournament.net/Database.html&#34;&gt;hoopstournament.net/Database.html&lt;/a&gt;. The tournament expanded to 64 teams in 1985, which is what I used for this post. I only used match ups in which one of the seeds was higher than the other because this was the easiest way to remove duplicates. (The database has each game listed twice, once with the winner as the first team and once with the loser as the first team. The vast majority (98.9%) of games had one team as a higher seed because an equal seed can only happen at the Final Four or later.)&lt;br /&gt;&lt;br /&gt;&lt;div style=&#34;overflow: auto;&#34;&gt;&lt;div class=&#34;geshifilter&#34;&gt;&lt;pre class=&#34;r geshifilter-R&#34; style=&#34;font-family: monospace;&#34;&gt;&lt;a href=&#34;http://inside-r.org/r-doc/base/library&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;library&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/packages/cran/ggplot2&#34;&gt;ggplot2&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;;&lt;/span&gt; theme_set&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;theme_bw&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;br /&gt;brackets=&lt;a href=&#34;http://inside-r.org/r-doc/utils/read.csv&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;read.csv&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: blue;&#34;&gt;&#34;NCAAHistory.csv&#34;&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;br /&gt;&amp;nbsp;&lt;br /&gt;&lt;span style=&#34;color: #666666; font-style: italic;&#34;&gt;# use only data from 1985 on in which the first team has the higher seed&lt;/span&gt;&lt;br /&gt;brackets=&lt;a href=&#34;http://inside-r.org/r-doc/base/subset&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;subset&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;brackets&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;Seed&amp;lt;Opponent.Seed &amp;amp; Year&amp;gt;=&lt;span style=&#34;color: #cc66cc;&#34;&gt;1985&lt;/span&gt; &amp;amp; &lt;a href=&#34;http://inside-r.org/r-doc/base/Round&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;Round&lt;/span&gt;&lt;/a&gt;!=&lt;span style=&#34;color: blue;&#34;&gt;&#34;Opening Round&#34;&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;br /&gt;&amp;nbsp;&lt;br /&gt;brackets$SeedDiff=&lt;a href=&#34;http://inside-r.org/r-doc/base/abs&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;abs&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;brackets$Opponent.Seed-brackets$Seed&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;br /&gt;brackets$HigherSeedWon=&lt;a href=&#34;http://inside-r.org/r-doc/base/ifelse&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;ifelse&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;brackets$Opponent.Seed&amp;gt;brackets$Seed&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;brackets$Wins&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;brackets$Losses&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;br /&gt;brackets$HigherSeedScoreDiff=&lt;a href=&#34;http://inside-r.org/r-doc/base/ifelse&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;ifelse&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;brackets$Opponent.Seed&amp;gt;brackets$Seed&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color: #cc66cc;&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;-&lt;span style=&#34;color: #cc66cc;&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;*&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;brackets$Score-brackets$Opponent.Score&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;a href=&#34;http://www.inside-r.org/pretty-r&#34; title=&#34;Created by Pretty R at inside-R.org&#34;&gt;Created by Pretty R at inside-R.org&lt;/a&gt;&lt;br /&gt;&lt;h3&gt;Use Frequencies&lt;/h3&gt;&lt;div class=&#34;separator&#34; style=&#34;clear: both; text-align: center;&#34;&gt;&lt;/div&gt;The first way is the most simple: look at the historical records when a 16 seed is playing a 1 seed (where the seed difference is 15). As you can see from the plot below, when the seed difference is 15, the higher seeded team has won every time. This is also true when the seed difference is 12, although there have only been 4 games in this scenario. Another oddity is that when the seed difference is 10, the higher seed only has only won 50% of the time. Again, this is largely due to the fact that there have only been 6 games with this seed difference.&lt;br /&gt;&lt;br /&gt;&lt;div style=&#34;overflow: auto;&#34;&gt;&lt;div class=&#34;geshifilter&#34;&gt;&lt;pre class=&#34;r geshifilter-R&#34; style=&#34;font-family: monospace;&#34;&gt;seed.diffs=&lt;a href=&#34;http://inside-r.org/r-doc/base/sort&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;sort&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/base/unique&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;unique&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;brackets$SeedDiff&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;br /&gt;win.pct=&lt;a href=&#34;http://inside-r.org/r-doc/base/sapply&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;sapply&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;seed.diffs&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/base/function&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;function&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;x&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt; &lt;a href=&#34;http://inside-r.org/r-doc/base/mean&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;mean&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;brackets$HigherSeedWon&lt;span style=&#34;color: #009900;&#34;&gt;[&lt;/span&gt;brackets$SeedDiff==x&lt;span style=&#34;color: #009900;&#34;&gt;]&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;a href=&#34;http://inside-r.org/packages/cran/ggplot&#34;&gt;ggplot&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/utils/data&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;data&lt;/span&gt;&lt;/a&gt;=&lt;a href=&#34;http://inside-r.org/r-doc/base/data.frame&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;data.frame&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;seed.diffs&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;win.pct&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;aes&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;seed.diffs&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;win.pct&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;+geom_point&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;+&lt;br /&gt;  geom_hline&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;yintercept=&lt;span style=&#34;color: #cc66cc;&#34;&gt;0.5&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;linetype=&lt;span style=&#34;color: #cc66cc;&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;+&lt;br /&gt;  geom_line&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;+labs&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;x=&lt;span style=&#34;color: blue;&#34;&gt;&#34;Seed Difference&#34;&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;y=&lt;span style=&#34;color: blue;&#34;&gt;&#34;Proportion of Games Won by Higher Seed&#34;&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;a href=&#34;http://www.inside-r.org/pretty-r&#34; title=&#34;Created by Pretty R at inside-R.org&#34;&gt;Created by Pretty R at inside-R.org&lt;/a&gt;&lt;br /&gt;&lt;br /&gt;&lt;div class=&#34;separator&#34; style=&#34;clear: both; text-align: center;&#34;&gt;&lt;a href=&#34;http://4.bp.blogspot.com/-4FoTKgiyX10/UXLrF8YV2tI/AAAAAAAAHtU/jgQ3FfibzQg/s1600/Frequencies.jpeg&#34; imageanchor=&#34;1&#34; style=&#34;margin-left: 1em; margin-right: 1em;&#34;&gt;&lt;img border=&#34;0&#34; src=&#34;http://4.bp.blogspot.com/-4FoTKgiyX10/UXLrF8YV2tI/AAAAAAAAHtU/jgQ3FfibzQg/s1600/Frequencies.jpeg&#34; /&gt;&lt;/a&gt;&lt;/div&gt;&lt;br /&gt;&lt;h3&gt;Use Score Difference&lt;/h3&gt;In many applications, it has been shown that using margin of victory is much more reliable than just wins and losses. For example, in the computer ranking of College Football teams, using score differences is more accurate, but outlawed for fear that teams would run up the score on weaker opponents. So the computer rankings are not as strong as they could be.&lt;br /&gt;&lt;br /&gt;We have no such conflict of interest, so we should try to make use of any information available. A simple way to do that is to look at the mean and standard deviation of the margin of victory when the 16 seed is playing the 1 seed. Below is a plot of the mean score difference with a ribbon for the +/- 2 standard deviations.&lt;br /&gt;&lt;br /&gt;&lt;div style=&#34;overflow: auto;&#34;&gt;&lt;div class=&#34;geshifilter&#34;&gt;&lt;pre class=&#34;r geshifilter-R&#34; style=&#34;font-family: monospace;&#34;&gt;seed.diffs=&lt;a href=&#34;http://inside-r.org/r-doc/base/sort&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;sort&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/base/unique&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;unique&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;brackets$SeedDiff&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;br /&gt;means=&lt;a href=&#34;http://inside-r.org/r-doc/base/sapply&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;sapply&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;seed.diffs&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/base/function&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;function&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;x&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt; &lt;a href=&#34;http://inside-r.org/r-doc/base/mean&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;mean&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;brackets$HigherSeedScoreDiff&lt;span style=&#34;color: #009900;&#34;&gt;[&lt;/span&gt;brackets$SeedDiff==x&lt;span style=&#34;color: #009900;&#34;&gt;]&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;br /&gt;sds=&lt;a href=&#34;http://inside-r.org/r-doc/base/sapply&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;sapply&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;seed.diffs&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/base/function&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;function&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;x&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt; &lt;a href=&#34;http://inside-r.org/r-doc/stats/sd&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;sd&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;brackets$HigherSeedScoreDiff&lt;span style=&#34;color: #009900;&#34;&gt;[&lt;/span&gt;brackets$SeedDiff==x&lt;span style=&#34;color: #009900;&#34;&gt;]&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;a href=&#34;http://inside-r.org/packages/cran/ggplot&#34;&gt;ggplot&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/utils/data&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;data&lt;/span&gt;&lt;/a&gt;=&lt;a href=&#34;http://inside-r.org/r-doc/base/data.frame&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;data.frame&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;seed.diffs&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;means&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;sds&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;aes&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;seed.diffs&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;means&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;+&lt;br /&gt;  geom_ribbon&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;aes&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;ymin=means-&lt;span style=&#34;color: #cc66cc;&#34;&gt;2&lt;/span&gt;*sds&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;ymax=means+&lt;span style=&#34;color: #cc66cc;&#34;&gt;2&lt;/span&gt;*sds&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;alpha=&lt;span style=&#34;color: #cc66cc;&#34;&gt;.5&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;+geom_point&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;+geom_line&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;+&lt;br /&gt;  geom_hline&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;yintercept=&lt;span style=&#34;color: #cc66cc;&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;linetype=&lt;span style=&#34;color: #cc66cc;&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;+&lt;br /&gt;  labs&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;x=&lt;span style=&#34;color: blue;&#34;&gt;&#34;Seed Difference&#34;&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;y=&lt;span style=&#34;color: blue;&#34;&gt;&#34;Margin of Victory by Higher Seed&#34;&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;a href=&#34;http://www.inside-r.org/pretty-r&#34; title=&#34;Created by Pretty R at inside-R.org&#34;&gt;Created by Pretty R at inside-R.org&lt;/a&gt;&lt;br /&gt;&lt;div class=&#34;separator&#34; style=&#34;clear: both; text-align: center;&#34;&gt;&lt;a href=&#34;http://3.bp.blogspot.com/-4VaSHpRws2A/UXLrGMODjhI/AAAAAAAAHtQ/7JrGAbDYY4A/s1600/MarginOfVictory.jpeg&#34; imageanchor=&#34;1&#34; style=&#34;margin-left: 1em; margin-right: 1em;&#34;&gt;&lt;img border=&#34;0&#34; src=&#34;http://3.bp.blogspot.com/-4VaSHpRws2A/UXLrGMODjhI/AAAAAAAAHtQ/7JrGAbDYY4A/s1600/MarginOfVictory.jpeg&#34; /&gt;&lt;/a&gt;&lt;/div&gt;&lt;br /&gt;&lt;br /&gt;You can see that the ribbon includes zero for all seed differences except 15. If we assume that the score differences are roughly normal, we can calculate the probability that the score difference will be greater than 0. The results are largely the same as before, but we see now that there are no 100% estimates. Also, the 50% win percentage for a seed difference of 10 now looks a little more reasonable, albeit still out of line with the rest.&lt;br /&gt;&lt;br /&gt;&lt;div style=&#34;overflow: auto;&#34;&gt;&lt;div class=&#34;geshifilter&#34;&gt;&lt;pre class=&#34;r geshifilter-R&#34; style=&#34;font-family: monospace;&#34;&gt;&lt;a href=&#34;http://inside-r.org/packages/cran/ggplot&#34;&gt;ggplot&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/utils/data&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;data&lt;/span&gt;&lt;/a&gt;=&lt;a href=&#34;http://inside-r.org/r-doc/base/data.frame&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;data.frame&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;seed.diffs&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;means&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;sds&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;aes&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;seed.diffs&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color: #cc66cc;&#34;&gt;1&lt;/span&gt;-&lt;a href=&#34;http://inside-r.org/r-doc/stats/pnorm&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;pnorm&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #cc66cc;&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;means&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;sds&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;+&lt;br /&gt;  geom_point&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;+geom_line&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;+geom_hline&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;yintercept=&lt;span style=&#34;color: #cc66cc;&#34;&gt;0.5&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;linetype=&lt;span style=&#34;color: #cc66cc;&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;+&lt;br /&gt;  labs&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;x=&lt;span style=&#34;color: blue;&#34;&gt;&#34;Seed Difference&#34;&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;y=&lt;span style=&#34;color: blue;&#34;&gt;&#34;Probability of Higher Seed Winning Based on Margin of Victory&#34;&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;a href=&#34;http://www.inside-r.org/pretty-r&#34; title=&#34;Created by Pretty R at inside-R.org&#34;&gt;Created by Pretty R at inside-R.org&lt;/a&gt;&lt;br /&gt;&lt;div class=&#34;separator&#34; style=&#34;clear: both; text-align: center;&#34;&gt;&lt;a href=&#34;http://4.bp.blogspot.com/-0IRgSQFoL9M/UXLrF7iNsYI/AAAAAAAAHtM/G-7h8k1yLAA/s1600/ProbMarginOfVictory.jpeg&#34; imageanchor=&#34;1&#34; style=&#34;margin-left: 1em; margin-right: 1em;&#34;&gt;&lt;img border=&#34;0&#34; src=&#34;http://4.bp.blogspot.com/-0IRgSQFoL9M/UXLrF7iNsYI/AAAAAAAAHtM/G-7h8k1yLAA/s1600/ProbMarginOfVictory.jpeg&#34; /&gt;&lt;/a&gt;&lt;/div&gt;&lt;br /&gt;&lt;h3&gt;Model Win Percentage as a Function of&amp;nbsp; Seed Difference&lt;/h3&gt;It is always good to incorporate as much knowledge as possible into an analysis. In this case, we have information on other games besides the 16 versus 1 seed game which help us estimate the 16 versus 1 game. For example, it is reasonable to assume that the larger the difference in seed is, the more likely the higher seed will win. We can build a logistic regression model which looks at all of the outcomes of all of the games and predicts the probability of winning based on the difference in seed. When the two teams have the same seed, I enforced the probability of the higher seed winning to be 0.5 by making the intercept 0.&lt;br /&gt;&lt;br /&gt;In the plot below, you can see that the logistic model predicts that the probability of winning increases throughout until reaching about 90% for the 16 versus 1. I also included a non-linear generalized additive model (GAM) model for comparison. The GAM believes that being a big favorite (16 vs 1 or 15 vs 2) gives an little boost in win probability. An advantage of modeling is that we can make predictions for match-ups that have never occurred (like a seed difference of 14). &lt;br /&gt;&lt;br /&gt;&lt;div style=&#34;overflow: auto;&#34;&gt;&lt;div class=&#34;geshifilter&#34;&gt;&lt;pre class=&#34;r geshifilter-R&#34; style=&#34;font-family: monospace;&#34;&gt;&lt;a href=&#34;http://inside-r.org/packages/cran/ggplot&#34;&gt;ggplot&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/utils/data&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;data&lt;/span&gt;&lt;/a&gt;=brackets&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;aes&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;SeedDiff&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;HigherSeedWon&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;+&lt;br /&gt;  stat_smooth&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;method=&lt;span style=&#34;color: blue;&#34;&gt;&#34;gam&#34;&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/stats/family&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;family&lt;/span&gt;&lt;/a&gt;=&lt;span style=&#34;color: blue;&#34;&gt;&#34;binomial&#34;&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;se=F&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/stats/formula&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;formula&lt;/span&gt;&lt;/a&gt;=y~&lt;span style=&#34;color: #cc66cc;&#34;&gt;0&lt;/span&gt;+x&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;aes&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;colour=&lt;span style=&#34;color: blue;&#34;&gt;&#34;Logistic&#34;&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;size=&lt;span style=&#34;color: #cc66cc;&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;+&lt;br /&gt;  stat_smooth&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;method=&lt;span style=&#34;color: blue;&#34;&gt;&#34;gam&#34;&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/stats/family&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;family&lt;/span&gt;&lt;/a&gt;=&lt;span style=&#34;color: blue;&#34;&gt;&#34;binomial&#34;&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;se=F&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/stats/formula&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;formula&lt;/span&gt;&lt;/a&gt;=y~&lt;a href=&#34;http://inside-r.org/r-doc/mgcv/s&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;s&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;x&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;aes&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;colour=&lt;span style=&#34;color: blue;&#34;&gt;&#34;GAM&#34;&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;size=&lt;span style=&#34;color: #cc66cc;&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;+&lt;br /&gt;  geom_jitter&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;alpha=&lt;span style=&#34;color: #cc66cc;&#34;&gt;.15&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;position = position_jitter&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;height = &lt;span style=&#34;color: #cc66cc;&#34;&gt;.025&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;width=&lt;span style=&#34;color: #cc66cc;&#34;&gt;.25&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;+&lt;br /&gt;  labs&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;x=&lt;span style=&#34;color: blue;&#34;&gt;&#34;Seed Difference&#34;&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;y=&lt;span style=&#34;color: blue;&#34;&gt;&#34;Game Won by Higher Seed&#34;&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;colour=&lt;span style=&#34;color: blue;&#34;&gt;&#34;Model&#34;&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;a href=&#34;http://www.inside-r.org/pretty-r&#34; title=&#34;Created by Pretty R at inside-R.org&#34;&gt;Created by Pretty R at inside-R.org&lt;/a&gt;&lt;br /&gt;&lt;div class=&#34;separator&#34; style=&#34;clear: both; text-align: center;&#34;&gt;&lt;a href=&#34;http://3.bp.blogspot.com/-QYWl4914Phc/UXLwH3ls3mI/AAAAAAAAHtY/7CMeKo0ZH5M/s1600/Model01.jpeg&#34; imageanchor=&#34;1&#34; style=&#34;margin-left: 1em; margin-right: 1em;&#34;&gt;&lt;img border=&#34;0&#34; src=&#34;http://3.bp.blogspot.com/-QYWl4914Phc/UXLwH3ls3mI/AAAAAAAAHtY/7CMeKo0ZH5M/s1600/Model01.jpeg&#34; /&gt;&lt;/a&gt;&lt;/div&gt;&lt;br /&gt;&lt;h3&gt;Model Score Difference as a Function of&amp;nbsp; Seed Difference&lt;/h3&gt;We can also do the same thing with margin of victory. Here, I constrain the linear model to have an intercept of 0, meaning that two teams with the same seed should be evenly matched. Again, I included the GAM fit for comparison. The interpretations are similar to before, in that it seems that there is an increase in margin of victory for the heavily favored teams.&lt;br /&gt;&lt;br /&gt;&lt;div style=&#34;overflow: auto;&#34;&gt;&lt;div class=&#34;geshifilter&#34;&gt;&lt;pre class=&#34;r geshifilter-R&#34; style=&#34;font-family: monospace;&#34;&gt;&lt;a href=&#34;http://inside-r.org/packages/cran/ggplot&#34;&gt;ggplot&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/utils/data&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;data&lt;/span&gt;&lt;/a&gt;=brackets&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;aes&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;SeedDiff&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;HigherSeedScoreDiff&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;+&lt;br /&gt;  stat_smooth&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;method=&lt;span style=&#34;color: blue;&#34;&gt;&#34;lm&#34;&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;se=F&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/stats/formula&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;formula&lt;/span&gt;&lt;/a&gt;=y~&lt;span style=&#34;color: #cc66cc;&#34;&gt;0&lt;/span&gt;+x&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;aes&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;colour=&lt;span style=&#34;color: blue;&#34;&gt;&#34;Linear&#34;&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;size=&lt;span style=&#34;color: #cc66cc;&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;+&lt;br /&gt;  stat_smooth&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;method=&lt;span style=&#34;color: blue;&#34;&gt;&#34;gam&#34;&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;se=F&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/stats/formula&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;formula&lt;/span&gt;&lt;/a&gt;=y~&lt;a href=&#34;http://inside-r.org/r-doc/mgcv/s&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;s&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;x&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;aes&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;colour=&lt;span style=&#34;color: blue;&#34;&gt;&#34;GAM&#34;&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;size=&lt;span style=&#34;color: #cc66cc;&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;+&lt;br /&gt;  geom_jitter&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;alpha=&lt;span style=&#34;color: #cc66cc;&#34;&gt;.25&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;position = position_jitter&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;height = &lt;span style=&#34;color: #cc66cc;&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;width=&lt;span style=&#34;color: #cc66cc;&#34;&gt;.25&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;+&lt;br /&gt;  labs&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;x=&lt;span style=&#34;color: blue;&#34;&gt;&#34;Seed Difference&#34;&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;y=&lt;span style=&#34;color: blue;&#34;&gt;&#34;Margin of Victory by Higher Seed&#34;&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;colour=&lt;span style=&#34;color: blue;&#34;&gt;&#34;Model&#34;&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;a href=&#34;http://www.inside-r.org/pretty-r&#34; title=&#34;Created by Pretty R at inside-R.org&#34;&gt;Created by Pretty R at inside-R.org&lt;/a&gt;&lt;br /&gt;&lt;div class=&#34;separator&#34; style=&#34;clear: both; text-align: center;&#34;&gt;&lt;a href=&#34;http://3.bp.blogspot.com/-ncQ9W4oFjU8/UXLyGTZLNuI/AAAAAAAAHtg/5MqlA6ZbX8c/s1600/ModelDiff.jpeg&#34; imageanchor=&#34;1&#34; style=&#34;margin-left: 1em; margin-right: 1em;&#34;&gt;&lt;img border=&#34;0&#34; src=&#34;http://3.bp.blogspot.com/-ncQ9W4oFjU8/UXLyGTZLNuI/AAAAAAAAHtg/5MqlA6ZbX8c/s1600/ModelDiff.jpeg&#34; /&gt;&lt;/a&gt;&lt;/div&gt;&lt;br /&gt;From these models of margin of victory we can infer the probability of the higher seed winning (again, assuming normality).&lt;br /&gt;&lt;br /&gt;&lt;div style=&#34;overflow: auto;&#34;&gt;&lt;div class=&#34;geshifilter&#34;&gt;&lt;pre class=&#34;r geshifilter-R&#34; style=&#34;font-family: monospace;&#34;&gt;&lt;a href=&#34;http://inside-r.org/r-doc/base/library&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;library&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/mgcv/gam&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;gam&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;br /&gt;lm.seed=&lt;a href=&#34;http://inside-r.org/r-doc/stats/lm&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;lm&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;HigherSeedScoreDiff~&lt;span style=&#34;color: #cc66cc;&#34;&gt;0&lt;/span&gt;+SeedDiff&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/utils/data&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;data&lt;/span&gt;&lt;/a&gt;=brackets&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;br /&gt;gam.seed=&lt;a href=&#34;http://inside-r.org/r-doc/mgcv/gam&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;gam&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;HigherSeedScoreDiff~&lt;a href=&#34;http://inside-r.org/r-doc/mgcv/s&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;s&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;SeedDiff&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/utils/data&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;data&lt;/span&gt;&lt;/a&gt;=brackets&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;br /&gt;&amp;nbsp;&lt;br /&gt;pred.lm.seed=&lt;a href=&#34;http://inside-r.org/r-doc/stats/predict&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;predict&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;lm.seed&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/base/data.frame&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;data.frame&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;SeedDiff=&lt;span style=&#34;color: #cc66cc;&#34;&gt;0&lt;/span&gt;:&lt;span style=&#34;color: #cc66cc;&#34;&gt;15&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;se.fit=&lt;span style=&#34;color: black; font-weight: bold;&#34;&gt;TRUE&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;br /&gt;pred.gam.seed=&lt;a href=&#34;http://inside-r.org/r-doc/stats/predict&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;predict&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;gam.seed&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/base/data.frame&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;data.frame&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;SeedDiff=&lt;span style=&#34;color: #cc66cc;&#34;&gt;0&lt;/span&gt;:&lt;span style=&#34;color: #cc66cc;&#34;&gt;15&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;se.fit=&lt;span style=&#34;color: black; font-weight: bold;&#34;&gt;TRUE&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;br /&gt;se.lm=&lt;a href=&#34;http://inside-r.org/r-doc/base/sqrt&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;sqrt&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/base/mean&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;mean&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;lm.seed$residuals^&lt;span style=&#34;color: #cc66cc;&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;br /&gt;se.gam=&lt;a href=&#34;http://inside-r.org/r-doc/base/sqrt&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;sqrt&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/base/mean&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;mean&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;gam.seed$residuals^&lt;span style=&#34;color: #cc66cc;&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;br /&gt;&amp;nbsp;&lt;br /&gt;df1=&lt;a href=&#34;http://inside-r.org/r-doc/base/data.frame&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;data.frame&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;SeedDiff=&lt;span style=&#34;color: #cc66cc;&#34;&gt;0&lt;/span&gt;:&lt;span style=&#34;color: #cc66cc;&#34;&gt;15&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;ProbLM=&lt;span style=&#34;color: #cc66cc;&#34;&gt;1&lt;/span&gt;-&lt;a href=&#34;http://inside-r.org/r-doc/stats/pnorm&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;pnorm&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #cc66cc;&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;pred.lm.seed$fit&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/base/sqrt&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;sqrt&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;se.lm^&lt;span style=&#34;color: #cc66cc;&#34;&gt;2&lt;/span&gt;+pred.lm.seed$se.fit^&lt;span style=&#34;color: #cc66cc;&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;br /&gt;               ProbGAM=&lt;span style=&#34;color: #cc66cc;&#34;&gt;1&lt;/span&gt;-&lt;a href=&#34;http://inside-r.org/r-doc/stats/pnorm&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;pnorm&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #cc66cc;&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;pred.gam.seed$fit&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/base/sqrt&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;sqrt&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;se.gam^&lt;span style=&#34;color: #cc66cc;&#34;&gt;2&lt;/span&gt;+pred.gam.seed$se.fit^&lt;span style=&#34;color: #cc66cc;&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;a href=&#34;http://inside-r.org/packages/cran/ggplot&#34;&gt;ggplot&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;df1&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;+geom_hline&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;yintercept=&lt;span style=&#34;color: #cc66cc;&#34;&gt;0.5&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;linetype=&lt;span style=&#34;color: #cc66cc;&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;+&lt;br /&gt;  geom_line&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;aes&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;SeedDiff&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;ProbLM&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;colour=&lt;span style=&#34;color: blue;&#34;&gt;&#34;Linear&#34;&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;size=&lt;span style=&#34;color: #cc66cc;&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;+&lt;br /&gt;  geom_line&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;aes&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;SeedDiff&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;ProbGAM&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;colour=&lt;span style=&#34;color: blue;&#34;&gt;&#34;GAM&#34;&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;size=&lt;span style=&#34;color: #cc66cc;&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;+&lt;br /&gt;  labs&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;x=&lt;span style=&#34;color: blue;&#34;&gt;&#34;Seed Difference&#34;&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;y=&lt;span style=&#34;color: blue;&#34;&gt;&#34;Probability of Higher Seed Winning&#34;&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;colour=&lt;span style=&#34;color: blue;&#34;&gt;&#34;Model&#34;&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;a href=&#34;http://www.inside-r.org/pretty-r&#34; title=&#34;Created by Pretty R at inside-R.org&#34;&gt;Created by Pretty R at inside-R.org&lt;/a&gt;&lt;br /&gt;&lt;br /&gt;&lt;div class=&#34;separator&#34; style=&#34;clear: both; text-align: center;&#34;&gt;&lt;a href=&#34;http://2.bp.blogspot.com/-ZI7n4agC0J8/UXL4fH2dTzI/AAAAAAAAHts/6ia23BR7e7w/s1600/ModelDiffProbs.jpeg&#34; imageanchor=&#34;1&#34; style=&#34;margin-left: 1em; margin-right: 1em;&#34;&gt;&lt;img border=&#34;0&#34; src=&#34;http://2.bp.blogspot.com/-ZI7n4agC0J8/UXL4fH2dTzI/AAAAAAAAHts/6ia23BR7e7w/s1600/ModelDiffProbs.jpeg&#34; /&gt;&lt;/a&gt;&lt;/div&gt;&lt;br /&gt;&lt;h3&gt;Summary&lt;/h3&gt;Putting all of the estimates together, you can easily spot the differences between the models. The two assumptions that just used the data between specific seeds look pretty similar. It looks like using score differential is a little more reasonable of the two. The two GAMs have a similar trend and so did the&amp;nbsp; linear and logistic models. If someone asks you what the probability that a 16 seed beats a 1 seed, you have at least 6 different answers.&lt;br /&gt;&lt;br /&gt;This post highlights the many different ways someone can analyze the same data. Simply statistics talked a bit about this in a &lt;a href=&#34;http://simplystatistics.org/2013/04/19/podcast-7-reinhart-rogoff-reproducibility/&#34;&gt;recent podcast&lt;/a&gt;. In this case, the differences are not huge, but there are noticeable changes. So the next time you read about an analysis that someone did, keep in mind all the decisions that they had to make and what type a sensitivity they would have on the results.&lt;br /&gt;&lt;br /&gt;&lt;div style=&#34;overflow: auto;&#34;&gt;&lt;div class=&#34;geshifilter&#34;&gt;&lt;pre class=&#34;r geshifilter-R&#34; style=&#34;font-family: monospace;&#34;&gt;logit.seed=&lt;a href=&#34;http://inside-r.org/r-doc/stats/glm&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;glm&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;HigherSeedWon~&lt;span style=&#34;color: #cc66cc;&#34;&gt;0&lt;/span&gt;+SeedDiff&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/utils/data&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;data&lt;/span&gt;&lt;/a&gt;=brackets&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/stats/family&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;family&lt;/span&gt;&lt;/a&gt;=&lt;a href=&#34;http://inside-r.org/r-doc/stats/binomial&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;binomial&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/boot/logit&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;logit&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;br /&gt;logit.seed.gam=&lt;a href=&#34;http://inside-r.org/r-doc/mgcv/gam&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;gam&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;HigherSeedWon~&lt;a href=&#34;http://inside-r.org/r-doc/mgcv/s&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;s&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;SeedDiff&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/utils/data&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;data&lt;/span&gt;&lt;/a&gt;=brackets&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/stats/family&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;family&lt;/span&gt;&lt;/a&gt;=&lt;a href=&#34;http://inside-r.org/r-doc/stats/binomial&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;binomial&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/boot/logit&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;logit&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;br /&gt;&amp;nbsp;&lt;br /&gt;df2=&lt;a href=&#34;http://inside-r.org/r-doc/base/data.frame&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;data.frame&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;SeedDiff=&lt;span style=&#34;color: #cc66cc;&#34;&gt;0&lt;/span&gt;:&lt;span style=&#34;color: #cc66cc;&#34;&gt;15&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;br /&gt;               ProbLM=&lt;span style=&#34;color: #cc66cc;&#34;&gt;1&lt;/span&gt;-&lt;a href=&#34;http://inside-r.org/r-doc/stats/pnorm&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;pnorm&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #cc66cc;&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;pred.lm.seed$fit&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/base/sqrt&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;sqrt&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;se.lm^&lt;span style=&#34;color: #cc66cc;&#34;&gt;2&lt;/span&gt;+pred.lm.seed$se.fit^&lt;span style=&#34;color: #cc66cc;&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;br /&gt;               ProbGAM=&lt;span style=&#34;color: #cc66cc;&#34;&gt;1&lt;/span&gt;-&lt;a href=&#34;http://inside-r.org/r-doc/stats/pnorm&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;pnorm&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #cc66cc;&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;pred.gam.seed$fit&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/base/sqrt&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;sqrt&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;se.gam^&lt;span style=&#34;color: #cc66cc;&#34;&gt;2&lt;/span&gt;+pred.gam.seed$se.fit^&lt;span style=&#34;color: #cc66cc;&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;br /&gt;               ProbLogit=&lt;a href=&#34;http://inside-r.org/r-doc/stats/predict&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;predict&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;logit.seed&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/base/data.frame&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;data.frame&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;SeedDiff=&lt;span style=&#34;color: #cc66cc;&#34;&gt;0&lt;/span&gt;:&lt;span style=&#34;color: #cc66cc;&#34;&gt;15&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;type=&lt;span style=&#34;color: blue;&#34;&gt;&#34;response&#34;&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;br /&gt;               ProbLogitGAM=&lt;a href=&#34;http://inside-r.org/r-doc/stats/predict&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;predict&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;logit.seed.gam&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/base/data.frame&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;data.frame&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;SeedDiff=&lt;span style=&#34;color: #cc66cc;&#34;&gt;0&lt;/span&gt;:&lt;span style=&#34;color: #cc66cc;&#34;&gt;15&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;type=&lt;span style=&#34;color: blue;&#34;&gt;&#34;response&#34;&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;br /&gt;df2=&lt;a href=&#34;http://inside-r.org/r-doc/base/merge&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;merge&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;df2&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/base/data.frame&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;data.frame&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;SeedDiff=seed.diffs&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;ProbFreq=win.pct&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;all.x=T&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;br /&gt;df2=&lt;a href=&#34;http://inside-r.org/r-doc/base/merge&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;merge&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;df2&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/base/data.frame&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;data.frame&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;SeedDiff=seed.diffs&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;ProbScore=&lt;span style=&#34;color: #cc66cc;&#34;&gt;1&lt;/span&gt;-&lt;a href=&#34;http://inside-r.org/r-doc/stats/pnorm&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;pnorm&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #cc66cc;&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;means&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;sds&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;all.x=T&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;a href=&#34;http://inside-r.org/packages/cran/ggplot&#34;&gt;ggplot&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;df2&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;aes&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;SeedDiff&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;+geom_hline&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;yintercept=&lt;span style=&#34;color: #cc66cc;&#34;&gt;0.5&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;linetype=&lt;span style=&#34;color: #cc66cc;&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;+&lt;br /&gt;  geom_line&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;aes&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;y=ProbLM&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;colour=&lt;span style=&#34;color: blue;&#34;&gt;&#34;Linear&#34;&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;size=&lt;span style=&#34;color: #cc66cc;&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;+&lt;br /&gt;  geom_line&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;aes&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;y=ProbGAM&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;colour=&lt;span style=&#34;color: blue;&#34;&gt;&#34;GAM&#34;&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;size=&lt;span style=&#34;color: #cc66cc;&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;+&lt;br /&gt;  geom_line&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;aes&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;y=ProbLogit&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;colour=&lt;span style=&#34;color: blue;&#34;&gt;&#34;Logistic&#34;&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;size=&lt;span style=&#34;color: #cc66cc;&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;+&lt;br /&gt;  geom_line&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;aes&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;y=ProbLogitGAM&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;colour=&lt;span style=&#34;color: blue;&#34;&gt;&#34;Logistic GAM&#34;&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;size=&lt;span style=&#34;color: #cc66cc;&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;+&lt;br /&gt;  geom_line&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;aes&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;y=ProbFreq&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;colour=&lt;span style=&#34;color: blue;&#34;&gt;&#34;Frequencies&#34;&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;size=&lt;span style=&#34;color: #cc66cc;&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;+&lt;br /&gt;  geom_line&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;aes&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;y=ProbScore&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;colour=&lt;span style=&#34;color: blue;&#34;&gt;&#34;Score Diff&#34;&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;size=&lt;span style=&#34;color: #cc66cc;&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;+&lt;br /&gt;  geom_point&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;aes&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;y=ProbFreq&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;colour=&lt;span style=&#34;color: blue;&#34;&gt;&#34;Frequencies&#34;&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;size=&lt;span style=&#34;color: #cc66cc;&#34;&gt;3&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;+&lt;br /&gt;  geom_point&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;aes&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;y=ProbScore&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;colour=&lt;span style=&#34;color: blue;&#34;&gt;&#34;Score Diff&#34;&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;size=&lt;span style=&#34;color: #cc66cc;&#34;&gt;3&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;+&lt;br /&gt;  labs&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;x=&lt;span style=&#34;color: blue;&#34;&gt;&#34;Seed Difference&#34;&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;y=&lt;span style=&#34;color: blue;&#34;&gt;&#34;Probability of Higher Seed Winning&#34;&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;colour=&lt;span style=&#34;color: blue;&#34;&gt;&#34;Model&#34;&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;br /&gt;&amp;nbsp;&lt;br /&gt;&lt;a href=&#34;http://inside-r.org/packages/cran/ggplot&#34;&gt;ggplot&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;df2&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;+geom_hline&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;yintercept=&lt;span style=&#34;color: #cc66cc;&#34;&gt;0.5&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;linetype=&lt;span style=&#34;color: #cc66cc;&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;+&lt;br /&gt;  geom_point&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;aes&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;x=SeedDiff&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;y=ProbFreq&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;colour=&lt;span style=&#34;color: blue;&#34;&gt;&#34;Frequencies&#34;&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;size=&lt;span style=&#34;color: #cc66cc;&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;a href=&#34;http://www.inside-r.org/pretty-r&#34; title=&#34;Created by Pretty R at inside-R.org&#34;&gt;Created by Pretty R at inside-R.org&lt;/a&gt;&lt;br /&gt;&lt;br /&gt;&lt;div class=&#34;separator&#34; style=&#34;clear: both; text-align: center;&#34;&gt;&lt;a href=&#34;http://1.bp.blogspot.com/-hLA30tdetII/UXL4fBT844I/AAAAAAAAHtw/hZiyPKG1o_g/s1600/AllProbs.jpeg&#34; imageanchor=&#34;1&#34; style=&#34;margin-left: 1em; margin-right: 1em;&#34;&gt;&lt;img border=&#34;0&#34; src=&#34;http://1.bp.blogspot.com/-hLA30tdetII/UXL4fBT844I/AAAAAAAAHtw/hZiyPKG1o_g/s1600/AllProbs.jpeg&#34; /&gt;&lt;/a&gt;&lt;/div&gt;&lt;br /&gt;&lt;i&gt;Note that the GAM functions did not have a way to easily restrict the win probability be equal to exactly 0.5 when the seed difference is 0. That is why you may notice the GAM model is a bit above 0.5 at 0.&lt;/i&gt;&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Text Decryption Using MCMC</title>
      <link>/2013/01/23/text-decryption-using-mcmc/</link>
      <pubDate>Wed, 23 Jan 2013 00:00:00 +0000</pubDate>
      
      <guid>/2013/01/23/text-decryption-using-mcmc/</guid>
      <description>
&lt;div class=&#39;post&#39;&gt;
The famous probabilist and statistician Persi Diaconis wrote an article not too long ago about the &#34;&lt;a href=&#34;http://math.uchicago.edu/~shmuel/Network-course-readings/MCMCRev.pdf&#34; target=&#34;_blank&#34;&gt;Markov chain Monte Carlo (MCMC) Revolution&lt;/a&gt;.&#34; The paper describes how we are able to solve a diverse set of problems with MCMC. The first example he gives is a text decryption problem solved with a simple Metropolis Hastings sampler.&lt;br /&gt;&lt;br /&gt;I was always stumped by those &lt;a href=&#34;https://en.wikipedia.org/wiki/Cryptogram&#34; target=&#34;_blank&#34;&gt;cryptograms&lt;/a&gt; in the newspaper and thought it would be pretty cool if I could crack them with statistics. So I decided to try it out on my own. The example Diaconis gives is fleshed out in more details by its original authors in its own &lt;a href=&#34;http://probability.ca/jeff/ftpdir/decipherart.pdf&#34; target=&#34;_blank&#34;&gt;article&lt;/a&gt;. &lt;br /&gt;&lt;br /&gt;The decryption I will be attempting is called &lt;a href=&#34;https://en.wikipedia.org/wiki/Substitution_cipher&#34; target=&#34;_blank&#34;&gt;substitution cipher&lt;/a&gt;, where each letter of the alphabet corresponds to another letter (possibly the same one). This is the rule that you must follow for the cryptogram game too. There are 26! = 4e26 possible mappings of the letters of the alphabet to one another. This seems like a hopeless problem to solve, but I will show you that a relatively simple solution can be found as long as your reference text is large enough and the text you are trying to decipher is also large enough.&lt;br /&gt;&lt;br /&gt;The strategy is to use a reference text to create transition probabilities from each letter to the next. This can be stored in a 26 by 26 matrix, where the ith row and jth column is the probability of the jth letter, given the ith letter preceded it. For example, the given the previous letter was a Q, U almost always follows it, so the Q-row and U-column would be close to probability of 1. Assuming these one step transition probabilities are what matter, the likelihood of any mapping is the product of the transition probabilities observed.&lt;br /&gt;&lt;br /&gt;To create a transition matrix, I downloaded &lt;i&gt;War and Peace &lt;/i&gt;from &lt;a href=&#34;http://www.gutenberg.org/dirs/2/6/0/2600/2600.txt&#34; target=&#34;_blank&#34;&gt;Project Gutenberg&lt;/a&gt;. I looped through each letter and kept track of the number of number of times each letter followed the previous. I also kept track of a 27th character, which was anything that was not a letter -- for example periods, commas, spaces, etc. This lets me know which letters are more likely to start a word or end a word. Consecutive entries of these special characters are not considered.&lt;br /&gt;&lt;br /&gt;After I have these counts, I normalize by dividing by the row total. Before normalizing, I add 1 to each cell so that there are no probabilities of 0. This also corresponds to prior information of each transition being equally likely. I could have tried to give more informative prior information (like Q to U being likely), but it would have been difficult and probably inaccurate for the whole matrix.&lt;br /&gt;&lt;br /&gt;Below is the code for creating the transition probability matrix. Note that I loop through each line and within each line I loop through each character.&lt;br /&gt;&lt;br /&gt;&lt;div style=&#34;overflow: auto;&#34;&gt;&lt;div class=&#34;geshifilter&#34;&gt;&lt;pre class=&#34;r geshifilter-R&#34; style=&#34;font-family: monospace;&#34;&gt;reference=&lt;a href=&#34;http://inside-r.org/r-doc/base/readLines&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;readLines&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: blue;&#34;&gt;&#34;warandpeace.txt&#34;&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;br /&gt;reference=&lt;a href=&#34;http://inside-r.org/r-doc/base/toupper&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;toupper&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;reference&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;br /&gt;&amp;nbsp;&lt;br /&gt;trans.mat=&lt;a href=&#34;http://inside-r.org/r-doc/base/matrix&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;matrix&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #cc66cc;&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color: #cc66cc;&#34;&gt;27&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color: #cc66cc;&#34;&gt;27&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;a href=&#34;http://inside-r.org/r-doc/base/rownames&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;rownames&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;trans.mat&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;=&lt;a href=&#34;http://inside-r.org/r-doc/base/colnames&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;colnames&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;trans.mat&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;=&lt;a href=&#34;http://inside-r.org/r-doc/base/c&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;c&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/base/toupper&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;toupper&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: black; font-weight: bold;&#34;&gt;letters&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color: blue;&#34;&gt;&#34;&#34;&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;br /&gt;lastletter=&lt;span style=&#34;color: blue;&#34;&gt;&#34;&#34;&lt;/span&gt;&lt;br /&gt;&lt;span style=&#34;color: black; font-weight: bold;&#34;&gt;for&lt;/span&gt; &lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;ln &lt;span style=&#34;color: black; font-weight: bold;&#34;&gt;in&lt;/span&gt; &lt;span style=&#34;color: #cc66cc;&#34;&gt;1&lt;/span&gt;:&lt;a href=&#34;http://inside-r.org/r-doc/base/length&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;length&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;reference&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #009900;&#34;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span style=&#34;color: black; font-weight: bold;&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;ln %% &lt;span style=&#34;color: #cc66cc;&#34;&gt;1000&lt;/span&gt; ==&lt;span style=&#34;color: #cc66cc;&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #009900;&#34;&gt;{&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/base/cat&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;cat&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: blue;&#34;&gt;&#34;Line&#34;&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;ln&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color: blue;&#34;&gt;&#34;&lt;span style=&#34;color: #000099; font-weight: bold;&#34;&gt;\n&lt;/span&gt;&#34;&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;}&lt;/span&gt;&lt;br /&gt;  &lt;span style=&#34;color: black; font-weight: bold;&#34;&gt;for&lt;/span&gt; &lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;pos &lt;span style=&#34;color: black; font-weight: bold;&#34;&gt;in&lt;/span&gt; &lt;span style=&#34;color: #cc66cc;&#34;&gt;1&lt;/span&gt;:&lt;a href=&#34;http://inside-r.org/r-doc/base/nchar&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;nchar&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;reference&lt;span style=&#34;color: #009900;&#34;&gt;[&lt;/span&gt;ln&lt;span style=&#34;color: #009900;&#34;&gt;]&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #009900;&#34;&gt;{&lt;/span&gt;&lt;br /&gt;    curletter=&lt;a href=&#34;http://inside-r.org/r-doc/base/substring&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;substring&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;reference&lt;span style=&#34;color: #009900;&#34;&gt;[&lt;/span&gt;ln&lt;span style=&#34;color: #009900;&#34;&gt;]&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;pos&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;pos&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;br /&gt;    &lt;span style=&#34;color: black; font-weight: bold;&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;curletter %in% &lt;a href=&#34;http://inside-r.org/r-doc/base/toupper&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;toupper&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: black; font-weight: bold;&#34;&gt;letters&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #009900;&#34;&gt;{&lt;/span&gt;&lt;br /&gt;      trans.mat&lt;span style=&#34;color: #009900;&#34;&gt;[&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/base/rownames&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;rownames&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;trans.mat&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;==lastletter&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;br /&gt;                &lt;a href=&#34;http://inside-r.org/r-doc/base/colnames&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;colnames&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;trans.mat&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;==curletter&lt;span style=&#34;color: #009900;&#34;&gt;]&lt;/span&gt;=&lt;br /&gt;        trans.mat&lt;span style=&#34;color: #009900;&#34;&gt;[&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/base/rownames&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;rownames&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;trans.mat&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;==lastletter&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;br /&gt;                  &lt;a href=&#34;http://inside-r.org/r-doc/base/colnames&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;colnames&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;trans.mat&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;==curletter&lt;span style=&#34;color: #009900;&#34;&gt;]&lt;/span&gt;+&lt;span style=&#34;color: #cc66cc;&#34;&gt;1&lt;/span&gt;&lt;br /&gt;      lastletter=curletter&lt;br /&gt;    &lt;span style=&#34;color: #009900;&#34;&gt;}&lt;/span&gt; &lt;span style=&#34;color: black; font-weight: bold;&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color: #009900;&#34;&gt;{&lt;/span&gt;&lt;br /&gt;      &lt;span style=&#34;color: black; font-weight: bold;&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;lastletter!=&lt;span style=&#34;color: blue;&#34;&gt;&#34;&#34;&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #009900;&#34;&gt;{&lt;/span&gt;&lt;br /&gt;        trans.mat&lt;span style=&#34;color: #009900;&#34;&gt;[&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/base/rownames&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;rownames&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;trans.mat&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;==lastletter&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color: #cc66cc;&#34;&gt;27&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;]&lt;/span&gt;=&lt;br /&gt;          trans.mat&lt;span style=&#34;color: #009900;&#34;&gt;[&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/base/rownames&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;rownames&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;trans.mat&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;==lastletter&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color: #cc66cc;&#34;&gt;27&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;]&lt;/span&gt;+&lt;span style=&#34;color: #cc66cc;&#34;&gt;1&lt;/span&gt;&lt;br /&gt;        lastletter=&lt;span style=&#34;color: blue;&#34;&gt;&#34;&#34;&lt;/span&gt;&lt;br /&gt;      &lt;span style=&#34;color: #009900;&#34;&gt;}&lt;/span&gt;&lt;br /&gt;    &lt;span style=&#34;color: #009900;&#34;&gt;}&lt;/span&gt;&lt;br /&gt;  &lt;span style=&#34;color: #009900;&#34;&gt;}&lt;/span&gt;&lt;br /&gt;  curletter=&lt;span style=&#34;color: blue;&#34;&gt;&#34;&#34;&lt;/span&gt;&lt;br /&gt;  &lt;span style=&#34;color: black; font-weight: bold;&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;lastletter!=&lt;span style=&#34;color: blue;&#34;&gt;&#34;&#34;&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #009900;&#34;&gt;{&lt;/span&gt;&lt;br /&gt;    trans.mat&lt;span style=&#34;color: #009900;&#34;&gt;[&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/base/rownames&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;rownames&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;trans.mat&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;==lastletter&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color: #cc66cc;&#34;&gt;27&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;]&lt;/span&gt;=&lt;br /&gt;      trans.mat&lt;span style=&#34;color: #009900;&#34;&gt;[&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/base/rownames&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;rownames&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;trans.mat&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;==lastletter&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color: #cc66cc;&#34;&gt;27&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;]&lt;/span&gt;+&lt;span style=&#34;color: #cc66cc;&#34;&gt;1&lt;/span&gt;&lt;br /&gt;  &lt;span style=&#34;color: #009900;&#34;&gt;}&lt;/span&gt;&lt;br /&gt;  lastletter=&lt;span style=&#34;color: blue;&#34;&gt;&#34;&#34;&lt;/span&gt;&lt;br /&gt;&lt;span style=&#34;color: #009900;&#34;&gt;}&lt;/span&gt;&lt;br /&gt;&amp;nbsp;&lt;br /&gt;trans.prob.mat=&lt;a href=&#34;http://inside-r.org/r-doc/base/sweep&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;sweep&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;trans.mat+&lt;span style=&#34;color: #cc66cc;&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color: #cc66cc;&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/base/rowSums&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;rowSums&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;trans.mat+&lt;span style=&#34;color: #cc66cc;&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;FUN=&lt;span style=&#34;color: blue;&#34;&gt;&#34;/&#34;&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;a href=&#34;http://www.inside-r.org/pretty-r&#34; title=&#34;Created by Pretty R at inside-R.org&#34;&gt;Created by Pretty R at inside-R.org&lt;/a&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;I like to visualize my data to make sure everything looks correct. Below is a plot of the transition matrix.&amp;nbsp; The blank space corresponds to non-letter character. A lot of insights can be garnered from this plot. The Q-U relationship pops out. T is the most likely letter to start a word. E is a popular letter to follow many others. Y is likely to end a word.&lt;br /&gt;&lt;br /&gt;&lt;div style=&#34;overflow: auto;&#34;&gt;&lt;div class=&#34;geshifilter&#34;&gt;&lt;pre class=&#34;r geshifilter-R&#34; style=&#34;font-family: monospace;&#34;&gt;&lt;a href=&#34;http://inside-r.org/packages/cran/ggplot&#34;&gt;ggplot&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;melt&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;trans.prob.mat&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;aes&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;Var2&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;Var1&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;+geom_tile&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;aes&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;fill=value&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;+&lt;br /&gt;  scale_fill_gradient&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;low=&lt;span style=&#34;color: blue;&#34;&gt;&#34;white&#34;&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;high=&lt;span style=&#34;color: blue;&#34;&gt;&#34;black&#34;&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;limits=&lt;a href=&#34;http://inside-r.org/r-doc/base/c&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;c&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #cc66cc;&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color: #cc66cc;&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;+&lt;br /&gt;  labs&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;x=&lt;span style=&#34;color: blue;&#34;&gt;&#34;Probability of Second Letter&#34;&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;y=&lt;span style=&#34;color: blue;&#34;&gt;&#34;Conditioning on First Letter&#34;&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;fill=&lt;span style=&#34;color: blue;&#34;&gt;&#34;Prob&#34;&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;+&lt;br /&gt;  scale_y_discrete&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;limits = &lt;a href=&#34;http://inside-r.org/r-doc/base/rev&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;rev&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/base/levels&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;levels&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;melt&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;trans.prob.mat&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;$Var1&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;+&lt;br /&gt;  coord_equal&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;a href=&#34;http://www.inside-r.org/pretty-r&#34; title=&#34;Created by Pretty R at inside-R.org&#34;&gt;Created by Pretty R at inside-R.org&lt;/a&gt;&lt;br /&gt;&lt;br /&gt;&lt;div class=&#34;separator&#34; style=&#34;clear: both; text-align: center;&#34;&gt;&lt;a href=&#34;http://1.bp.blogspot.com/-rOSjww2Z0q0/UPlrNU1mO2I/AAAAAAAAHqM/NizWxWZ8K88/s1600/trans.jpeg&#34; imageanchor=&#34;1&#34; style=&#34;margin-left: 1em; margin-right: 1em;&#34;&gt;&lt;img border=&#34;0&#34; src=&#34;https://lh3.ggpht.com/-rOSjww2Z0q0/UPlrNU1mO2I/AAAAAAAAHqM/NizWxWZ8K88/s1600/trans.jpeg&#34; /&gt;&lt;/a&gt;&lt;/div&gt;&lt;div class=&#34;separator&#34; style=&#34;clear: both; text-align: center;&#34;&gt;&lt;/div&gt;&lt;br /&gt;The desired solution will be the one that gives the highest likelihood. This is an &lt;a href=&#34;https://en.wikipedia.org/wiki/NP-hard&#34; target=&#34;_blank&#34;&gt;NP-hard&lt;/a&gt; problem so the only way to find the solution is to try all 26! combinations of mappings, which is infeasible, and report the one with the highest likelihood.&lt;br /&gt;&lt;br /&gt;With the MCMC approach you start with a random mapping of letters. Next you propose a new mapping by randomly switching 2 of the characters in the mapping. So if A mapped to G and L mapped to Z and you switched those two, A would map to Z and L would map to G. With this new mapping, you measure the likelihood and divide it by the likelihood of the previous mapping. If this ratio is greater than 1, then move to this new mapping. If the ratio is less than 1, meaning the new mapping is less likely, then move to this new mapping with a probability equal to the ratio. (Practically, this is done by drawing a random uniform number between 0 and 1 and moving to the proposed mapping if the uniform number is less than the ratio.) Repeat this process until you think you have found a solution.&lt;br /&gt;&lt;br /&gt;To do this, I first wrote a few functions. One to decode the coded text based on the mapping. The other was to calculate the log likelihood of the decoded text.&lt;br /&gt;&lt;br /&gt;&lt;div style=&#34;overflow: auto;&#34;&gt;&lt;div class=&#34;geshifilter&#34;&gt;&lt;pre class=&#34;r geshifilter-R&#34; style=&#34;font-family: monospace;&#34;&gt;decode &amp;lt;- &lt;a href=&#34;http://inside-r.org/r-doc/base/function&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;function&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;mapping&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;coded&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #009900;&#34;&gt;{&lt;/span&gt;&lt;br /&gt;  coded=&lt;a href=&#34;http://inside-r.org/r-doc/base/toupper&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;toupper&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;coded&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;br /&gt;  decoded=coded&lt;br /&gt;  &lt;span style=&#34;color: black; font-weight: bold;&#34;&gt;for&lt;/span&gt; &lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: black; font-weight: bold;&#34;&gt;in&lt;/span&gt; &lt;span style=&#34;color: #cc66cc;&#34;&gt;1&lt;/span&gt;:&lt;a href=&#34;http://inside-r.org/r-doc/base/nchar&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;nchar&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;coded&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #009900;&#34;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span style=&#34;color: black; font-weight: bold;&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/base/substring&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;substring&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;coded&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;i&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;i&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt; %in% &lt;a href=&#34;http://inside-r.org/r-doc/base/toupper&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;toupper&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: black; font-weight: bold;&#34;&gt;letters&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #009900;&#34;&gt;{&lt;/span&gt;&lt;br /&gt;      &lt;a href=&#34;http://inside-r.org/r-doc/base/substring&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;substring&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;decoded&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;i&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;i&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;=&lt;a href=&#34;http://inside-r.org/r-doc/base/toupper&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;toupper&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: black; font-weight: bold;&#34;&gt;letters&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;[&lt;/span&gt;mapping==&lt;a href=&#34;http://inside-r.org/r-doc/base/substring&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;substring&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;coded&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;i&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;i&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;]&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;br /&gt;    &lt;span style=&#34;color: #009900;&#34;&gt;}&lt;/span&gt;&lt;br /&gt;  &lt;span style=&#34;color: #009900;&#34;&gt;}&lt;/span&gt;&lt;br /&gt;  decoded&lt;br /&gt;&lt;span style=&#34;color: #009900;&#34;&gt;}&lt;/span&gt;&lt;br /&gt;&amp;nbsp;&lt;br /&gt;&amp;nbsp;&lt;br /&gt;log.prob &amp;lt;- &lt;a href=&#34;http://inside-r.org/r-doc/base/function&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;function&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;mapping&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;decoded&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #009900;&#34;&gt;{&lt;/span&gt;&lt;br /&gt;  logprob=&lt;span style=&#34;color: #cc66cc;&#34;&gt;0&lt;/span&gt;&lt;br /&gt;&amp;nbsp;&lt;br /&gt;  lastletter=&lt;span style=&#34;color: blue;&#34;&gt;&#34;&#34;&lt;/span&gt;&lt;br /&gt;  &lt;span style=&#34;color: black; font-weight: bold;&#34;&gt;for&lt;/span&gt; &lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;i &lt;span style=&#34;color: black; font-weight: bold;&#34;&gt;in&lt;/span&gt; &lt;span style=&#34;color: #cc66cc;&#34;&gt;1&lt;/span&gt;:&lt;a href=&#34;http://inside-r.org/r-doc/base/nchar&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;nchar&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;decoded&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #009900;&#34;&gt;{&lt;/span&gt;&lt;br /&gt;    curletter=&lt;a href=&#34;http://inside-r.org/r-doc/base/substring&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;substring&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;decoded&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;i&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;i&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;br /&gt;    &lt;span style=&#34;color: black; font-weight: bold;&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;curletter %in% &lt;a href=&#34;http://inside-r.org/r-doc/base/toupper&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;toupper&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: black; font-weight: bold;&#34;&gt;letters&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #009900;&#34;&gt;{&lt;/span&gt;&lt;br /&gt;      logprob=logprob+&lt;a href=&#34;http://inside-r.org/r-doc/base/log&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;log&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;trans.prob.mat&lt;span style=&#34;color: #009900;&#34;&gt;[&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/base/rownames&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;rownames&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;trans.mat&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;==lastletter&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;br /&gt;                                         &lt;a href=&#34;http://inside-r.org/r-doc/base/colnames&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;colnames&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;trans.mat&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;==curletter&lt;span style=&#34;color: #009900;&#34;&gt;]&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;br /&gt;      lastletter=curletter&lt;br /&gt;    &lt;span style=&#34;color: #009900;&#34;&gt;}&lt;/span&gt; &lt;span style=&#34;color: black; font-weight: bold;&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color: #009900;&#34;&gt;{&lt;/span&gt;&lt;br /&gt;      &lt;span style=&#34;color: black; font-weight: bold;&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;lastletter!=&lt;span style=&#34;color: blue;&#34;&gt;&#34;&#34;&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #009900;&#34;&gt;{&lt;/span&gt;&lt;br /&gt;        logprob=logprob+&lt;a href=&#34;http://inside-r.org/r-doc/base/log&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;log&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;trans.prob.mat&lt;span style=&#34;color: #009900;&#34;&gt;[&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/base/rownames&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;rownames&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;trans.mat&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;==lastletter&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color: #cc66cc;&#34;&gt;27&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;]&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;br /&gt;        lastletter=&lt;span style=&#34;color: blue;&#34;&gt;&#34;&#34;&lt;/span&gt;&lt;br /&gt;      &lt;span style=&#34;color: #009900;&#34;&gt;}&lt;/span&gt;&lt;br /&gt;    &lt;span style=&#34;color: #009900;&#34;&gt;}&lt;/span&gt;&lt;br /&gt;  &lt;span style=&#34;color: #009900;&#34;&gt;}&lt;/span&gt;&lt;br /&gt;&amp;nbsp;&lt;br /&gt;  &lt;span style=&#34;color: black; font-weight: bold;&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;lastletter!=&lt;span style=&#34;color: blue;&#34;&gt;&#34;&#34;&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #009900;&#34;&gt;{&lt;/span&gt;&lt;br /&gt;    logprob=logprob+&lt;a href=&#34;http://inside-r.org/r-doc/base/log&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;log&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;trans.prob.mat&lt;span style=&#34;color: #009900;&#34;&gt;[&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/base/rownames&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;rownames&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;trans.mat&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;==lastletter&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color: #cc66cc;&#34;&gt;27&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;]&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;br /&gt;    lastletter=&lt;span style=&#34;color: blue;&#34;&gt;&#34;&#34;&lt;/span&gt;&lt;br /&gt;  &lt;span style=&#34;color: #009900;&#34;&gt;}&lt;/span&gt;&lt;br /&gt;  logprob&lt;br /&gt;&lt;span style=&#34;color: #009900;&#34;&gt;}&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;a href=&#34;http://www.inside-r.org/pretty-r&#34; title=&#34;Created by Pretty R at inside-R.org&#34;&gt;Created by Pretty R at inside-R.org&lt;/a&gt;&lt;br /&gt;&lt;br /&gt;To show how this works, I will use the same Shakespeare text that is used in the MCMC Revolution paper. I let it run until it tries out 2000 different mappings (not the same as 2000 iterations, because rejected proposals are not counted). Along the way I am keeping track of the most likely mapping visited, and that will be the final estimate. It should be noted that I am only considering the mapping of letters and it is assumed that the special characters are known. For example spaces and periods are assumed to be the same.&lt;br /&gt;&lt;br /&gt;&lt;div style=&#34;overflow: auto;&#34;&gt;&lt;div class=&#34;geshifilter&#34;&gt;&lt;pre class=&#34;r geshifilter-R&#34; style=&#34;font-family: monospace;&#34;&gt;correctTxt=&lt;span style=&#34;color: blue;&#34;&gt;&#34;ENTER HAMLET HAM TO BE OR NOT TO BE THAT IS THE QUESTION WHETHER TIS NOBLER IN THE MIND TO SUFFER THE SLINGS AND ARROWS OF OUTRAGEOUS FORTUNE OR TO TAKE ARMS AGAINST A SEA OF TROUBLES AND BY OPPOSING END&#34;&lt;/span&gt;&lt;br /&gt;coded=decode&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/base/sample&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;sample&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/base/toupper&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;toupper&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: black; font-weight: bold;&#34;&gt;letters&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;correctTxt&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #666666; font-style: italic;&#34;&gt;# randomly scramble the text&lt;/span&gt;&lt;br /&gt;&amp;nbsp;&lt;br /&gt;mapping=&lt;a href=&#34;http://inside-r.org/r-doc/base/sample&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;sample&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/base/toupper&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;toupper&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: black; font-weight: bold;&#34;&gt;letters&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #666666; font-style: italic;&#34;&gt;# initialize a random mapping&lt;/span&gt;&lt;br /&gt;i=&lt;span style=&#34;color: #cc66cc;&#34;&gt;1&lt;/span&gt;&lt;br /&gt;iters=&lt;span style=&#34;color: #cc66cc;&#34;&gt;2000&lt;/span&gt;&lt;br /&gt;cur.decode=decode&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;mapping&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;coded&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;br /&gt;cur.loglike=log.prob&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;mapping&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;cur.decode&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;br /&gt;max.loglike=cur.loglike&lt;br /&gt;max.decode=cur.decode&lt;br /&gt;&lt;span style=&#34;color: black; font-weight: bold;&#34;&gt;while&lt;/span&gt; &lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;i&amp;lt;=iters&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #009900;&#34;&gt;{&lt;/span&gt;&lt;br /&gt;  proposal=&lt;a href=&#34;http://inside-r.org/r-doc/base/sample&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;sample&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #cc66cc;&#34;&gt;1&lt;/span&gt;:&lt;span style=&#34;color: #cc66cc;&#34;&gt;26&lt;/span&gt;&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color: #cc66cc;&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #666666; font-style: italic;&#34;&gt;# select 2 letters to switch&lt;/span&gt;&lt;br /&gt;  prop.mapping=mapping&lt;br /&gt;  prop.mapping&lt;span style=&#34;color: #009900;&#34;&gt;[&lt;/span&gt;proposal&lt;span style=&#34;color: #009900;&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color: #cc66cc;&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;]&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;]&lt;/span&gt;=mapping&lt;span style=&#34;color: #009900;&#34;&gt;[&lt;/span&gt;proposal&lt;span style=&#34;color: #009900;&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color: #cc66cc;&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;]&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;]&lt;/span&gt;&lt;br /&gt;  prop.mapping&lt;span style=&#34;color: #009900;&#34;&gt;[&lt;/span&gt;proposal&lt;span style=&#34;color: #009900;&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color: #cc66cc;&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;]&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;]&lt;/span&gt;=mapping&lt;span style=&#34;color: #009900;&#34;&gt;[&lt;/span&gt;proposal&lt;span style=&#34;color: #009900;&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color: #cc66cc;&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;]&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;]&lt;/span&gt;&lt;br /&gt;&amp;nbsp;&lt;br /&gt;  prop.decode=decode&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;prop.mapping&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;coded&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;br /&gt;  prop.loglike=log.prob&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;prop.mapping&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;prop.decode&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;br /&gt;&amp;nbsp;&lt;br /&gt;  &lt;span style=&#34;color: black; font-weight: bold;&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;a href=&#34;http://inside-r.org/r-doc/stats/runif&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;runif&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #cc66cc;&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&amp;lt;exp&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;prop.loglike-cur.loglike&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #009900;&#34;&gt;{&lt;/span&gt;&lt;br /&gt;    mapping=prop.mapping&lt;br /&gt;    cur.decode=prop.decode&lt;br /&gt;    cur.loglike=prop.loglike&lt;br /&gt;&amp;nbsp;&lt;br /&gt;    &lt;span style=&#34;color: black; font-weight: bold;&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;cur.loglike&amp;gt;max.loglike&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color: #009900;&#34;&gt;{&lt;/span&gt;&lt;br /&gt;      max.loglike=cur.loglike&lt;br /&gt;      max.decode=cur.decode&lt;br /&gt;    &lt;span style=&#34;color: #009900;&#34;&gt;}&lt;/span&gt;&lt;br /&gt;&amp;nbsp;&lt;br /&gt;    &lt;a href=&#34;http://inside-r.org/r-doc/base/cat&#34;&gt;&lt;span style=&#34;color: #003399; font-weight: bold;&#34;&gt;cat&lt;/span&gt;&lt;/a&gt;&lt;span style=&#34;color: #009900;&#34;&gt;(&lt;/span&gt;i&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;cur.decode&lt;span style=&#34;color: #339933;&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color: blue;&#34;&gt;&#34;&lt;span style=&#34;color: #000099; font-weight: bold;&#34;&gt;\n&lt;/span&gt;&#34;&lt;/span&gt;&lt;span style=&#34;color: #009900;&#34;&gt;)&lt;/span&gt;&lt;br /&gt;    i=i+&lt;span style=&#34;color: #cc66cc;&#34;&gt;1&lt;/span&gt;&lt;br /&gt;  &lt;span style=&#34;color: #009900;&#34;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span style=&#34;color: #009900;&#34;&gt;}&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;a href=&#34;http://www.inside-r.org/pretty-r&#34; title=&#34;Created by Pretty R at inside-R.org&#34;&gt;Created by Pretty R at inside-R.org&lt;/a&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;The output of this example is below. You can see that it comes close but it doesn&#39;t quite find the correct mapping. I attribute this to the fact that the text I was trying to decode only had 203 characters. In the paper mentioned above, they decoded the whole play. They further say that their methods work just as well if you randomly sample a text snippet 2000 characters long. Obviously my example had well less than this. This is also a problem in trying to solve a cryptogram because those are even smaller than the Hamlet example I used. So unfortunately this simple method cannot be used for that. (Note that I ran the MCMC chain a several times, using different random starting points, until it came reasonably close to the solution. This is something that the authors also suggested doing.)&lt;br /&gt;&lt;br /&gt;&lt;div class=&#34;separator&#34; style=&#34;clear: both; text-align: center;&#34;&gt;&lt;a href=&#34;http://3.bp.blogspot.com/-DABUm0zHOa4/UPmFEVqbsWI/AAAAAAAAHqc/UgIi3nx4VTk/s1600/Iters.png&#34; imageanchor=&#34;1&#34; style=&#34;margin-left: 1em; margin-right: 1em;&#34;&gt;&lt;img border=&#34;0&#34; src=&#34;https://lh3.ggpht.com/-DABUm0zHOa4/UPmFEVqbsWI/AAAAAAAAHqc/UgIi3nx4VTk/s1600/Iters.png&#34; /&gt;&lt;/a&gt;&lt;/div&gt;&lt;br /&gt;&lt;br /&gt;I want to also note that I originally used Alice and Wonderland as the reference text. It had more trouble decoding since this book is much smaller than War and Peace, and therefore the transition probabilities were not as good.&lt;br /&gt;&lt;br /&gt;The MCMC method is a greedy approach in that you are moving to any mapping that increases the likelihood. Greedy methods are not optimal in general because they can get stuck at local modes, especially in high dimensional problems. MCMC avoids this be moving to less likely mappings with some probability, which ensures that it will find the correct solution with enough time.&lt;/div&gt;
&lt;h2&gt;Comments&lt;/h2&gt;
&lt;div class=&#39;comments&#39;&gt;
&lt;div class=&#39;comment&#39;&gt;
&lt;div class=&#39;author&#39;&gt;Vivek&lt;/div&gt;
&lt;div class=&#39;content&#39;&gt;
Andrew,&lt;br /&gt;&lt;br /&gt;This work is cool!&lt;br /&gt;&lt;br /&gt;I wrote my own substitution cipher decoder using the algorithm described in Stephen Connor&amp;#39;s dissertation as the basis, but I occasionally glanced at your work as well.&lt;br /&gt;&lt;br /&gt;My code doesn&amp;#39;t work as awesomely as yours, and it is also much slower (possibly because I use 76 versus the 27 characters, reachChar versus readLine), and I use different functions.&lt;br /&gt;&lt;br /&gt;But I cited your work and copied your idea for the melt matrix, which is ingenious.&lt;br /&gt;&lt;br /&gt;Thanks so much!&lt;br /&gt;&lt;br /&gt;Vivek&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#39;comment&#39;&gt;
&lt;div class=&#39;author&#39;&gt;Andrew Landgraf&lt;/div&gt;
&lt;div class=&#39;content&#39;&gt;
Thanks, Fernando. I knew I could speed it up by treating it as a vector of letters (or integers), but didn&amp;#39;t take the time to figure it out.&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#39;comment&#39;&gt;
&lt;div class=&#39;author&#39;&gt;Fernando&lt;/div&gt;
&lt;div class=&#39;content&#39;&gt;
Nice work, but the code to get the transition matrix is VERY slow. I manage to make it faster doing the following:&lt;br /&gt;1- get the vector of words (using scan() for example).&lt;br /&gt;2- For each word, use strsplit(word, NULL)[[1]] and iterate&lt;br /&gt;over the characters to populate the matrix.&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#39;comment&#39;&gt;
&lt;div class=&#39;author&#39;&gt;Andrew&lt;/div&gt;
&lt;div class=&#39;content&#39;&gt;
I have had that issue working on different computers. I think older versions of reshape2 use X# and newer versions use Var#. Or maybe it&amp;#39;s a difference between using the package reshape and reshape2?&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#39;comment&#39;&gt;
&lt;div class=&#39;author&#39;&gt;Pablik&lt;/div&gt;
&lt;div class=&#39;content&#39;&gt;
Great work! Sometimes I use Persi&amp;#39;s example for teaching MCMC,&lt;br /&gt;there are some old matlab code from the original consultancy work,&lt;br /&gt;but I never tryed to replicate the example.&lt;br /&gt;&lt;br /&gt;I got an error at:&lt;br /&gt;ggplot(melt(trans.prob.mat),aes(Var2,Var1))+...&lt;br /&gt;&lt;br /&gt;the melt() function uses X1 and X2:&lt;br /&gt;&amp;gt; tmp &amp;lt;- melt(trans.prob.mat)&lt;br /&gt;&amp;gt; head(tmp)&lt;br /&gt;  X1 X2        value&lt;br /&gt;1  A  A 3.893588e-05&lt;br /&gt;2  B  A 9.252956e-02&lt;br /&gt;...&lt;br /&gt;Cheers,&lt;br /&gt;&lt;br /&gt;Pablo&lt;br /&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Factor Analysis of Baseball&#39;s Hall of Fame Voters</title>
      <link>/2013/01/09/factor-analysis-of-baseballs-hall-of-fame-voters/</link>
      <pubDate>Wed, 09 Jan 2013 00:00:00 +0000</pubDate>
      
      <guid>/2013/01/09/factor-analysis-of-baseballs-hall-of-fame-voters/</guid>
      <description>
&lt;div class=&#39;post&#39;&gt;
&lt;!-- saved from url=(0014)about:internet --&gt;&lt;html&gt;&lt;head&gt;  &lt;title&gt;Factor Analysis of Baseball&#39;s Hall of Fame Voters&lt;/title&gt; &lt;style type=&#34;text/css&#34;&gt;body, td {    font-family: sans-serif;    background-color: white;    font-size: 12px;    margin: 8px; }  tt, code, pre {    font-family: &#39;DejaVu Sans Mono&#39;, &#39;Droid Sans Mono&#39;, &#39;Lucida Console&#39;, Consolas, Monaco, monospace; }  h1 {     font-size:2.2em;  }  h2 {     font-size:1.8em;  }  h3 {     font-size:1.4em;  }  h4 {     font-size:1.0em;  }  h5 {     font-size:0.9em;  }  h6 {     font-size:0.8em;  }  a:visited {    color: rgb(50%, 0%, 50%); }  pre {     margin-top: 0;    max-width: 95%;    border: 1px solid #ccc;    white-space: pre-wrap; }  pre code {    display: block; padding: 0.5em; }  code.r, code.cpp {    background-color: #F8F8F8; }  table, td, th {   border: none; }  blockquote {    color:#666666;    margin:0;    padding-left: 1em;    border-left: 0.5em #EEE solid; }  hr {    height: 0px;    border-bottom: none;    border-top-width: thin;    border-top-style: dotted;    border-top-color: #999999; }  @media print {    * {        background: transparent !important;        color: black !important;        filter:none !important;        -ms-filter: none !important;     }     body {        font-size:12pt;        max-width:100%;     }            a, a:visited {        text-decoration: underline;     }     hr {        visibility: hidden;       page-break-before: always;    }     pre, blockquote {        padding-right: 1em;        page-break-inside: avoid;     }     tr, img {        page-break-inside: avoid;     }     img {        max-width: 100% !important;     }     @page :left {        margin: 15mm 20mm 15mm 10mm;     }          @page :right {        margin: 15mm 10mm 15mm 20mm;     }     p, h2, h3 {        orphans: 3; widows: 3;     }     h2, h3 {        page-break-after: avoid;     } }  &lt;/style&gt; &lt;style type=&#34;text/css&#34;&gt;   pre .operator,    pre .paren {      color: rgb(104, 118, 135)    }     pre .literal {      color: rgb(88, 72, 246)    }     pre .number {      color: rgb(0, 0, 205);    }     pre .comment {      color: rgb(76, 136, 107);    }     pre .keyword {      color: rgb(0, 0, 255);    }     pre .identifier {      color: rgb(0, 0, 0);    }     pre .string {      color: rgb(3, 106, 7);    } &lt;/style&gt; &lt;script type=&#34;text/javascript&#34;&gt;var hljs=new function(){function m(p){return p.replace(/&amp;/gm,&#34;&amp;amp;&#34;).replace(/&lt;/gm,&#34;&amp;lt;&#34;)}function f(r,q,p){return RegExp(q,&#34;m&#34;+(r.cI?&#34;i&#34;:&#34;&#34;)+(p?&#34;g&#34;:&#34;&#34;))}function b(r){for(var p=0;p&lt;r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName==&#34;CODE&#34;){return q}if(!(q.nodeType==3&amp;&amp;q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p=&#34;&#34;;for(var r=0;r&lt;t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,&#34;&#34;)}p+=q}else{if(t.childNodes[r].nodeName==&#34;BR&#34;){p+=&#34;\n&#34;}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,&#34;\n&#34;)}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q&lt;r.length;q++){var p=r[q].replace(/^language-/,&#34;&#34;);if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r&lt;s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName==&#34;BR&#34;){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:&#34;start&#34;,offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:&#34;stop&#34;,offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z=&#34;&#34;;var s=[];function u(){if(y.length&amp;&amp;w.length){if(y[0].offset!=w[0].offset){return(y[0].offset&lt;w[0].offset)?y:w}else{return w[0].event==&#34;start&#34;?y:w}}else{return y.length?y:w}}function t(D){var A=&#34;&lt;&#34;+D.nodeName.toLowerCase();for(var B=0;B&lt;D.attributes.length;B++){var C=D.attributes[B];A+=&#34; &#34;+C.nodeName.toLowerCase();if(C.value!==undefined&amp;&amp;C.value!==false&amp;&amp;C.value!==null){A+=&#39;=&#34;&#39;+m(C.value)+&#39;&#34;&#39;}}return A+&#34;&gt;&#34;}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event==&#34;start&#34;){z+=t(v.node);s.push(v.node)}else{if(v.event==&#34;stop&#34;){var p,r=s.length;do{r--;p=s[r];z+=(&#34;&lt;/&#34;+p.nodeName.toLowerCase()+&#34;&gt;&#34;)}while(p!=v.node);s.splice(r,1);while(r&lt;s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w=&#34;keyword&#34;}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b=&#34;\\b(&#34;+s.join(&#34;|&#34;)+&#34;)\\s&#34;}x.bR=f(y,x.b?x.b:&#34;\\B|\\b&#34;);if(!x.e&amp;&amp;!x.eW){x.e=&#34;\\B|\\b&#34;}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t&lt;x.c.length;t++){if(x.c[t]==&#34;self&#34;){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L&lt;M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&amp;&amp;D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&amp;&amp;L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L&lt;N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join(&#34;|&#34;),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),&#34;&#34;,true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&amp;&amp;M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r=&#34;&#34;;var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+=&#39;&lt;span class=&#34;&#39;+N[0]+&#39;&#34;&gt;&#39;+M[0]+&#34;&lt;/span&gt;&#34;}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&amp;&amp;e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?&#39;&lt;span class=&#34;&#39;+M.cN+&#39;&#34;&gt;&#39;:&#34;&#34;;if(M.rB){y+=L;M.buffer=&#34;&#34;}else{if(M.eB){y+=m(r)+L;M.buffer=&#34;&#34;}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?&#34;&lt;/span&gt;&#34;:&#34;&#34;;if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L&gt;1){O=D[D.length-2].cN?&#34;&lt;/span&gt;&#34;:&#34;&#34;;y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer=&#34;&#34;;if(r.starts){I(r.starts,&#34;&#34;)}return R.rE}if(w(M,R)){throw&#34;Illegal&#34;}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y=&#34;&#34;;try{var s,u=0;E.dM.buffer=&#34;&#34;;do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length&gt;1){throw&#34;Illegal&#34;}return{r:A,keyword_count:x,value:y}}catch(H){if(H==&#34;Illegal&#34;){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r&gt;r.keyword_count+r.r){r=s}if(s.keyword_count+s.r&gt;p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((&lt;[^&gt;]+&gt;|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,&#34;&lt;br&gt;&#34;)}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement(&#34;pre&#34;);s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match(&#34;(\\s|^)(language-)?&#34;+v+&#34;(\\s|$)&#34;)){u=u?(u+&#34; &#34;+v):v}if(/MSIE [678]/.test(navigator.userAgent)&amp;&amp;t.tagName==&#34;CODE&#34;&amp;&amp;t.parentNode.tagName==&#34;PRE&#34;){s=t.parentNode;var p=document.createElement(&#34;div&#34;);p.innerHTML=&#34;&lt;pre&gt;&lt;code&gt;&#34;+y.value+&#34;&lt;/code&gt;&lt;/pre&gt;&#34;;t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName(&#34;pre&#34;);for(var p=0;p&lt;r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener(&#34;DOMContentLoaded&#34;,o,false);window.addEventListener(&#34;load&#34;,o,false)}else{if(window.attachEvent){window.attachEvent(&#34;onload&#34;,o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR=&#34;[a-zA-Z][a-zA-Z0-9_]*&#34;;this.UIR=&#34;[a-zA-Z_][a-zA-Z0-9_]*&#34;;this.NR=&#34;\\b\\d+(\\.\\d+)?&#34;;this.CNR=&#34;\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)&#34;;this.BNR=&#34;\\b(0b[01]+)&#34;;this.RSR=&#34;!|!=|!==|%|%=|&amp;|&amp;&amp;|&amp;=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|&lt;|&lt;&lt;|&lt;&lt;=|&lt;=|=|==|===|&gt;|&gt;=|&gt;&gt;|&gt;&gt;=|&gt;&gt;&gt;|&gt;&gt;&gt;=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~&#34;;this.ER=&#34;(?![\\s\\S])&#34;;this.BE={b:&#34;\\\\.&#34;,r:0};this.ASM={cN:&#34;string&#34;,b:&#34;&#39;&#34;,e:&#34;&#39;&#34;,i:&#34;\\n&#34;,c:[this.BE],r:0};this.QSM={cN:&#34;string&#34;,b:&#39;&#34;&#39;,e:&#39;&#34;&#39;,i:&#34;\\n&#34;,c:[this.BE],r:0};this.CLCM={cN:&#34;comment&#34;,b:&#34;//&#34;,e:&#34;$&#34;};this.CBLCLM={cN:&#34;comment&#34;,b:&#34;/\\*&#34;,e:&#34;\\*/&#34;};this.HCM={cN:&#34;comment&#34;,b:&#34;#&#34;,e:&#34;$&#34;};this.NM={cN:&#34;number&#34;,b:this.NR,r:0};this.CNM={cN:&#34;number&#34;,b:this.CNR,r:0};this.BNM={cN:&#34;number&#34;,b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{&#34;false&#34;:1,&#34;int&#34;:1,&#34;float&#34;:1,&#34;while&#34;:1,&#34;private&#34;:1,&#34;char&#34;:1,&#34;catch&#34;:1,&#34;export&#34;:1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,&#34;const&#34;:1,struct:1,&#34;for&#34;:1,static_cast:2,union:1,namespace:1,unsigned:1,&#34;long&#34;:1,&#34;throw&#34;:1,&#34;volatile&#34;:2,&#34;static&#34;:1,&#34;protected&#34;:1,bool:1,template:1,mutable:1,&#34;if&#34;:1,&#34;public&#34;:1,friend:2,&#34;do&#34;:1,&#34;return&#34;:1,&#34;goto&#34;:1,auto:1,&#34;void&#34;:2,&#34;enum&#34;:1,&#34;else&#34;:1,&#34;break&#34;:1,&#34;new&#34;:1,extern:1,using:1,&#34;true&#34;:1,&#34;class&#34;:1,asm:1,&#34;case&#34;:1,typeid:1,&#34;short&#34;:1,reinterpret_cast:2,&#34;default&#34;:1,&#34;double&#34;:1,register:1,explicit:1,signed:1,typename:1,&#34;try&#34;:1,&#34;this&#34;:1,&#34;switch&#34;:1,&#34;continue&#34;:1,wchar_t:1,inline:1,&#34;delete&#34;:1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:&#34;&lt;/&#34;,c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:&#34;string&#34;,b:&#34;&#39;\\\\?.&#34;,e:&#34;&#39;&#34;,i:&#34;.&#34;},{cN:&#34;number&#34;,b:&#34;\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)&#34;},hljs.CNM,{cN:&#34;preprocessor&#34;,b:&#34;#&#34;,e:&#34;$&#34;},{cN:&#34;stl_container&#34;,b:&#34;\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*&lt;&#34;,e:&#34;&gt;&#34;,k:a,r:10,c:[&#34;self&#34;]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:&#34;number&#34;,b:&#34;\\b0[xX][0-9a-fA-F]+[Li]?\\b&#34;,e:hljs.IMMEDIATE_RE,r:0},{cN:&#34;number&#34;,b:&#34;\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b&#34;,e:hljs.IMMEDIATE_RE,r:0},{cN:&#34;number&#34;,b:&#34;\\b\\d+\\.(?!\\d)(?:i\\b)?&#34;,e:hljs.IMMEDIATE_RE,r:1},{cN:&#34;number&#34;,b:&#34;\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b&#34;,e:hljs.IMMEDIATE_RE,r:0},{cN:&#34;number&#34;,b:&#34;\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b&#34;,e:hljs.IMMEDIATE_RE,r:1},{cN:&#34;keyword&#34;,b:&#34;(?:tryCatch|library|setGeneric|setGroupGeneric)\\b&#34;,e:hljs.IMMEDIATE_RE,r:10},{cN:&#34;keyword&#34;,b:&#34;\\.\\.\\.&#34;,e:hljs.IMMEDIATE_RE,r:10},{cN:&#34;keyword&#34;,b:&#34;\\.\\.\\d+(?![\\w.])&#34;,e:hljs.IMMEDIATE_RE,r:10},{cN:&#34;keyword&#34;,b:&#34;\\b(?:function)&#34;,e:hljs.IMMEDIATE_RE,r:2},{cN:&#34;keyword&#34;,b:&#34;(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b&#34;,e:hljs.IMMEDIATE_RE,r:1},{cN:&#34;literal&#34;,b:&#34;(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b&#34;,e:hljs.IMMEDIATE_RE,r:10},{cN:&#34;literal&#34;,b:&#34;(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b&#34;,e:hljs.IMMEDIATE_RE,r:1},{cN:&#34;identifier&#34;,b:&#34;[a-zA-Z.][a-zA-Z0-9._]*\\b&#34;,e:hljs.IMMEDIATE_RE,r:0},{cN:&#34;operator&#34;,b:&#34;&lt;\\-(?!\\s*\\d)&#34;,e:hljs.IMMEDIATE_RE,r:2},{cN:&#34;operator&#34;,b:&#34;\\-&gt;|&lt;\\-&#34;,e:hljs.IMMEDIATE_RE,r:1},{cN:&#34;operator&#34;,b:&#34;%%|~&#34;,e:hljs.IMMEDIATE_RE},{cN:&#34;operator&#34;,b:&#34;&gt;=|&lt;=|==|!=|\\|\\||&amp;&amp;|=|\\+|\\-|\\*|/|\\^|&gt;|&lt;|!|&amp;|\\||\\$|:&#34;,e:hljs.IMMEDIATE_RE,r:0},{cN:&#34;operator&#34;,b:&#34;%&#34;,e:&#34;%&#34;,i:&#34;\\n&#34;,r:1},{cN:&#34;identifier&#34;,b:&#34;`&#34;,e:&#34;`&#34;,r:0},{cN:&#34;string&#34;,b:&#39;&#34;&#39;,e:&#39;&#34;&#39;,c:[hljs.BE],r:0},{cN:&#34;string&#34;,b:&#34;&#39;&#34;,e:&#34;&#39;&#34;,c:[hljs.BE],r:0},{cN:&#34;paren&#34;,b:&#34;[[({\\])}]&#34;,e:hljs.IMMEDIATE_RE,r:0}]}}; hljs.initHighlightingOnLoad(); &lt;/script&gt;        &lt;br /&gt;Recently, Nate Silver wrote &lt;a href=&#34;http://fivethirtyeight.blogs.nytimes.com/2013/01/08/suspicion-of-steroid-use-could-keep-bagwell-and-piazza-out-of-hall/&#34;&gt;a post&lt;/a&gt; which analyzed how voters who voted for and against Barry Bonds for Baseball&#39;s Hall of Fame differed. Not surprisingly, those who voted for Bonds were more likely to vote for other suspected steroids users (like Roger Clemens). This got me thinking that this would make an interesting case study for factor analysis to see if there are latent factors that drive hall of fame voting.&lt;br /&gt;&lt;br /&gt;The Twitter user @leokitty has kept track of all the known ballots of the voters in a &lt;a href=&#34;https://docs.google.com/spreadsheet/ccc?key=0Aqc4QTMoPrdtdDQxaDYzd1lLOGpOdUdrcnNNNWNXa2c&amp;amp;authkey=CPyuwqIJ&amp;amp;authkey=CPyuwqIJ#gid=6&#34;&gt;spreadsheet&lt;/a&gt;. The spreadsheet is a matrix that has one row for each voter and one column for each player being voted upon. (Players need 75% of the vote to make it to the hall of fame.) I removed all players that had no votes and all voters that had given a partial ballot.&lt;br /&gt;&lt;br /&gt;(This matrix either has a 1 or a 0 in each entry, corresponding to whether a voter voted for the player or not. Note that this kind of matrix is similar to the data that is analyzed in information retrieval. I will be decomposing the (centered) matrix using singular value decomposition to run the factor analysis. This is the same technique used for latent semantic indexing in information retrieval.)&lt;br /&gt;&lt;br /&gt;Starting with the analysis, there is a drop off of the variance  after the first 2 factors, which means it might make sense to look only at the first 2 (which is good because I was only planning on doing so).&lt;br /&gt;&lt;br /&gt;&lt;pre&gt;&lt;code class=&#34;r&#34;&gt;votes = read.csv(&#34;HOF votes.csv&#34;, row.names = 1, header = TRUE)&lt;br /&gt;pca = princomp(votes)&lt;br /&gt;screeplot(pca, type = &#34;l&#34;, main = &#34;Scree Plot&#34;)&lt;br /&gt;&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;separator&#34; style=&#34;clear: both; text-align: center;&#34;&gt;&lt;a href=&#34;http://4.bp.blogspot.com/-hLkeU-zL-Ak/UO2Yd0B5z4I/AAAAAAAAHo4/dH27nksEiHM/s1600/unnamed-chunk-2.png&#34; imageanchor=&#34;1&#34; style=&#34;margin-left: 1em; margin-right: 1em;&#34;&gt;&lt;img border=&#34;0&#34; src=&#34;http://4.bp.blogspot.com/-hLkeU-zL-Ak/UO2Yd0B5z4I/AAAAAAAAHo4/dH27nksEiHM/s1600/unnamed-chunk-2.png&#34; /&gt;&lt;/a&gt;&lt;/div&gt;&lt;br /&gt;Looking at the loadings, it appears that the first principal component corresponds strongly to steroid users, which Bonds and Clemens having large negative values and other suspected steroid users being on the negative end. The players on the positive end have no steroid suspicions.&lt;br /&gt;&lt;br /&gt;&lt;pre&gt;&lt;code class=&#34;r&#34;&gt;dotchart(sort(pca$loadings[, 1]), main = &#34;First Principal Component&#34;)&lt;br /&gt;&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;separator&#34; style=&#34;clear: both; text-align: center;&#34;&gt;&lt;a href=&#34;http://1.bp.blogspot.com/-K6MEN_9PcHs/UO2Yd69LeeI/AAAAAAAAHok/Lcb2apHZdC0/s1600/unnamed-chunk-3.png&#34; imageanchor=&#34;1&#34; style=&#34;margin-left: 1em; margin-right: 1em;&#34;&gt;&lt;img border=&#34;0&#34; src=&#34;http://1.bp.blogspot.com/-K6MEN_9PcHs/UO2Yd69LeeI/AAAAAAAAHok/Lcb2apHZdC0/s1600/unnamed-chunk-3.png&#34; /&gt;&lt;/a&gt;&lt;/div&gt;The second component isn&#39;t as easy to decipher. The players at the negative end seem to players that are preferred by analytically minded analysts (think Moneyball). Raines, Trammell, and Martinez have more support among this group of voters. Morris, however, has less support among these voters and he isn&#39;t that far separated from them.&lt;br /&gt;&lt;br /&gt;There also may be some secondary steroid association in the component as well separating players who have proof of steroid use versus those which have no proof but “look like” they took steroids. For example, there is no hard evidence that Bagwell or Piazza took steroids, but they were very muscular and hit a lot of home runs, so they are believed to have taken steroids. There is some sort of evidence the top five players of this component did take steroids.&lt;br /&gt;&lt;br /&gt;&lt;pre&gt;&lt;code class=&#34;r&#34;&gt;dotchart(sort(pca$loadings[, 2]), main = &#34;Second Principal Component&#34;)&lt;br /&gt;&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;separator&#34; style=&#34;clear: both; text-align: center;&#34;&gt;&lt;a href=&#34;http://4.bp.blogspot.com/-mKFEcj6ISQU/UO2Yd7ZFDQI/AAAAAAAAHoo/ZBwJgKbcLI4/s1600/unnamed-chunk-4.png&#34; imageanchor=&#34;1&#34; style=&#34;margin-left: 1em; margin-right: 1em;&#34;&gt;&lt;img border=&#34;0&#34; src=&#34;http://4.bp.blogspot.com/-mKFEcj6ISQU/UO2Yd7ZFDQI/AAAAAAAAHoo/ZBwJgKbcLI4/s1600/unnamed-chunk-4.png&#34; /&gt;&lt;/a&gt;&lt;/div&gt;&lt;br /&gt;Projecting the votes onto two dimensions, we can look at how the voters for Bonds and Clemens split up. You can see there is a strong horizontal split between the voters for and against Bonds/Clemens. There are also 3 voters that voted for Bonds, but not Clemens.&lt;br /&gt;&lt;br /&gt;&lt;pre&gt;&lt;code class=&#34;r&#34;&gt;ggplot(data.frame(cbind(pca$scores[, 1:2], votes))) + geom_point(aes(Comp.1, &lt;br /&gt;    Comp.2, colour = as.factor(Barry.Bonds), shape = as.factor(Roger.Clemens)), &lt;br /&gt;    size = 4) + coord_equal() + labs(colour = &#34;Bonds&#34;, shape = &#34;Clemens&#34;)&lt;br /&gt;&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;separator&#34; style=&#34;clear: both; text-align: center;&#34;&gt;&lt;a href=&#34;http://1.bp.blogspot.com/-nQoFe3Gnk4c/UO2YeZBYwkI/AAAAAAAAHos/KftZv63_S6E/s1600/unnamed-chunk-5.png&#34; imageanchor=&#34;1&#34; style=&#34;margin-left: 1em; margin-right: 1em;&#34;&gt;&lt;img border=&#34;0&#34; src=&#34;http://1.bp.blogspot.com/-nQoFe3Gnk4c/UO2YeZBYwkI/AAAAAAAAHos/KftZv63_S6E/s1600/unnamed-chunk-5.png&#34; /&gt;&lt;/a&gt;&lt;/div&gt;&lt;br /&gt;Similarly, I can look at how the voters split up on the issue of steroids by looking at both Bonds and Bagwell. The voters in the upper left do not care about steroid use, but believe that Bagwell wasn&#39;t good enough to make it to the hall of fame. The voters in the lower right do care about steroid use, but believe that Bagwell was innocent of any wrongdoing.&lt;br /&gt;&lt;br /&gt;&lt;pre&gt;&lt;code class=&#34;r&#34;&gt;ggplot(data.frame(cbind(pca$scores[, 1:2], votes))) + geom_point(aes(Comp.1, &lt;br /&gt;    Comp.2, colour = as.factor(paste(Roger.Clemens, &#34;/&#34;, Jeff.Bagwell))), size = 4) + &lt;br /&gt;    geom_hline(aes(0), size = 0.2) + geom_vline(aes(0), size = 0.2) + coord_equal() + &lt;br /&gt;    labs(colour = &#34;Bonds / Bagwell&#34;)&lt;br /&gt;&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;separator&#34; style=&#34;clear: both; text-align: center;&#34;&gt;&lt;a href=&#34;http://4.bp.blogspot.com/-k4AoH_kJlyc/UO2YfOqnS0I/AAAAAAAAHow/mETFQ33dXVI/s1600/unnamed-chunk-6.png&#34; imageanchor=&#34;1&#34; style=&#34;margin-left: 1em; margin-right: 1em;&#34;&gt;&lt;img border=&#34;0&#34; src=&#34;http://4.bp.blogspot.com/-k4AoH_kJlyc/UO2YfOqnS0I/AAAAAAAAHow/mETFQ33dXVI/s1600/unnamed-chunk-6.png&#34; /&gt;&lt;/a&gt;&lt;/div&gt;&lt;br /&gt;We can also look at a similar plot with Schilling instead of Bagwell. The separation here appears to be stronger.&lt;br /&gt;&lt;br /&gt;&lt;pre&gt;&lt;code class=&#34;r&#34;&gt;ggplot(data.frame(cbind(pca$scores[, 1:2], votes))) + geom_point(aes(Comp.1, &lt;br /&gt;    Comp.2, colour = as.factor(paste(Barry.Bonds, &#34;/&#34;, Curt.Schilling))), size = 4) + &lt;br /&gt;    geom_hline(aes(0), size = 0.2) + geom_vline(aes(0), size = 0.2) + coord_equal() + &lt;br /&gt;    labs(colour = &#34;Bonds / Schilling&#34;)&lt;br /&gt;&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;separator&#34; style=&#34;clear: both; text-align: center;&#34;&gt;&lt;a href=&#34;http://1.bp.blogspot.com/-aSA3fUNxSGY/UO2YftHu8HI/AAAAAAAAHo0/e2Itd9TkE60/s1600/unnamed-chunk-7.png&#34; imageanchor=&#34;1&#34; style=&#34;margin-left: 1em; margin-right: 1em;&#34;&gt;&lt;img border=&#34;0&#34; src=&#34;http://1.bp.blogspot.com/-aSA3fUNxSGY/UO2YftHu8HI/AAAAAAAAHo0/e2Itd9TkE60/s1600/unnamed-chunk-7.png&#34; /&gt;&lt;/a&gt;&lt;/div&gt;&lt;br /&gt;Finally, we can look at a biplot (using code from &lt;a href=&#34;http://stackoverflow.com/questions/6578355/plotting-pca-biplot-with-ggplot2&#34;&gt;here&lt;/a&gt;).&lt;br /&gt;&lt;br /&gt;&lt;pre&gt;&lt;code class=&#34;r&#34;&gt;PCbiplot &amp;lt;- function(PC = fit, x = &#34;PC1&#34;, y = &#34;PC2&#34;) {&lt;br /&gt;    # PC being a prcomp object&lt;br /&gt;    library(grid)&lt;br /&gt;    data &amp;lt;- data.frame(obsnames = row.names(PC$x), PC$x)&lt;br /&gt;    plot &amp;lt;- ggplot(data, aes_string(x = x, y = y)) + geom_text(alpha = 0.4, &lt;br /&gt;        size = 3, aes(label = obsnames))&lt;br /&gt;    plot &amp;lt;- plot + geom_hline(aes(0), size = 0.2) + geom_vline(aes(0), size = 0.2)&lt;br /&gt;    datapc &amp;lt;- data.frame(varnames = rownames(PC$rotation), PC$rotation)&lt;br /&gt;    mult &amp;lt;- min((max(data[, y]) - min(data[, y])/(max(datapc[, y]) - min(datapc[, &lt;br /&gt;        y]))), (max(data[, x]) - min(data[, x])/(max(datapc[, x]) - min(datapc[, &lt;br /&gt;        x]))))&lt;br /&gt;    datapc &amp;lt;- transform(datapc, v1 = 0.7 * mult * (get(x)), v2 = 0.7 * mult * &lt;br /&gt;        (get(y)))&lt;br /&gt;    plot &amp;lt;- plot + coord_equal() + geom_text(data = datapc, aes(x = v1, y = v2, &lt;br /&gt;        label = varnames), size = 5, vjust = 1, color = &#34;red&#34;)&lt;br /&gt;    plot &amp;lt;- plot + geom_segment(data = datapc, aes(x = 0, y = 0, xend = v1, &lt;br /&gt;        yend = v2), arrow = arrow(length = unit(0.2, &#34;cm&#34;)), alpha = 0.75, color = &#34;red&#34;)&lt;br /&gt;    plot&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;fit &amp;lt;- prcomp(votes, scale = F)&lt;br /&gt;PCbiplot(fit)&lt;br /&gt;&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;separator&#34; style=&#34;clear: both; text-align: center;&#34;&gt;&lt;a href=&#34;http://4.bp.blogspot.com/-MPuCAW6v_zw/UO2YgMRas1I/AAAAAAAAHpA/pHzLYPdb0k4/s1600/unnamed-chunk-8.png&#34; imageanchor=&#34;1&#34; style=&#34;margin-left: 1em; margin-right: 1em;&#34;&gt;&lt;img border=&#34;0&#34; src=&#34;http://4.bp.blogspot.com/-MPuCAW6v_zw/UO2YgMRas1I/AAAAAAAAHpA/pHzLYPdb0k4/s1600/unnamed-chunk-8.png&#34; /&gt;&lt;/a&gt;&lt;/div&gt;I could have also attempted to rotate the factors to make them more interpretable, but they appeared to have easy interpretation as is. Since we were looking at 2-d plots, rotation would not have made a difference in interpreting the plots. It is also common to use a likelihood approach to estimate factors. I chose to use the principal component method because the data are definitely not normal (being 0&#39;s and 1&#39;s).&lt;/head&gt;&lt;/html&gt;&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Random Forest Variable Importance</title>
      <link>/2012/07/19/random-forest-variable-importance/</link>
      <pubDate>Thu, 19 Jul 2012 00:00:00 +0000</pubDate>
      
      <guid>/2012/07/19/random-forest-variable-importance/</guid>
      <description>
&lt;div class=&#39;post&#39;&gt;
&lt;a href=&#34;http://en.wikipedia.org/wiki/Random_forest&#34;&gt;Random&lt;/a&gt; &lt;a href=&#34;http://www.stat.berkeley.edu/%7Ebreiman/RandomForests/&#34;&gt;forests&lt;/a&gt; ™ are great. They are one of the best &#34;black-box&#34; supervised learning methods. If you have lots of data and lots of predictor variables, you can do worse than random forests. They can deal with messy, real data. If there are lots of extraneous predictors, it has no problem. It automatically does a good job of finding interactions as well. There are no assumptions that the response has a linear (or even smooth) relationship with the predictors.&lt;br /&gt;&lt;br /&gt;As cited in the Wikipedia article, they do lack some interpretability. But what they lack in interpretation, they more than make up for in prediction power, which I believe is much more important than interpretation in most cases. Even though you cannot easily tell how one variable affects the prediction, you can easily create a &lt;i&gt;partial dependence plot&lt;/i&gt; which shows how the response will change as you change the predictor. You can also do this for two variables at once to see the interaction of the two.&lt;br /&gt;&lt;br /&gt;Also helping in the interpretation is that they can output a list of predictor variables that they believe to be important in predicting the outcome. If nothing else, you can subset the data to only include the most &#34;important&#34; variables, and use that with another model. The randomForest package in R has two measures of importance. &lt;a href=&#34;http://rss.acs.unt.edu/Rdoc/library/randomForest/html/importance.html&#34;&gt;One &lt;/a&gt;is &#34;total decrease in node impurities from splitting on the variable, averaged over all trees.&#34; I do not know much about this one, and will not talk about it further. The other is based on a &lt;a href=&#34;http://en.wikipedia.org/wiki/Resampling_%28statistics%29#Permutation_tests&#34;&gt;permutation test&lt;/a&gt;. The idea is that if the variable is not important (the null hypothesis), then rearranging the values of that variable will not degrade prediction accuracy. Random forests use out-of-bag (OOB) samples to measure prediction accuracy.&lt;br /&gt;&lt;br /&gt;In my experience, it does a pretty good job of finding the most important predictors, but it has issues with correlated predictors. For example, I was working on a problem where I was predicting the price that electricity trades. One feature that I knew would be very important was the amount of electricity being used at that same time. But I thought there might also be a relationship between price and the electricity being used a few hours before and after. When I ran the random forest with these variables, the electricity used 1 hour after was found to be more important than the electricity used at the same time. When including the 1 hour after electricity use instead of the current hour electricity use, the cross validation (CV) error increased. Using both did not significantly change the CV error compared to using just current hour. Because the electricity used at the current hour and the hour after are very correlated, it had trouble telling which one was more important. In truth, given the electricity use at the current hour, the electricity use at the hour after did not improve the predictive accuracy.&lt;br /&gt;&lt;br /&gt;Why does the importance measure give more weight correlated predictors? &lt;a href=&#34;http://www.biomedcentral.com/1471-2105/9/307/&#34;&gt;Strobl et al.&lt;/a&gt; give some intuition behind what is happening and propose a solution. Basically, the permutation test is ill-posed. The permutation test is testing that the variable is independent of the response as well as all other predictors. Since the correlated predictors are obviously not independent, we get high importance scores. They propose a permutation test where you condition on the correlated predictors. This is a little tricky when the correlated predictors are continuous, but you can read the paper for more details.&lt;br /&gt;&lt;br /&gt;Another way to think of it is that, since each split only considers a subset of the possible variables, a variable that is correlated with an &#34;important&#34; variable may be considered without the &#34;important&#34; variable. This would cause the correlated variable to be selected for the split. The correlated value does hold some predictive value, but only because of the truly important variable, so it is understandable why this procedure would consider it important.&lt;br /&gt;&lt;br /&gt;I ran a simulation experiment (similar to the one in the paper) to demonstrate the issue. I simulated 5 predictor variables. Only the first one is related to the response, but the second one has a correlation of about 0.7 with the first one. Luckily, Strobl et al. included their version of importance in the package &lt;span style=&#34;font-family: &amp;quot;Courier New&amp;quot;,Courier,monospace;&#34;&gt;party&lt;/span&gt; in &lt;span style=&#34;font-family: &amp;quot;Courier New&amp;quot;,Courier,monospace;&#34;&gt;R&lt;/span&gt;. I compare variable importance from the &lt;span style=&#34;font-family: &amp;quot;Courier New&amp;quot;,Courier,monospace;&#34;&gt;randomForest &lt;/span&gt;package and the importance with and without taking correlated predictors into account from the &lt;span style=&#34;font-family: &amp;quot;Courier New&amp;quot;,Courier,monospace;&#34;&gt;party&lt;span style=&#34;font-family: inherit;&#34;&gt; &lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;font-family: inherit;&#34;&gt;pac&lt;/span&gt;kage.&lt;br /&gt;&lt;br /&gt;&lt;pre class=&#34;brush: r&#34;&gt;# simulate the data&lt;br /&gt;x1=rnorm(1000)&lt;br /&gt;x2=rnorm(1000,x1,1)&lt;br /&gt;y=2*x1+rnorm(1000,0,.5)&lt;br /&gt;df=data.frame(y,x1,x2,x3=rnorm(1000),x4=rnorm(1000),x5=rnorm(1000))&lt;br /&gt;&lt;br /&gt;# run the randomForest implementation&lt;br /&gt;library(randomForest)&lt;br /&gt;rf1 &amp;lt;- randomForest(y~., data=df, mtry=2, ntree=50, importance=TRUE)&lt;br /&gt;importance(rf1,type=1)&lt;br /&gt;&lt;br /&gt;# run the party implementation&lt;br /&gt;library(party)&lt;br /&gt;cf1 &amp;lt;- cforest(y~.,data=df,control=cforest_unbiased(mtry=2,ntree=50))&lt;br /&gt;varimp(cf1)&lt;br /&gt;varimp(cf1,conditional=TRUE)&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;For the &lt;span style=&#34;font-family: &amp;quot;Courier New&amp;quot;,Courier,monospace;&#34;&gt;randomForest&lt;/span&gt;, the ratio of importance of the the first and second variable is 4.53. For &lt;span style=&#34;font-family: &amp;quot;Courier New&amp;quot;,Courier,monospace;&#34;&gt;party&lt;/span&gt; without accounting for correlation it is 7.35. And accounting for correlation, it is 369.5. The higher ratios are better because it means that the importance of the first variable is more prominent. party&#39;s implementation is clearly doing the job.&lt;br /&gt;&lt;br /&gt;There is a downside. It takes much longer to calculate importance with correlated predictors than without. For the party package in this example, it took 0.39 seconds to run without and 204.34 seconds with. I could not even run the correlated importance on the electricity price example. There might be a research opportunity to get a quicker approximation.&lt;br /&gt;&lt;br /&gt;Possibly up next: confidence limits for random forest predictions.&lt;/div&gt;
&lt;h2&gt;Comments&lt;/h2&gt;
&lt;div class=&#39;comments&#39;&gt;
&lt;div class=&#39;comment&#39;&gt;
&lt;div class=&#39;author&#39;&gt;Abhijeet Patil&lt;/div&gt;
&lt;div class=&#39;content&#39;&gt;
hi,m new to random forest.. i ve some doubts..&lt;br /&gt;1)&amp;quot;we need to choose m number of variables randomly for each node..&amp;quot;-can u pleas explain it..&lt;br /&gt;OR&lt;br /&gt;2)&amp;quot;take 1 bootstrap sample,choose some variables and create a decision tree&amp;quot;-is it correct??&lt;br /&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#39;comment&#39;&gt;
&lt;div class=&#39;author&#39;&gt;Anonymous&lt;/div&gt;
&lt;div class=&#39;content&#39;&gt;
Could you tell me what the numbers mean when ctree and randonForest return variable importance numbers please? I can get the output but I don&amp;#39;t know how to interpret them.&lt;br /&gt;&lt;br /&gt;Than you very much.&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#39;comment&#39;&gt;
&lt;div class=&#39;author&#39;&gt;Anonymous&lt;/div&gt;
&lt;div class=&#39;content&#39;&gt;
HI Andrew, When i tried to calculate the variable importance, I get the error &lt;br /&gt;&amp;quot;Error in model.matrix.default(as.formula(f), data = blocks) : &lt;br /&gt;  allocMatrix: too many elements specified&amp;quot;&lt;br /&gt;&lt;br /&gt;I&amp;#39;m not sure how to deal with it because I have 2 factor levels which I&amp;#39;m predicting with 23 continuous variable predictors (about 2200 data points. I know it&amp;#39;s a lot to work with, but not sure how to get the correct VarImp values with this large data set.&lt;br /&gt;&lt;br /&gt;I tried increasing the threshold, but it didn&amp;#39;t help. fit.varimp=varimp(fit.cf,threshold=0.8,conditional=TRUE)&lt;br /&gt;&lt;br /&gt;Do you have any suggestions? Thanks.&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#39;comment&#39;&gt;
&lt;div class=&#39;author&#39;&gt;Andrew Landgraf&lt;/div&gt;
&lt;div class=&#39;content&#39;&gt;
Unfortunately, I didn&amp;#39;t set the seed. #nexttime&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#39;comment&#39;&gt;
&lt;div class=&#39;author&#39;&gt;Anonymous&lt;/div&gt;
&lt;div class=&#39;content&#39;&gt;
you should provide the seed to reproduce your example&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#39;comment&#39;&gt;
&lt;div class=&#39;author&#39;&gt;Andrew&lt;/div&gt;
&lt;div class=&#39;content&#39;&gt;
It should be able to give you a solution. I have no idea what ramifications this would have on accuracy or variable importance.&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#39;comment&#39;&gt;
&lt;div class=&#39;author&#39;&gt;Anonymous&lt;/div&gt;
&lt;div class=&#39;content&#39;&gt;
I have microarray data on 30 entries and thought of using RF to identify important response genes. I understand that this is a N&amp;lt;&amp;lt;p type of problems, but will &amp;#39;party&amp;#39; be able to come up with a solution?&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#39;comment&#39;&gt;
&lt;div class=&#39;author&#39;&gt;Andrew&lt;/div&gt;
&lt;div class=&#39;content&#39;&gt;
The simple answer is using the partialPlot function in the randomForest package for R (http://rgm2.lab.nig.ac.jp/RGM2/func.php?rd_id=randomForest:partialPlot). &lt;br /&gt;&lt;br /&gt;What it is doing isn&amp;#39;t all that complicated. Say you want a partial dependence plot for the variable X_1. For each value of X_1=x that you want to plot, you take the average of the prediction with X_1=x and the other explanatory variables equal to the n values that they are in the data set. You are trying to average out the other variables.&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#39;comment&#39;&gt;
&lt;div class=&#39;author&#39;&gt;nanounanue&lt;/div&gt;
&lt;div class=&#39;content&#39;&gt;
Great explanation!&lt;br /&gt;&lt;br /&gt;I have a question for you: In your text you said:&lt;br /&gt;&lt;br /&gt;&amp;quot;&amp;quot;&amp;quot;&lt;br /&gt; ... Even though you cannot easily tell how one variable affects the prediction, you can easily create a partial dependence plot which shows how the response will change as you change the predictor. You can also do this for two variables at once to see the interaction of the two.&lt;br /&gt;&amp;quot;&amp;quot;&amp;quot;&lt;br /&gt;&lt;br /&gt;Could you provide, please, an example of how build the partial dependence plot?&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;Thank you for the post and thanks in advance&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#39;comment&#39;&gt;
&lt;div class=&#39;author&#39;&gt;Anonymous&lt;/div&gt;
&lt;div class=&#39;content&#39;&gt;
Great post!  Thank you.&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
</description>
    </item>
    
  </channel>
</rss>
