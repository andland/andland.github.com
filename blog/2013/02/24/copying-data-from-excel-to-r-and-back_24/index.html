
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Copying Data from Excel to R and Back - Andrew Landgraf's Blog</title>
  <meta name="author" content="Andrew Landgraf">

  
  <meta name="description" content="A lot of times we are given a data set in Excel format and we want to run a quick analysis using R&#8217;s functionality to look at advanced &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://andland.github.io/blog/2013/02/24/copying-data-from-excel-to-r-and-back_24">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Andrew Landgraf's Blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Andrew Landgraf's Blog</a></h1>
  
    <h2>Statistically Significant</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:andland.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Copying Data From Excel to R and Back</h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-02-24T00:00:00-05:00" pubdate data-updated="true">Feb 24<span>th</span>, 2013</time>
        
      </p>
    
  </header>


<div class="entry-content"><div class='post'>
A lot of times we are given a data set in Excel format and we want to run a quick analysis using R&#8217;s functionality to look at advanced statistics or make better visualizations. There are packages for importing/exporting data from/to Excel, but I have found them to be hard to work with or only work with old versions of Excel (*.xls, not *.xlsx). So for a one time analysis, I usually save the file as a csv and import it into R.<br /><br />This can be a little burdensome if you are trying to do something quick and creates a file that needs to be cleaned up later. An easier option is to copy and paste the data directly into R. This can be done by using &#8220;clipboard&#8221; as the file and specifying that it is tab delimited, since that is how Excel&#8217;s clipboard stores the data.<br /><br />For example, say you have a table in excel you want to copy into R. First, copy it in Excel.<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-qPkCaCo_zWw/USpK8GLtKsI/AAAAAAAAHq0/9LrZwb05LVg/s1600/Capture.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-qPkCaCo_zWw/USpK8GLtKsI/AAAAAAAAHq0/9LrZwb05LVg/s1600/Capture.PNG" /></a></div><div class="separator" style="clear: both; text-align: center;"></div><br />Then go into R and use this function.<br /><br /><div style="overflow: auto;"><div class="geshifilter"><pre class="r geshifilter-R" style="font-family: monospace;">read.excel &lt;- <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">(</span>header=<span style="color: black; font-weight: bold;">TRUE</span><span style="color: #339933;">,</span>...<span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br />  <a href="http://inside-r.org/r-doc/utils/read.table"><span style="color: #003399; font-weight: bold;">read.table</span></a><span style="color: #009900;">(</span><span style="color: blue;">"clipboard"</span><span style="color: #339933;">,</span>sep=<span style="color: blue;">"<span style="color: #000099; font-weight: bold;">\t</span>"</span><span style="color: #339933;">,</span>header=header<span style="color: #339933;">,</span>...<span style="color: #009900;">)</span><br /><span style="color: #009900;">}</span><br />&nbsp;<br />dat=read.excel<span style="color: #009900;">(</span><span style="color: #009900;">)</span></pre></div></div><br />This function specifies that you are reading data from the clipboard, that it is tab delimited, and that it has a header.<br /><br />Similarly, you can copy from R to Excel using the same logic. Here I also make <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">row.name=FALSE</span> as default since I rarely have meaningful row names and they mess up the header alignment.<br /><br /><div style="overflow: auto;"><div class="geshifilter"><pre class="r geshifilter-R" style="font-family: monospace;">write.excel &lt;- <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">(</span>x<span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/row.names"><span style="color: #003399; font-weight: bold;">row.names</span></a>=<span style="color: black; font-weight: bold;">FALSE</span><span style="color: #339933;">,</span>col.names=<span style="color: black; font-weight: bold;">TRUE</span><span style="color: #339933;">,</span>...<span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br />  <a href="http://inside-r.org/r-doc/utils/write.table"><span style="color: #003399; font-weight: bold;">write.table</span></a><span style="color: #009900;">(</span>x<span style="color: #339933;">,</span><span style="color: blue;">"clipboard"</span><span style="color: #339933;">,</span>sep=<span style="color: blue;">"<span style="color: #000099; font-weight: bold;">\t</span>"</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/row.names"><span style="color: #003399; font-weight: bold;">row.names</span></a>=<a href="http://inside-r.org/r-doc/base/row.names"><span style="color: #003399; font-weight: bold;">row.names</span></a><span style="color: #339933;">,</span>col.names=col.names<span style="color: #339933;">,</span>...<span style="color: #009900;">)</span><br /><span style="color: #009900;">}</span><br />&nbsp;<br />write.excel<span style="color: #009900;">(</span>dat<span style="color: #009900;">)</span></pre></div></div><a href="http://www.inside-r.org/pretty-r" title="Created by Pretty R at inside-R.org">Created by Pretty R at inside-R.org</a><br /><br />These functions can be added to you .RProfile so that they are always ready for a quick analysis!<br /><br />Obviously, this technique does not encourage reproducible research. It is meant to be used for quick, ad hoc analysis and plotting; not something you would use for an analysis that needs to be done on a regular basis.<br /><br /></div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>Marek Sz</div>
<div class='content'>
I create similar functions and got few tips. For reading from excel following settings can be useful:<br />na.strings = &quot;&quot; # to prevent replacing NA string to missing value<br />comment.char = &quot;&quot; # to not loose everything after # sign<br />quote = &quot;&quot; # or &#39; or &quot; could mess with data<br />check.names = FALSE # if you want column names as in excel (spaces, special characters, etc.). You need to use `column name` in R to reference such columns.<br /><br />For writing na=&quot;&quot; replace missing values by empty string and not &quot;NA&quot; as on default.<br /><br />Second thing is that you can increase size of clipboard by using e.g. &quot;clipboard-10240&quot; instead of &quot;clipboard&quot; (it&#39;s a size in Kb, so it&#39;s around 10Mb; see help for connection, section Clipboard) which allow to copy and paste larger tables.</div>
</div>
<div class='comment'>
<div class='author'>Anonymous</div>
<div class='content'>
rkward (http://rkward.sourceforge.net/) has a very nifty feature (Edit -&gt; Paste Special&#8230;), that allows you to paste the copied data directly into your R source code, already formatted as a single string, vector or matrix. </div>
</div>
<div class='comment'>
<div class='author'>William Yarberry</div>
<div class='content'>
Excellent article.  Real people are always busy and this is just the kind of article that helps us all.  I have been doing scan() but when you start entering a few thousand rows that way, it gets a bit slow.  </div>
</div>
<div class='comment'>
<div class='author'>Anonymous</div>
<div class='content'>
scan() allows you to just paste&#8230;<br /><br />y &lt;- scan()</div>
</div>
<div class='comment'>
<div class='author'>Anonymous</div>
<div class='content'>
Thank you for these!!<br /></div>
</div>
<div class='comment'>
<div class='author'>Anonymous</div>
<div class='content'>
Thank you for the tip, this will help me a lot.<br />Also, it seems that, libreOffice also uses clipboard to store copied things. This function also works for libreOffice</div>
</div>
<div class='comment'>
<div class='author'>Anonymous</div>
<div class='content'>
I can&#39;t resist: you could just use<br />read.delim(&quot;clipboard&quot;)<br /><br />(The &quot;clipboard&quot; parameter is &#39;doze only for the foreseeable future)<br /><br />From &quot;?read.delim&quot;<br />read.delim(file, header = TRUE, sep = &quot;\t&quot;, quote=&quot;\&quot;&quot;, dec=&quot;.&quot;,<br />           fill = TRUE, comment.char=&quot;&quot;, &#8230;)</div>
</div>
<div class='comment'>
<div class='author'>Anonymous</div>
<div class='content'>
Thank you very much Tony for your quick answer (on a  Sunday afternoon!!). <br /><br />Ernesto</div>
</div>
<div class='comment'>
<div class='author'>Tony Hirst</div>
<div class='content'>
@Ernesto It seems that on a Mac, you can use pbpaste ( http://stackoverflow.com/questions/9035674/r-function-to-copy-to-clipboard-on-mac-osx )<br /><br />read.clipboard.mac &lt;- function(header=TRUE,&#8230;) {<br />  read.table(pipe(&quot;pbpaste&quot;),sep=&quot;\t&quot;,header=header,&#8230;)<br />}<br /> </div>
</div>
<div class='comment'>
<div class='author'>Anonymous</div>
<div class='content'>
Thank you very much. Very useful. I work in both Windows and Mac Environments. The trick you show seems to work only in Windows. Any idea what to do in Mac? Thanks in advance,<br /><br />Ernesto</div>
</div>
</div>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Andrew Landgraf</span></span>

      








  


<time datetime="2013-02-24T00:00:00-05:00" pubdate data-updated="true">Feb 24<span>th</span>, 2013</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/r/'>R</a>, <a class='category' href='/blog/categories/data/'>data</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://andland.github.io/blog/2013/02/24/copying-data-from-excel-to-r-and-back_24/" data-via="" data-counturl="http://andland.github.io/blog/2013/02/24/copying-data-from-excel-to-r-and-back_24/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2013/01/23/text-decryption-using-mcmc/" title="Previous Post: Text Decryption Using MCMC">&laquo; Text Decryption Using MCMC</a>
      
      
        <a class="basic-alignment right" href="/blog/2013/04/18/easily-access-academic-journals-off/" title="Next Post: Easily Access Academic Journals Off Campus with a Firefox Bookmark">Easily Access Academic Journals Off Campus with a Firefox Bookmark &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/04/21/what-is-probability-of-16-seed-beating/">What Is the Probability of a 16 Seed Beating a 1 Seed?</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/04/18/easily-access-academic-journals-off/">Easily Access Academic Journals Off Campus With a Firefox Bookmark</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/02/24/copying-data-from-excel-to-r-and-back_24/">Copying Data From Excel to R and Back</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/01/23/text-decryption-using-mcmc/">Text Decryption Using MCMC</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/01/14/restricted-boltzmann-machines-in-r/">Restricted Boltzmann Machines in R</a>
      </li>
    
  </ul>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Andrew Landgraf -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
